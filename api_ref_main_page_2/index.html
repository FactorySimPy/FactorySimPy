<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://factorysimpy.github.io/FactorySimPy/api_ref_main_page_2/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>API Reference - FactorySimPy</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API Reference";
        var mkdocs_page_input_path = "api_ref_main_page_2.md";
        var mkdocs_page_url = "/FactorySimPy/api_ref_main_page_2/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> FactorySimPy
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting Started</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">SYSTEM DESCRIPTION</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic_components/">Basic Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Other features</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../monitoring/">Monitoring and Measurement</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../constructs/">Constructs for Modeling</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../extending_components/">Extending Components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../interrupts/">Modeling interrupts</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../RTsimulation/">Enabling real-time simulation</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">REFERENCE</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../extendedresources/">Supporting classes</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">API Reference</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#factorysimpy">factorysimpy</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#factorysimpy.base">base</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.base.belt_store">belt_store</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.base.buffer_store">buffer_store</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.base.fleet_store">fleet_store</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.base.priority_req_store">priority_req_store</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.base.reservable_priority_req_filter_store">reservable_priority_req_filter_store</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.base.reservable_priority_req_store">reservable_priority_req_store</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.base.reservable_req_store">reservable_req_store</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.base.slotted_belt_store">slotted_belt_store</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#factorysimpy.constructs">constructs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.constructs.chain">chain</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.constructs.mesh">mesh</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#factorysimpy.edges">edges</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.edges.buffer">buffer</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.edges.continuous_conveyor">continuous_conveyor</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.edges.edge">edge</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.edges.fleet">fleet</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.edges.slotted_conveyor">slotted_conveyor</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#factorysimpy.helper">helper</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.helper.baseflowitem">baseflowitem</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.helper.item">item</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.helper.pallet">pallet</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#factorysimpy.nodes">nodes</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.nodes.combiner">combiner</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.nodes.machine">machine</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.nodes.node">node</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.nodes.sink">sink</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.nodes.source">source</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.nodes.splitter">splitter</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#factorysimpy.utils">utils</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.utils.stats_summary">stats_summary</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#factorysimpy.utils.utils">utils</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../authors/">Authors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../changelog/">Changelog</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">FactorySimPy</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">REFERENCE</li>
      <li class="breadcrumb-item active">API Reference</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/FactorySimPy/FactorySimPy/edit/master/docs/api_ref_main_page_2.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h2 id="factorysimpy" class="doc doc-heading">
            <code>factorysimpy</code>


<a href="#factorysimpy" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h3 id="factorysimpy.base" class="doc doc-heading">
            <code>base</code>


<a href="#factorysimpy.base" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h4 id="factorysimpy.base.belt_store" class="doc doc-heading">
            <code>belt_store</code>


<a href="#factorysimpy.base.belt_store" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.belt_store.BeltStore" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">BeltStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">accumulation_mode_indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.store.Store">Store</span></code></p>


        <p>This is a class that is derived from SimPy's Store class and has extra capabilities
that makes it a reservable store for processes to reserve space
for storing and retrieving items.</p>
<p>Processes can use reserve_put() and reserve_get() methods to get notified when a space becomes
available in the store or when an item gets available in the ReservableReqStore.
These methods returns a unique event (SimPy.Event) to the process for every reserve requests it makes.</p>
<p>get and put are two methods that can be used for item storing and retrieval from ReservableReqStore.
Process has to make a prior reservation and pass the associated reservation event as argument in the get and
put requests. ReservableReqStore maintains separate queues for <code>reserve_put</code> and <code>reserve_get</code> operations
to ensures that only processes with valid reservations can store or retrieve items.</p>
<p>ReservableReqStore preserves item order by associating an unreserved item in the store with a reservation event
by index when a reserve_get() request is made. As a result, it maintains a list of reserved events to preserve item order.</p>
<p>It also allows users to cancel an already placed reserve_get or reserve_put request even if it is yielded.
It also handles the dissociation of the event and item done at the time of reservation when an already yielded
event is canceled.</p>
<p>When an item is added into the BeltStore using put(), it is associated with a delay representing the time it takes for the item 
to move through the belt. The item is not immediately available for retrieval after being put into the store.
Instead, it becomes available only after the specified delay has elapsed, simulating the movement of items on a conveyor belt.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reserved_events</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Maintains events corresponding to reserved items to preserve item order by index</p>
              </div>
            </li>
            <li>
              <b><code>reserve_put_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_put</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reserve_get_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_get reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_get</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful get reservations</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <p>Initializes a reservable store with reservations.</p>
<p>Args:</p>
<p>capacity (int, optional): The maximum number of items the store can hold.
                            Defaults to infinity.
 mode (str, optional): The mode of the store ('FIFO' or 'LIFO'). Defaults to 'FIFO'.
 speed (float, optional): The speed of the conveyor belt. Defaults to 1.
 accumulation_mode_indicator (bool, optional): Indicates if the belt is in accumulation mode.
                                               Defaults to True.
 capacity (int, optional): The maximum number of items the store can hold.
                              Defaults to infinity.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">speed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">accumulation_mode_indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a reservable store with reservations.</span>

<span class="sd">    Args:</span>

<span class="sd">     capacity (int, optional): The maximum number of items the store can hold.</span>
<span class="sd">                                Defaults to infinity.</span>
<span class="sd">     mode (str, optional): The mode of the store (&#39;FIFO&#39; or &#39;LIFO&#39;). Defaults to &#39;FIFO&#39;.</span>
<span class="sd">     speed (float, optional): The speed of the conveyor belt. Defaults to 1.</span>
<span class="sd">     accumulation_mode_indicator (bool, optional): Indicates if the belt is in accumulation mode.</span>
<span class="sd">                                                   Defaults to True.</span>
<span class="sd">     capacity (int, optional): The maximum number of items the store can hold.</span>
<span class="sd">                                  Defaults to infinity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span>  <span class="c1"># Speed of the conveyor belt (units per time)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># Maintains events corresponding to reserved items to preserve item order</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">=</span><span class="p">[]</span>  <span class="c1">#Maintains the items ready to be taken out</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_items</span>   <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># parallel list of the exact items reserved</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_level_change_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_num_items</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_weighted_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_averaged_num_of_items_in_store</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Time-averaged number of items in the store</span>
    <span class="c1"># Process tracking for interrupt functionality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dictionary to track active move_to_ready_items processes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_delayed_interrupt_processes</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dictionary to track active delayed interrupt processes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>  <span class="c1"># Event to signal when to resume processes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># to control if the belt is in noaccumulation mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">accumulation_mode_indicator</span> <span class="o">=</span> <span class="n">accumulation_mode_indicator</span> <span class="c1"># to indicate if the belt is in accumulation mode or not</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">one_item_inserted</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># to control insertion of only one item in noaccumulation mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ready_item_event</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Retrieve an item from the store after a successful reservation.</p>
<p>This method attempts to retrieve an item associated with a <code>reserve_get</code>
event. If the reservation exists, it triggers <code>_trigger_get</code> to retrieve
the item. If successful, <code>_trigger_reserve_put</code> is called to process any
pending <code>reserve_put</code> requests. If the item retrieval fails, an error
message is raised.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event associated with the request.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>item</code></b>(                  <code><span title="Object">Object</span></code>
)              –
              <div class="doc-md-description">
                <p>The retrieved item if successful, otherwise raises an error</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_get</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If item returned is None</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve an item from the store after a successful reservation.</span>

<span class="sd">    This method attempts to retrieve an item associated with a `reserve_get`</span>
<span class="sd">    event. If the reservation exists, it triggers `_trigger_get` to retrieve</span>
<span class="sd">    the item. If successful, `_trigger_reserve_put` is called to process any</span>
<span class="sd">    pending `reserve_put` requests. If the item retrieval fails, an error</span>
<span class="sd">    message is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event (simpy.Event): The reservation event associated with the request.</span>

<span class="sd">    Returns:</span>
<span class="sd">        item (Object): The retrieved item if successful, otherwise raises an error</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_get</span>
<span class="sd">        RuntimeError: If item returned is None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#if there are reservations, then call _trigger_get</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
      <span class="n">item</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span>
    <span class="c1">#else raise an error</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_get is empty&quot;</span><span class="p">)</span>
    <span class="c1">#if an item is returned then call _trigger_reserve_put to process pending requests</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No item found in the store for </span><span class="si">{</span><span class="n">get_event</span><span class="o">.</span><span class="n">requesting_process</span><span class="si">}</span><span class="s2"> and get request failed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1">#self._update_time_averaged_level()</span>
      <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.handle_new_item_during_interruption" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_new_item_during_interruption</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.handle_new_item_during_interruption" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Handle new item added during STALLED_ACCUMULATING_STATE with accumulation=1.</p>
<p>Computes delay using same logic as for existing items.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_new_item_during_interruption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle new item added during STALLED_ACCUMULATING_STATE with accumulation=1.</span>

<span class="sd">    Computes delay using same logic as for existing items.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># Build the updated belt pattern with new item</span>
    <span class="n">current_pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_belt_pattern</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Current belt pattern after adding new item: </span><span class="si">{</span><span class="n">current_pattern</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and items </span><span class="si">{</span><span class="n">current_pattern</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">updated_pattern</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">current_pattern</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>




    <span class="c1"># Recompute item positions</span>
    <span class="n">item_positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">updated_pattern</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;item_positions with new item&quot;</span><span class="p">,</span> <span class="n">item_positions</span><span class="p">)</span>
    <span class="c1"># Get interruption plan</span>
    <span class="n">interruption_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_gap_based_interruptions</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">updated_pattern</span><span class="p">),</span> <span class="n">item_positions</span><span class="p">,</span> <span class="n">current_pattern</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Interruption plan with new item: </span><span class="si">{</span><span class="n">interruption_plan</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># The new item is the last one added in pattern</span>
    <span class="n">delay_for_new_item</span> <span class="o">=</span> <span class="n">interruption_plan</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span>

    <span class="n">item_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="n">item_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="n">item_length</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;length&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">1.0</span>
    <span class="n">delay_for_new_item</span> <span class="o">=</span> <span class="n">delay_for_new_item</span> <span class="o">*</span> <span class="p">(</span><span class="n">item_length</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delay_for_new_item</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> New item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> will be interrupted after </span><span class="si">{</span><span class="n">delay_for_new_item</span><span class="si">}</span><span class="s2"> time units&quot;</span><span class="p">)</span>
        <span class="n">interrupt_process</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delayed_interrupt</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="n">delay_for_new_item</span><span class="p">,</span> <span class="s2">&quot;New item during interruption&quot;</span><span class="p">))</span>
        <span class="n">item_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_delayed_interrupt_processes</span><span class="p">[</span><span class="n">item_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">interrupt_process</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> New item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">interruption_plan</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;item_index&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">interruption_plan</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;delay&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> interrupted immediately&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt_specific_item</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="s2">&quot;New item during interruption&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.interrupt_all_move_processes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interrupt_all_move_processes</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;External interrupt&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.interrupt_all_move_processes" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Interrupt all active move_to_ready_items processes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reason</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;External interrupt&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Reason for the interrupt</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interrupt_all_move_processes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;External interrupt&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interrupt all active move_to_ready_items processes.</span>

<span class="sd">    Args:</span>
<span class="sd">        reason (str): Reason for the interrupt</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Belt_Store interrupting </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span><span class="p">)</span><span class="si">}</span><span class="s2"> move processes - </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">item_id</span><span class="p">,</span> <span class="n">process_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">process_info</span><span class="p">[</span><span class="s1">&#39;process&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">process</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">process</span><span class="o">.</span><span class="n">processed</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">process</span><span class="o">.</span><span class="n">interrupt</span><span class="p">(</span><span class="n">reason</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Interrupted move process for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="c1"># Process might already be finished</span>
                <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.interrupt_and_resume_all_delayed_interrupt_processes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interrupt_and_resume_all_delayed_interrupt_processes</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;State change interrupt&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.interrupt_and_resume_all_delayed_interrupt_processes" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Interrupt all active delayed interrupt processes and clear them.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reason</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;State change interrupt&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Reason for the interrupt</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interrupt_and_resume_all_delayed_interrupt_processes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;State change interrupt&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interrupt all active delayed interrupt processes and clear them.</span>

<span class="sd">    Args:</span>
<span class="sd">        reason (str): Reason for the interrupt</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Belt_Store interrupting </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_delayed_interrupt_processes</span><span class="p">)</span><span class="si">}</span><span class="s2"> delayed interrupt processes - </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">item_id</span><span class="p">,</span> <span class="n">process</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_delayed_interrupt_processes</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">process</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">process</span><span class="o">.</span><span class="n">processed</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">process</span><span class="o">.</span><span class="n">interrupt</span><span class="p">(</span><span class="n">reason</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Interrupted delayed interrupt process for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="c1"># Process might already be finished</span>
                <span class="k">pass</span>
        <span class="c1"># Remove from tracking regardless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_delayed_interrupt_processes</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.move_to_ready_items" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_to_ready_items</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.move_to_ready_items" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Move items from the store to the ready_items list after a put operation.
This method is called as a process to ensure that items are moved asynchronously.
Handles interrupts when state changes to stalled and resumes when state changes back.
Movement is split into two phases:
1. First phase: item[0].length/self.speed time (time for item to fully enter belt)
2. Second phase: remaining time (time for item to reach exit)</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_to_ready_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move items from the store to the ready_items list after a put operation.</span>
<span class="sd">    This method is called as a process to ensure that items are moved asynchronously.</span>
<span class="sd">    Handles interrupts when state changes to stalled and resumes when state changes back.</span>
<span class="sd">    Movement is split into two phases:</span>
<span class="sd">    1. First phase: item[0].length/self.speed time (time for item to fully enter belt)</span>
<span class="sd">    2. Second phase: remaining time (time for item to reach exit)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">item_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="n">event</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">total_interruption_time</span><span class="o">=</span><span class="mi">0</span>
    <span class="c1">#self.delay=item[0].length/self.speed</span>
    <span class="c1">#print(f&quot;created Added event suceeded{self.delay}&quot;)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">)</span><span class="c1"># after putting an item, an event is created and will be triggered ater delay amount of time to allow waiting get calls to succeed in a stalled belt</span>
    <span class="c1">#event.callbacks.append(self._trigger_put)# this may not be needed</span>

    <span class="c1">#print(f&quot;{self.env.now}Added event suceed        ed&quot;)</span>

    <span class="c1"># Calculate the two phases of movement</span>
    <span class="n">phase1_time</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span>  <span class="c1"># Time for item to fully enter belt</span>
    <span class="n">phase2_time</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">phase1_time</span>        <span class="c1"># Remaining time to reach exit</span>
    <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">total_interruption_time</span><span class="o">=</span> <span class="n">total_interruption_time</span>
    <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">interruption_start_time</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Move items to the ready_items list</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> beltstore received an item </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> . Item started moving in belt&quot;</span><span class="p">)</span>

            <span class="c1"># Phase 1: Item entering the belt (length/speed time)</span>
            <span class="n">remaining_phase1_time</span> <span class="o">=</span> <span class="n">phase1_time</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> starting Phase 1 (entering belt): </span><span class="si">{</span><span class="n">phase1_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time&quot;</span><span class="p">)</span>

            <span class="k">while</span> <span class="n">remaining_phase1_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">remaining_phase1_time</span><span class="p">)</span>
                    <span class="c1"># If we reach here, phase 1 completed without interruption</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>
                    <span class="n">remaining_phase1_time</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Interrupt</span> <span class="k">as</span> <span class="n">interrupt</span><span class="p">:</span>
                    <span class="c1"># Calculate how much time has passed</span>
                    <span class="n">interruption_start_time_phase1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
                    <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">interruption_start_time</span><span class="o">=</span> <span class="n">interruption_start_time_phase1</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">}</span><span class="s2"> for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> Phase 1 started interruption at </span><span class="si">{</span><span class="n">interruption_start_time_phase1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">start_time</span>
                    <span class="n">remaining_phase1_time</span> <span class="o">-=</span> <span class="n">elapsed_time</span>

                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Move process Phase 1 for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> interrupted: </span><span class="si">{</span><span class="n">interrupt</span><span class="o">.</span><span class="n">cause</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Remaining Phase 1 time for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">remaining_phase1_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># Wait for resume signal</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> waiting for resume signal with </span><span class="si">{</span><span class="n">remaining_phase1_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time left to complete(Phase 1)...&quot;</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span>
                    <span class="n">total_interruption_time</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">interruption_start_time_phase1</span>
                    <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">interruption_start_time</span><span class="o">=</span><span class="kc">None</span>
                    <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">total_interruption_time</span><span class="o">=</span> <span class="n">total_interruption_time</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> resuming Phase 1 movement with </span><span class="si">{</span><span class="n">remaining_phase1_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time remaining&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> completed Phase 1 (fully entered belt)&quot;</span><span class="p">)</span>

            <span class="c1"># Phase 2: Item moving through the belt to exit</span>
            <span class="n">remaining_phase2_time</span> <span class="o">=</span> <span class="n">phase2_time</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> starting Phase 2 (moving to exit): </span><span class="si">{</span><span class="n">phase2_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time&quot;</span><span class="p">)</span>

            <span class="k">while</span> <span class="n">remaining_phase2_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">remaining_phase2_time</span><span class="p">)</span>
                    <span class="c1"># If we reach here, phase 2 completed without interruption</span>
                    <span class="n">remaining_phase2_time</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Interrupt</span> <span class="k">as</span> <span class="n">interrupt</span><span class="p">:</span>
                    <span class="c1"># Calculate how much time has passed</span>
                    <span class="n">interruption_start_time_phase2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
                    <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">interruption_start_time</span><span class="o">=</span> <span class="n">interruption_start_time_phase2</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">}</span><span class="s2"> for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> Phase 2 started interruption at </span><span class="si">{</span><span class="n">interruption_start_time_phase2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">start_time</span>
                    <span class="n">remaining_phase2_time</span> <span class="o">-=</span> <span class="n">elapsed_time</span>

                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Move process Phase 2 for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> interrupted: </span><span class="si">{</span><span class="n">interrupt</span><span class="o">.</span><span class="n">cause</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Remaining Phase 2 time for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">remaining_phase2_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># Wait for resume signal</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> waiting for resume signal (Phase 2) time left- </span><span class="si">{</span><span class="n">remaining_phase2_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span>
                    <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">interruption_start_time</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">total_interruption_time</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">interruption_start_time_phase2</span>
                    <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">total_interruption_time</span><span class="o">=</span> <span class="n">total_interruption_time</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> resuming Phase 2 movement with </span><span class="si">{</span><span class="n">remaining_phase2_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time remaining&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> completed Phase 2 (reached exit)&quot;</span><span class="p">)</span>
            <span class="c1">#print(f&quot;T={self.env.now:.2f} bufferstore finished moving item {item[0].id, item[1]} going to ready_items&quot;)</span>

            <span class="n">item_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">item_to_put</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">item_index</span><span class="p">)</span>  <span class="c1"># Remove the item</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item_to_put</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">item_to_put</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conveyor_ready_item_entry_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total items on belt&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">))</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ready_item_event</span><span class="o">.</span><span class="n">triggered</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ready_item_event</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> bufferstore finished moving item </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> moved to ready_items&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Total number of items in the store exceeds capacity. Cannot move item to ready_items.&quot;</span><span class="p">)</span>


    <span class="k">except</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Interrupt</span> <span class="k">as</span> <span class="n">interrupt</span><span class="p">:</span>
        <span class="c1"># Handle any uncaught interrupts</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> move process was interrupted: </span><span class="si">{</span><span class="n">interrupt</span><span class="o">.</span><span class="n">cause</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>   

    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Clean up the process tracking when done</span>
        <span class="k">if</span> <span class="n">item_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span><span class="p">[</span><span class="n">item_id</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Removed tracking for completed move process of item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform a <code>put</code> operation on the store and trigger any pending <code>reserve_get</code> requests.</p>
<p>Ensures that only processes with a valid reservation can put items into the store.
If the put operation succeeds, it triggers <code>_trigger_reserve_get</code> to process pending get requests.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The event corresponding to the reservation.</p>
              </div>
            </li>
            <li>
              <b><code>item</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>The item to be added to the store.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the put operation succeeded, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_put</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If proceed is False after put operation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a `put` operation on the store and trigger any pending `reserve_get` requests.</span>

<span class="sd">    Ensures that only processes with a valid reservation can put items into the store.</span>
<span class="sd">    If the put operation succeeds, it triggers `_trigger_reserve_get` to process pending get requests.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event (simpy.Event): The event corresponding to the reservation.</span>
<span class="sd">        item (object): The item to be added to the store.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the put operation succeeded, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_put</span>
<span class="sd">        RuntimeError: If proceed is False after put operation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
      <span class="n">proceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_put is empty&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">proceed</span><span class="p">:</span>
      <span class="c1">#print(f&quot;{self.env.now} proceed&quot;)</span>
      <span class="c1">#self._trigger_get(None)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>



    <span class="k">if</span> <span class="ow">not</span> <span class="n">proceed</span><span class="p">:</span>

      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching put_event found in the reservations and put failed for</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1">#self._update_time_averaged_level()</span>
      <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.reserve_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get</span><span class="p">()</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.reserve_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to retrieve an item from the store.</p>
<p>This method generates a SimPy event representing a request to reserve an item
for retrieval (<code>get</code>). The event is assigned attributes such as
the resource it belongs to, and the process making the request.</p>
<p>The event is then added to <code>reserve_get_queue</code>, which is maintained in
the order in which the requests are made, and <code>_trigger_reserve_get()</code> is called to process pending
reservations if items are available.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when an item becomes available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to retrieve an item from the store.</span>

<span class="sd">    This method generates a SimPy event representing a request to reserve an item</span>
<span class="sd">    for retrieval (`get`). The event is assigned attributes such as</span>
<span class="sd">    the resource it belongs to, and the process making the request.</span>

<span class="sd">    The event is then added to `reserve_get_queue`, which is maintained in</span>
<span class="sd">    the order in which the requests are made, and `_trigger_reserve_get()` is called to process pending</span>
<span class="sd">    reservations if items are available.</span>



<span class="sd">    Returns:</span>
<span class="sd">       event (simpy.Event): A reservation event that will succeed when an item becomes available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#adding attributes to the newly created event for reserve_get</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span><span class="o">=</span><span class="bp">self</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Associate event with the current process</span>




    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_get</code> request.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_event_to_cancel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_get` request.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Case 1: still waiting</span>
    <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Case 2: already yielded reservation</span>
    <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
        <span class="c1"># 1) Remove from active reservations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

        <span class="c1"># 2) Find its index in the parallel lists</span>
        <span class="n">ev_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

        <span class="c1"># 3) Pop out the exact item reference</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ev_idx</span><span class="p">)</span>
        <span class="c1"># 4) Drop the event token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ev_idx</span><span class="p">)</span>

        <span class="c1"># 5) Remove it from ready_items wherever it currently is</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item </span><span class="si">{</span><span class="n">item</span><span class="si">!r}</span><span class="s2"> not found in ready_items during cancel.&quot;</span><span class="p">)</span>

        <span class="c1"># 6) Compute new insertion index</span>

        <span class="n">insert_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1"># 7) Re‑insert it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_idx</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

        <span class="c1"># 8) Trigger any other pending reservations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># No such reservation</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
        <span class="s2">&quot;No matching event in reserve_get_queue or reservations_get&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.reserve_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put</span><span class="p">()</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.reserve_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to put an item into the store.</p>
<p>This function generates a SimPy event representing a reservation request. The event is
assigned attributes such as resource name, and the process making the request.
The event is then added to <code>reserve_put_queue</code>, which is maintained in the order in which the 
request is made.</p>
<p>After adding the event to the queue, <code>_trigger_reserve_put</code> is called to process
any pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when space is available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to put an item into the store.</span>

<span class="sd">    This function generates a SimPy event representing a reservation request. The event is</span>
<span class="sd">    assigned attributes such as resource name, and the process making the request.</span>
<span class="sd">    The event is then added to `reserve_put_queue`, which is maintained in the order in which the </span>
<span class="sd">    request is made.</span>

<span class="sd">    After adding the event to the queue, `_trigger_reserve_put` is called to process</span>
<span class="sd">    any pending reservations.</span>


<span class="sd">    Returns:</span>
<span class="sd">        event (simpy.Event): A reservation event that will succeed when space is available.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># Store reference</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Process making the reservation</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>


    <span class="c1"># Attempt to process reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_put</code> request.</p>
<p>This method allows a process to cancel its reservation for putting an item
into the store. If the reservation exists in the <code>reserve_put_queue</code>, it is
removed before triggering <code>_trigger_reserve_put</code> to process any pending reservations.
If the reservation is already in <code>reservations_put</code>, it is also removed and
<code>_trigger_reserve_put</code> is triggered.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_put_queue</code>
          or <code>reservations_put</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">put_event_to_cancel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_put` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for putting an item</span>
<span class="sd">    into the store. If the reservation exists in the `reserve_put_queue`, it is</span>
<span class="sd">    removed before triggering `_trigger_reserve_put` to process any pending reservations.</span>
<span class="sd">    If the reservation is already in `reservations_put`, it is also removed and</span>
<span class="sd">    `_trigger_reserve_put` is triggered.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">       proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_put_queue`</span>
<span class="sd">                      or `reservations_put`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_put_queue</span>
  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_put</span>
  <span class="k">elif</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_put_queue or reservations_put for this process&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.resume_all_move_processes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resume_all_move_processes</span><span class="p">()</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.resume_all_move_processes" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Resume all interrupted move_to_ready_items processes.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resume_all_move_processes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resume all interrupted move_to_ready_items processes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Belt_Store resuming move processes&quot;</span><span class="p">)</span>

    <span class="c1"># Create a new resume event and trigger it</span>
    <span class="n">old_resume_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">old_resume_event</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.belt_store.BeltStore.selective_interrupt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">selective_interrupt</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;Selective interrupt&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.base.belt_store.BeltStore.selective_interrupt" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform selective interruption based on belt occupancy patterns and mode.</p>
<p>When noaccumulation_mode_on=True (STALLED_NONACCUMULATING_STATE):
- Interrupt all items immediately</p>
<p>When noaccumulation_mode_on=False (STALLED_ACCUMULATING_STATE):
- Use pattern-based interruption with delays based on item positions</p>
<p>Pattern-based rules for accumulating mode:
- For patterns like '_<strong><em>*', interrupt all items.
- For patterns like '_</em>_<em>_', interrupt item in second last position after 1 delay,
  and second item after 2 delays.
- For patterns like '</em>___*', interrupt first item and second item after 3 delays.
- For patterns like '</strong>__*', interrupt first item, second after 2 delays,
  and third after 2 delays.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reason</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;Selective interrupt&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Reason for the interrupt</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">selective_interrupt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Selective interrupt&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform selective interruption based on belt occupancy patterns and mode.</span>

<span class="sd">    When noaccumulation_mode_on=True (STALLED_NONACCUMULATING_STATE):</span>
<span class="sd">    - Interrupt all items immediately</span>

<span class="sd">    When noaccumulation_mode_on=False (STALLED_ACCUMULATING_STATE):</span>
<span class="sd">    - Use pattern-based interruption with delays based on item positions</span>

<span class="sd">    Pattern-based rules for accumulating mode:</span>
<span class="sd">    - For patterns like &#39;_****&#39;, interrupt all items.</span>
<span class="sd">    - For patterns like &#39;_*_*_&#39;, interrupt item in second last position after 1 delay,</span>
<span class="sd">      and second item after 2 delays.</span>
<span class="sd">    - For patterns like &#39;*___*&#39;, interrupt first item and second item after 3 delays.</span>
<span class="sd">    - For patterns like &#39;**__*&#39;, interrupt first item, second after 2 delays,</span>
<span class="sd">      and third after 2 delays.</span>

<span class="sd">    Args:</span>
<span class="sd">        reason (str): Reason for the interrupt</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> No items on belt to interrupt&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># If noaccumulation_mode_on is True (STALLED_NONACCUMULATING_STATE), interrupt all items immediately</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Noaccumulation_mode_on: interrupting all items immediately&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">):</span>
            <span class="n">item_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt_specific_item</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2"> - immediate (no accumulation)&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># For accumulating mode (STALLED_ACCUMULATING_STATE), use pattern-based interruption</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulation_mode_indicator</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1">#if self.noaccumulation_mode_on == False:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Accumulating mode: using pattern-based interruption&quot;</span><span class="p">)</span>

        <span class="c1"># Get current belt pattern</span>
        <span class="n">all_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_belt_pattern</span><span class="p">()</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">all_patterns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">beltitems</span> <span class="o">=</span> <span class="n">all_patterns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Current belt pattern: </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2"> and items </span><span class="si">{</span><span class="n">beltitems</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Analyze pattern and determine interruption strategy</span>
        <span class="n">interruption_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_pattern_for_interruption</span><span class="p">(</span><span class="n">all_patterns</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">interruption_plan</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> No interruption needed for current pattern&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Executing selective interruption plan: </span><span class="si">{</span><span class="n">interruption_plan</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Execute the interruption plan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_interruption_plan</span><span class="p">(</span><span class="n">interruption_plan</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.base.buffer_store" class="doc doc-heading">
            <code>buffer_store</code>


<a href="#factorysimpy.base.buffer_store" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.buffer_store.BufferStore" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">BufferStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;FIFO&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.base.buffer_store.BufferStore" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.store.Store">Store</span></code></p>


        <p>This is a class that is derived from SimPy's Store class and has extra capabilities
that makes it a reservable store for processes to reserve space
for storing and retrieving items.</p>
<p>Processes can use reserve_put() and reserve_get() methods to get notified when a space becomes
available in the store or when an item gets available in the ReservableReqStore.
These methods returns a unique event (SimPy.Event) to the process for every reserve requests it makes.</p>
<p>get and put are two methods that can be used for item storing and retrieval from ReservableReqStore.
Process has to make a prior reservation and pass the associated reservation event as argument in the get and
put requests. ReservableReqStore maintains separate queues for <code>reserve_put</code> and <code>reserve_get</code> operations
to ensures that only processes with valid reservations can store or retrieve items.</p>
<p>ReservableReqStore preserves item order by associating an unreserved item in the store with a reservation event
by index when a reserve_get() request is made. As a result, it maintains a list of reserved events to preserve item order.</p>
<p>It also allows users to cancel an already placed reserve_get or reserve_put request even if it is yielded.
It also handles the dissociation of the event and item done at the time of reservation when an already yielded
event is canceled.</p>
<p>An item that is added into the BufferStore using put(), it is associated with a delay representing the time it takes for the item
to be available for retrieval. The delay can also be 0. The items can be retrieved in FIFO or LIFO manner based on the mode of operation of the BufferStore.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reserved_events</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Maintains events corresponding to reserved items to preserve item order by index</p>
              </div>
            </li>
            <li>
              <b><code>reserve_put_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_put</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reserve_get_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_get reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_get</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful get reservations</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <p>Args:</p>
<div class="codehilite"><pre><span></span><code>capacity (int, optional): The maximum number of items the store can hold.
                          Defaults to infinity.
mode (str, optional): The mode of the store (&#39;FIFO&#39; or &#39;LIFO&#39;). Defaults to &#39;FIFO&#39;.
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/buffer_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;FIFO&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>

<span class="sd">        capacity (int, optional): The maximum number of items the store can hold.</span>
<span class="sd">                                  Defaults to infinity.</span>
<span class="sd">        mode (str, optional): The mode of the store (&#39;FIFO&#39; or &#39;LIFO&#39;). Defaults to &#39;FIFO&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># Maintains events corresponding to reserved items to preserve item order</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">=</span><span class="p">[]</span>  <span class="c1">#Maintains the items ready to be taken out</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_items</span>   <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># parallel list of the exact items reserved</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_level_change_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_num_items</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_weighted_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_averaged_num_of_items_in_store</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Time-averaged number of items in the store</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.buffer_store.BufferStore.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span></code>

<a href="#factorysimpy.base.buffer_store.BufferStore.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Retrieve an item from the store after a successful reservation.</p>
<p>This method attempts to retrieve an item associated with a <code>reserve_get</code>
event. If the reservation exists, it triggers <code>_trigger_get</code> to retrieve
the item. If successful, <code>_trigger_reserve_put</code> is called to process any
pending <code>reserve_put</code> requests. If the item retrieval fails, an error
message is raised.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event associated with the request.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>item</code></b>(                  <code><span title="Object">Object</span></code>
)              –
              <div class="doc-md-description">
                <p>The retrieved item if successful, otherwise raises an error</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_get</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If item returned is None</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/buffer_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve an item from the store after a successful reservation.</span>

<span class="sd">    This method attempts to retrieve an item associated with a `reserve_get`</span>
<span class="sd">    event. If the reservation exists, it triggers `_trigger_get` to retrieve</span>
<span class="sd">    the item. If successful, `_trigger_reserve_put` is called to process any</span>
<span class="sd">    pending `reserve_put` requests. If the item retrieval fails, an error</span>
<span class="sd">    message is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event (simpy.Event): The reservation event associated with the request.</span>

<span class="sd">    Returns:</span>
<span class="sd">        item (Object): The retrieved item if successful, otherwise raises an error</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_get</span>
<span class="sd">        RuntimeError: If item returned is None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#if there are reservations, then call _trigger_get</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
      <span class="n">item</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span>
    <span class="c1">#else raise an error</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_get is empty&quot;</span><span class="p">)</span>
    <span class="c1">#if an item is returned then call _trigger_reserve_put to process pending requests</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No item found in the store for </span><span class="si">{</span><span class="n">get_event</span><span class="o">.</span><span class="n">requesting_process</span><span class="si">}</span><span class="s2"> and get request failed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1">#self._update_time_averaged_level()</span>
      <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.buffer_store.BufferStore.move_to_ready_items" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_to_ready_items</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.buffer_store.BufferStore.move_to_ready_items" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Move items from the store to the ready_items list after a put operation.
This method is called as a process to ensure that items are moved asynchronously.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/buffer_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_to_ready_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move items from the store to the ready_items list after a put operation.</span>
<span class="sd">    This method is called as a process to ensure that items are moved asynchronously.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Move items to the ready_items list</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="c1">#print(f&quot;T={self.env.now:.2f} beltstore received an item {item[0].id, item[1]} . Item started moving in belt&quot;)</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1">#print(f&quot;T={self.env.now:.2f} bufferstore finished moving item {item[0].id, item[1]} going to ready_items&quot;)</span>

        <span class="n">item_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">item_to_put</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">item_index</span><span class="p">)</span>  <span class="c1"># Remove the first item</span>
        <span class="c1">#print(item_to_put, item)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span><span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item_to_put</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1">#print(f&quot;T={self.env.now:.2f} bufferstore finished moving item {item[0].id, item[1]} moved to ready_items&quot;)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="c1">#print(f&quot;T={self.env.now:.2f} bufferstore is moving item {item[0].id, item[1]} to ready_items. Total items in buffer is {len(self.items)+len(self.ready_items)}&quot;   )</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Total number of items in the store exceeds capacity. Cannot move item to ready_items.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.buffer_store.BufferStore.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.buffer_store.BufferStore.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform a <code>put</code> operation on the store and trigger any pending <code>reserve_get</code> requests.</p>
<p>Ensures that only processes with a valid reservation can put items into the store.
If the put operation succeeds, it triggers <code>_trigger_reserve_get</code> to process pending get requests.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The event corresponding to the reservation.</p>
              </div>
            </li>
            <li>
              <b><code>item</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>The item to be added to the store.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the put operation succeeded, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_put</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If proceed is False after put operation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/buffer_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a `put` operation on the store and trigger any pending `reserve_get` requests.</span>

<span class="sd">    Ensures that only processes with a valid reservation can put items into the store.</span>
<span class="sd">    If the put operation succeeds, it triggers `_trigger_reserve_get` to process pending get requests.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event (simpy.Event): The event corresponding to the reservation.</span>
<span class="sd">        item (object): The item to be added to the store.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the put operation succeeded, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_put</span>
<span class="sd">        RuntimeError: If proceed is False after put operation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
      <span class="n">proceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_put is empty&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">proceed</span><span class="p">:</span>
      <span class="c1">#print(f&quot;{self.env.now} proceed&quot;)</span>
      <span class="c1">#self._trigger_get(None)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>



    <span class="k">if</span> <span class="ow">not</span> <span class="n">proceed</span><span class="p">:</span>

      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching put_event found in the reservations and put failed for</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1">#self._update_time_averaged_level()</span>
      <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.buffer_store.BufferStore.reserve_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get</span><span class="p">()</span></code>

<a href="#factorysimpy.base.buffer_store.BufferStore.reserve_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to retrieve an item from the store.</p>
<p>This method generates a SimPy event representing a request to reserve an item
for retrieval (<code>get</code>). The event is assigned attributes such as the resource 
it belongs to, and the process making the request.</p>
<p>The event is then added to <code>reserve_get_queue</code>, which is maintained in
the order in which the requests are made, and <code>_trigger_reserve_get()</code> is called to process pending
reservations if items are available.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when an item becomes available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/buffer_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to retrieve an item from the store.</span>

<span class="sd">    This method generates a SimPy event representing a request to reserve an item</span>
<span class="sd">    for retrieval (`get`). The event is assigned attributes such as the resource </span>
<span class="sd">    it belongs to, and the process making the request.</span>

<span class="sd">    The event is then added to `reserve_get_queue`, which is maintained in</span>
<span class="sd">    the order in which the requests are made, and `_trigger_reserve_get()` is called to process pending</span>
<span class="sd">    reservations if items are available.</span>


<span class="sd">    Returns:</span>
<span class="sd">       event (simpy.Event): A reservation event that will succeed when an item becomes available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#adding attributes to the newly created event for reserve_get</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span><span class="o">=</span><span class="bp">self</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Associate event with the current process</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.buffer_store.BufferStore.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.buffer_store.BufferStore.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_get</code> request.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/buffer_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_event_to_cancel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_get` request.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Case 1: still waiting</span>
    <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Case 2: already yielded reservation</span>
    <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
        <span class="c1"># 1) Remove from active reservations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

        <span class="c1"># 2) Find its index in the parallel lists</span>
        <span class="n">ev_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

        <span class="c1"># 3) Pop out the exact item reference</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ev_idx</span><span class="p">)</span>
        <span class="c1"># 4) Drop the event token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ev_idx</span><span class="p">)</span>

        <span class="c1"># 5) Remove it from ready_items wherever it currently is</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> not found in ready_items during cancel.&quot;</span><span class="p">)</span>

        <span class="c1"># 6) Compute new insertion index as a get call is cancelled and item that is reserved and associated to an event is now freely available to be assigned to a new incoming event</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;FIFO&quot;</span><span class="p">:</span>
            <span class="c1"># one slot before the remaining reserved block</span>
            <span class="n">insert_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># LIFO</span>
            <span class="c1"># top of stack</span>
            <span class="n">insert_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span>

        <span class="c1"># 7) Re‑insert it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_idx</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

        <span class="c1"># 8) Trigger any other pending reservations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># No such reservation</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
        <span class="s2">&quot;No matching event in reserve_get_queue or reservations_get&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.buffer_store.BufferStore.reserve_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put</span><span class="p">()</span></code>

<a href="#factorysimpy.base.buffer_store.BufferStore.reserve_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to put an item into the store.</p>
<p>This function generates a SimPy event representing a reservation request. The event is
assigned attributes such as resource name, and the process making the request.
The event is then added to <code>reserve_put_queue</code>, which is maintained in the order in which the requests are made.</p>
<p>After adding the event to the queue, <code>_trigger_reserve_put</code> is called to process
any pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when space is available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/buffer_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to put an item into the store.</span>

<span class="sd">    This function generates a SimPy event representing a reservation request. The event is</span>
<span class="sd">    assigned attributes such as resource name, and the process making the request.</span>
<span class="sd">    The event is then added to `reserve_put_queue`, which is maintained in the order in which the requests are made.</span>

<span class="sd">    After adding the event to the queue, `_trigger_reserve_put` is called to process</span>
<span class="sd">    any pending reservations.</span>



<span class="sd">    Returns:</span>
<span class="sd">        event (simpy.Event): A reservation event that will succeed when space is available.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># Store reference</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Process making the reservation</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>


    <span class="c1"># Attempt to process reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.buffer_store.BufferStore.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.buffer_store.BufferStore.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_put</code> request.</p>
<p>This method allows a process to cancel its reservation for putting an item
into the store. If the reservation exists in the <code>reserve_put_queue</code>, it is
removed before triggering <code>_trigger_reserve_put</code> to process any pending reservations.
If the reservation is already in <code>reservations_put</code>, it is also removed and
<code>_trigger_reserve_put</code> is triggered.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_put_queue</code>
          or <code>reservations_put</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/buffer_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">put_event_to_cancel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_put` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for putting an item</span>
<span class="sd">    into the store. If the reservation exists in the `reserve_put_queue`, it is</span>
<span class="sd">    removed before triggering `_trigger_reserve_put` to process any pending reservations.</span>
<span class="sd">    If the reservation is already in `reservations_put`, it is also removed and</span>
<span class="sd">    `_trigger_reserve_put` is triggered.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">       proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_put_queue`</span>
<span class="sd">                      or `reservations_put`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_put_queue</span>
  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_put</span>
  <span class="k">elif</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_put_queue or reservations_put for this process&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.base.fleet_store" class="doc doc-heading">
            <code>fleet_store</code>


<a href="#factorysimpy.base.fleet_store" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.fleet_store.FleetStore" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">FleetStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transit_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.store.Store">Store</span></code></p>


        <p>This is a class that is derived from SimPy's Store class and has extra capabilities
that makes it a priority-based reservable store for processes to reserve space
for storing and retrieving items with priority-based access.</p>
<p>Processes can use reserve_put() and reserve_get() methods to get notified when a space becomes
available in the store or when an item gets available in the ReservablePriorityReqStore.
These methods returns a unique event (SimPy.Event) to the process for every reserve requests it makes.
Processes can also pass a priority as argument in the request. Lower values indicate higher priority.</p>
<p>get and put are two methods that can be used for item storing and retrieval from ReservablePriorityReqStore.
Process has to make a prior reservation and pass the associated reservation event as argument in the get and
put requests. ReservablePriorityReqStore maintains separate queues for <code>reserve_put</code> and <code>reserve_get</code> operations
to ensures that only processes with valid reservations can store or retrieve items.</p>
<p>ReservablePriorityReqStore preserves item order by associating an unreserved item in the store with a reservation event
by index when a reserve_get() request is made. As a result, it maintains a list of reserved events to preserve item order.</p>
<p>It also allows users to cancel an already placed reserve_get or reserve_put request even if it is yielded.
It also handles the dissociation of the event and item done at the time of reservation when an already yielded
event is canceled.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reserved_events</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Maintains events corresponding to reserved items to preserve item order by index</p>
              </div>
            </li>
            <li>
              <b><code>reserve_put_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_put</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reserve_get_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_get reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_get</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful get reservations</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <p>Initializes a reservable store with priority-based reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>env</code></b>
                  (<code><span title="simpy.Environment">Environment</span></code>)
              –
              <div class="doc-md-description">
                <p>The simulation environment.</p>
              </div>
            </li>
            <li>
              <b><code>capacity</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code><span title="float">float</span>(&#39;inf&#39;)</code>
)
              –
              <div class="doc-md-description">
                <p>target quantity of items after which the fleet will be activated
                         Defaults to infinity.</p>
              </div>
            </li>
            <li>
              <b><code>delay</code></b>
                  (<code>(<span title="int">int</span>, <span title="float">float</span>)</code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>Delay after which fleet activates to move items incase the target capacity is not reached.</p>
              </div>
            </li>
            <li>
              <b><code>transit_delay</code></b>
                  (<code>(<span title="int">int</span>, <span title="float">float</span>)</code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>Time to move the items after which the item becomes available.
                                           Can be a constant, generator, or callable. Defaults to 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span><span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transit_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a reservable store with priority-based reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">     env (simpy.Environment): The simulation environment.</span>
<span class="sd">     capacity (int, optional): target quantity of items after which the fleet will be activated</span>
<span class="sd">                               Defaults to infinity.</span>
<span class="sd">     delay (int, float, optional): Delay after which fleet activates to move items incase the target capacity is not reached.</span>
<span class="sd">     transit_delay (int, float, optional): Time to move the items after which the item becomes available.</span>
<span class="sd">                                                 Can be a constant, generator, or callable. Defaults to 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transit_delay</span> <span class="o">=</span> <span class="n">transit_delay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># Maintains events corresponding to reserved items to preserve item order</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">=</span><span class="p">[]</span>  <span class="c1">#Maintains the items ready to be taken out</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_items</span>   <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># parallel list of the exact items reserved</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_level_change_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_num_items</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_weighted_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_averaged_num_of_items_in_store</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Time-averaged number of items in the store</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activate_fleet</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>  <span class="c1"># Event to activate the fleet when items are available</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fleet_activation_process</span><span class="p">())</span>  <span class="c1"># Start the fleet activation process</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.fleet_activation_process" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fleet_activation_process</span><span class="p">()</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.fleet_activation_process" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Process to activate the fleet when items are available but not equivalent to self.capacity(level not achieved).
This process waits for the activate_fleet event to be triggered.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fleet_activation_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process to activate the fleet when items are available but not equivalent to self.capacity(level not achieved).</span>
<span class="sd">    This process waits for the activate_fleet event to be triggered.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">timeout_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">)</span>
        <span class="n">event_list</span><span class="o">=</span> <span class="p">[</span><span class="n">timeout_event</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">activate_fleet</span><span class="p">]</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">any_of</span><span class="p">(</span><span class="n">event_list</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Fleet activation process triggered.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Fleet activated with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="si">}</span><span class="s2"> items ready.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">move_to_ready_items</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">))</span>
            <span class="c1">#self.env.process(self.move_to_ready_items(self.items))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">activate_fleet</span><span class="o">.</span><span class="n">triggered</span><span class="p">:</span>
                <span class="c1">#print(&quot;yes&quot;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">activate_fleet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>  <span class="c1"># Reset the event for next activation</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Retrieve an item from the store after a successful reservation.</p>
<p>This method attempts to retrieve an item associated with a <code>reserve_get</code>
event. If the reservation exists, it triggers <code>_trigger_get</code> to retrieve
the item. If successful, <code>_trigger_reserve_put</code> is called to process any
pending <code>reserve_put</code> requests. If the item retrieval fails, an error
message is raised.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event associated with the request.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>item</code></b>(                  <code><span title="Object">Object</span></code>
)              –
              <div class="doc-md-description">
                <p>The retrieved item if successful, otherwise raises an error</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_get</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If item returned is None</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve an item from the store after a successful reservation.</span>

<span class="sd">    This method attempts to retrieve an item associated with a `reserve_get`</span>
<span class="sd">    event. If the reservation exists, it triggers `_trigger_get` to retrieve</span>
<span class="sd">    the item. If successful, `_trigger_reserve_put` is called to process any</span>
<span class="sd">    pending `reserve_put` requests. If the item retrieval fails, an error</span>
<span class="sd">    message is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event (simpy.Event): The reservation event associated with the request.</span>

<span class="sd">    Returns:</span>
<span class="sd">        item (Object): The retrieved item if successful, otherwise raises an error</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_get</span>
<span class="sd">        RuntimeError: If item returned is None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#if there are reservations, then call _trigger_get</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
      <span class="n">item</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span>
    <span class="c1">#else raise an error</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_get is empty&quot;</span><span class="p">)</span>
    <span class="c1">#if an item is returned then call _trigger_reserve_put to process pending requests</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No item found in the store for </span><span class="si">{</span><span class="n">get_event</span><span class="o">.</span><span class="n">requesting_process</span><span class="si">}</span><span class="s2"> and get request failed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1">#self._update_time_averaged_level()</span>
      <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.move_to_ready_items" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_to_ready_items</span><span class="p">(</span><span class="n">items</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.move_to_ready_items" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Move items from the store to the ready_items list after a put operation.
This method is called as a process to ensure that items are moved asynchronously.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_to_ready_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move items from the store to the ready_items list after a put operation.</span>
<span class="sd">    This method is called as a process to ensure that items are moved asynchronously.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Move items to the ready_items list</span>
    <span class="k">if</span> <span class="n">items</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Moving items to ready_items.&quot;</span><span class="p">)</span>
        <span class="c1">#START=self.env.now</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_delay</span><span class="p">)</span>
        <span class="c1">#print(&quot;WAITED FOR TRANSIT_DELAY BEFORE MOVING&quot;, self.env.now-START)</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_delay</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>

            <span class="n">item_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">item_to_put</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">item_index</span><span class="p">)</span>  <span class="c1"># Remove the first item</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item_to_put</span><span class="p">)</span>
                <span class="c1">#print(f&quot;T={self.env.now:.2f}: {self.id} moved item {item_to_put.id} to ready_items.&quot;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="c1">#print(f&quot;T={self.env.now:.2f} bufferstore is moving item {item[0].id, item[1]} to ready_items. Total items in buffer is {len(self.items)+len(self.ready_items)}&quot;   )</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Total number of items in the store exceeds capacity. Cannot move item to ready_items.&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Fleetstore moved items to ready_items.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform a <code>put</code> operation on the store and trigger any pending <code>reserve_get</code> requests.</p>
<p>Ensures that only processes with a valid reservation can put items into the store.
If the put operation succeeds, it triggers <code>_trigger_reserve_get</code> to process pending get requests.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The event corresponding to the reservation.</p>
              </div>
            </li>
            <li>
              <b><code>item</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>The item to be added to the store.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the put operation succeeded, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_put</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If proceed is False after put operation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a `put` operation on the store and trigger any pending `reserve_get` requests.</span>

<span class="sd">    Ensures that only processes with a valid reservation can put items into the store.</span>
<span class="sd">    If the put operation succeeds, it triggers `_trigger_reserve_get` to process pending get requests.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event (simpy.Event): The event corresponding to the reservation.</span>
<span class="sd">        item (object): The item to be added to the store.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the put operation succeeded, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_put</span>
<span class="sd">        RuntimeError: If proceed is False after put operation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
      <span class="n">proceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_put is empty&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">proceed</span><span class="p">:</span>
      <span class="c1">#print(f&quot;{self.env.now} proceed&quot;)</span>
      <span class="c1">#self._trigger_get(None)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>



    <span class="k">if</span> <span class="ow">not</span> <span class="n">proceed</span><span class="p">:</span>

      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching put_event found in the reservations and put failed for</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1">#self._update_time_averaged_level()</span>
      <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.reserve_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.reserve_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to retrieve an item from the store.</p>
<p>This method generates a SimPy event representing a request to reserve an item
for retrieval (<code>get</code>). The event is assigned attributes such as priority,
the resource it belongs to, and the process making the request.</p>
<p>The event is then added to <code>reserve_get_queue</code>, which is maintained in
priority order, and <code>_trigger_reserve_get()</code> is called to process pending
reservations if items are available.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>priority</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The priority level of the reservation request.
                      Lower values indicate higher priority. Defaults to 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when an item becomes available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to retrieve an item from the store.</span>

<span class="sd">    This method generates a SimPy event representing a request to reserve an item</span>
<span class="sd">    for retrieval (`get`). The event is assigned attributes such as priority,</span>
<span class="sd">    the resource it belongs to, and the process making the request.</span>

<span class="sd">    The event is then added to `reserve_get_queue`, which is maintained in</span>
<span class="sd">    priority order, and `_trigger_reserve_get()` is called to process pending</span>
<span class="sd">    reservations if items are available.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (int, optional): The priority level of the reservation request.</span>
<span class="sd">                                  Lower values indicate higher priority. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">       event (simpy.Event): A reservation event that will succeed when an item becomes available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#adding attributes to the newly created event for reserve_get</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span><span class="o">=</span><span class="bp">self</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Associate event with the current process</span>

    <span class="c1">#event.priority_to_get = (priority, self._env.now)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">priority_to_get</span> <span class="o">=</span> <span class="n">priority</span>

    <span class="c1">#sorting the list based on priority after appending the new event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">priority_to_get</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_get</code> request.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_event_to_cancel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_get` request.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Case 1: still waiting</span>
    <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Case 2: already yielded reservation</span>
    <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
        <span class="c1"># 1) Remove from active reservations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

        <span class="c1"># 2) Find its index in the parallel lists</span>
        <span class="n">ev_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

        <span class="c1"># 3) Pop out the exact item reference</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ev_idx</span><span class="p">)</span>
        <span class="c1"># 4) Drop the event token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ev_idx</span><span class="p">)</span>

        <span class="c1"># 5) Remove it from ready_items wherever it currently is</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item </span><span class="si">{</span><span class="n">item</span><span class="si">!r}</span><span class="s2"> not found in ready_items during cancel.&quot;</span><span class="p">)</span>

        <span class="c1"># 6) Compute new insertion index</span>
        <span class="c1"># &quot;FIFO&quot;:</span>
            <span class="c1"># one slot before the remaining reserved block</span>
        <span class="n">insert_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>


        <span class="c1"># 7) Re‑insert it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_idx</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

        <span class="c1"># 8) Trigger any other pending reservations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># No such reservation</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
        <span class="s2">&quot;No matching event in reserve_get_queue or reservations_get&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.reserve_get_cancel1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel1</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.reserve_get_cancel1" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_get</code> request.</p>
<p>This method allows a process to cancel its reservation for retrieving an item
from the store. If the reservation exists in the <code>reserve_get_queue</code>, it is removed,
and <code>_trigger_reserve_get()</code> is called to process any remaining reservations.</p>
<p>If the reservation is already in <code>reservations_get</code>, it is removed, and the corresponding
item is repositioned in the store to maintain order. <code>_trigger_reserve_get()</code> is then
triggered to handle pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_get_queue</code>
          or <code>reservations_get</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_event_to_cancel</span><span class="p">):</span>

<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_get` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for retrieving an item</span>
<span class="sd">    from the store. If the reservation exists in the `reserve_get_queue`, it is removed,</span>
<span class="sd">    and `_trigger_reserve_get()` is called to process any remaining reservations.</span>

<span class="sd">    If the reservation is already in `reservations_get`, it is removed, and the corresponding</span>
<span class="sd">    item is repositioned in the store to maintain order. `_trigger_reserve_get()` is then</span>
<span class="sd">    triggered to handle pending reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_get_queue`</span>
<span class="sd">                      or `reservations_get`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_get_queue</span>
  <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_queue.</span>
  <span class="c1"># 1-to-1 association with items done to preserve item order should also be removed.</span>
  <span class="k">elif</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

    <span class="c1">#deleting the associated event in the reserved_events list to preserve the order of the items</span>
    <span class="c1">#finding index of the item</span>
    <span class="n">event_in_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
    <span class="n">delta_position</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="p">)</span>
    <span class="c1">#shifting the item</span>
    <span class="n">item_to_shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event_in_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">delta_position</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">item_to_shift</span><span class="p">)</span>
    <span class="c1">#deleting the event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event_in_index</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_get_queue or reservations_get for this process&quot;</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.reserve_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.reserve_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to put an item into the store.</p>
<p>This function generates a SimPy event representing a reservation request. The event is
assigned attributes such as priority, resource name, and the process making the request.
The event is then added to <code>reserve_put_queue</code>, which is maintained in priority order.</p>
<p>After adding the event to the queue, <code>_trigger_reserve_put</code> is called to process
any pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>priority</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The priority level of the reservation request.
                      Lower values indicate higher priority. Defaults to 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when space is available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to put an item into the store.</span>

<span class="sd">    This function generates a SimPy event representing a reservation request. The event is</span>
<span class="sd">    assigned attributes such as priority, resource name, and the process making the request.</span>
<span class="sd">    The event is then added to `reserve_put_queue`, which is maintained in priority order.</span>

<span class="sd">    After adding the event to the queue, `_trigger_reserve_put` is called to process</span>
<span class="sd">    any pending reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (int, optional): The priority level of the reservation request.</span>
<span class="sd">                                  Lower values indicate higher priority. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        event (simpy.Event): A reservation event that will succeed when space is available.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># Store reference</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Process making the reservation</span>
    <span class="n">event</span><span class="o">.</span><span class="n">priority_to_put</span> <span class="o">=</span> <span class="n">priority</span>  <span class="c1"># Priority for sorting reservations</span>

    <span class="c1"># Add the event to the reservation queue and sort by priority</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">priority_to_put</span><span class="p">)</span>

    <span class="c1"># Attempt to process reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.fleet_store.FleetStore.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.fleet_store.FleetStore.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_put</code> request.</p>
<p>This method allows a process to cancel its reservation for putting an item
into the store. If the reservation exists in the <code>reserve_put_queue</code>, it is
removed before triggering <code>_trigger_reserve_put</code> to process any pending reservations.
If the reservation is already in <code>reservations_put</code>, it is also removed and
<code>_trigger_reserve_put</code> is triggered.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_put_queue</code>
          or <code>reservations_put</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/fleet_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">put_event_to_cancel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_put` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for putting an item</span>
<span class="sd">    into the store. If the reservation exists in the `reserve_put_queue`, it is</span>
<span class="sd">    removed before triggering `_trigger_reserve_put` to process any pending reservations.</span>
<span class="sd">    If the reservation is already in `reservations_put`, it is also removed and</span>
<span class="sd">    `_trigger_reserve_put` is triggered.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">       proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_put_queue`</span>
<span class="sd">                      or `reservations_put`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_put_queue</span>
  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_put</span>
  <span class="k">elif</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_put_queue or reservations_put for this process&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.base.priority_req_store" class="doc doc-heading">
            <code>priority_req_store</code>


<a href="#factorysimpy.base.priority_req_store" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.priority_req_store.PriorityGet" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">PriorityGet</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.priority_req_store.PriorityGet" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.base.Get">Get</span></code></p>









                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/priority_req_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="p">):</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;The priority of this request. A smaller number means higher</span>
<span class="sd">   priority.&quot;&quot;&quot;</span>


   <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">now</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;The time at which the request was made.&quot;&quot;&quot;</span>

   <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">priority</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
   <span class="c1">#print(&quot;Resource is &quot;, resource)</span>


   <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="factorysimpy.base.priority_req_store.PriorityGet.priority" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#factorysimpy.base.priority_req_store.PriorityGet.priority" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>The priority of this request. A smaller number means higher
priority.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="factorysimpy.base.priority_req_store.PriorityGet.time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">time</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">now</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#factorysimpy.base.priority_req_store.PriorityGet.time" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>The time at which the request was made.</p>

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.priority_req_store.PriorityPut" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">PriorityPut</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.priority_req_store.PriorityPut" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.base.Put">Put</span></code></p>









                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/priority_req_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="p">):</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;The priority of this request. A smaller number means higher</span>
<span class="sd">   priority.&quot;&quot;&quot;</span>


   <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">now</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;The time at which the request was made.&quot;&quot;&quot;</span>

   <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">priority</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">item</span>
   <span class="c1">#print(&quot;Resource is &quot;, resource)</span>


   <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="factorysimpy.base.priority_req_store.PriorityPut.priority" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#factorysimpy.base.priority_req_store.PriorityPut.priority" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>The priority of this request. A smaller number means higher
priority.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="factorysimpy.base.priority_req_store.PriorityPut.time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">time</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">now</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#factorysimpy.base.priority_req_store.PriorityPut.time" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>The time at which the request was made.</p>

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.priority_req_store.PriorityReqStore" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">PriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#factorysimpy.base.priority_req_store.PriorityReqStore" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.store.Store">Store</span></code></p>


        <p>This is a class derived from SimPy's Store class and has extra capabilities
that makes it a priority-based store for put and get.</p>
<p>Processes can pass a priority as argument in the put and get request. Request with lower
values of priority yields first among all get(or put) requests. If two requests with same 
priority are placed from two processes then FIFO order is followed to yield the requests.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/priority_req_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="factorysimpy.base.priority_req_store.PriorityReqStore.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span> <span class="o">=</span> <span class="n">BoundClass</span><span class="p">(</span><span class="n">PriorityGet</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#factorysimpy.base.priority_req_store.PriorityReqStore.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>yields a get request with the given <em>priority</em>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="factorysimpy.base.priority_req_store.PriorityReqStore.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span> <span class="o">=</span> <span class="n">BoundClass</span><span class="p">(</span><span class="n">PriorityPut</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#factorysimpy.base.priority_req_store.PriorityReqStore.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>yields a put request with the given <em>priority</em></p>

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.priority_req_store.SortedQueue" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SortedQueue</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#factorysimpy.base.priority_req_store.SortedQueue" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="list">list</span></code></p>


        <p>Queue for sorting events by their :attr:<code>~PriorityRequest.key</code>
attribute.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/priority_req_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxlen</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">maxlen</span> <span class="o">=</span> <span class="n">maxlen</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximum length of the queue.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="factorysimpy.base.priority_req_store.SortedQueue.maxlen" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">maxlen</span> <span class="o">=</span> <span class="n">maxlen</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#factorysimpy.base.priority_req_store.SortedQueue.maxlen" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Maximum length of the queue.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.priority_req_store.SortedQueue.append" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.priority_req_store.SortedQueue.append" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Sort <em>item</em> into the queue.</p>
<p>Raise a :exc:<code>RuntimeError</code> if the queue is full.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/priority_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort *item* into the queue.</span>

<span class="sd">    Raise a :exc:`RuntimeError` if the queue is full.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxlen</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Cannot append event. Queue is full.&#39;</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.base.reservable_priority_req_filter_store" class="doc doc-heading">
            <code>reservable_priority_req_filter_store</code>


<a href="#factorysimpy.base.reservable_priority_req_filter_store" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ReservablePriorityReqFilterStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">trigger_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.store.FilterStore">FilterStore</span></code></p>


        <p>This is a class that is derived from SimPy's Store class and has extra capabilities
that makes it a priority-based reservable store for processes to reserve space
for storing and retrieving items with priority-based access. It supports user tp only get items that
match a user criteria</p>
<p>Processes can use reserve_put() and reserve_get() methods to get notified when a space becomes
available in the store or when an item gets available in the ReservablePriorityReqStore.
These methods returns a unique event (SimPy.Event) to the process for every reserve requests it makes.
Processes can also pass a priority as argument in the request. Lower values indicate higher priority.
Filter to be used while using "get" can be passed in the reserve_get request.</p>
<p>get and put are two methods that can be used for item storing and retrieval from ReservablePriorityReqStore.
Process has to make a prior reservation and pass the associated reservation event as argument in the get and
put requests. ReservablePriorityReqStore maintains separate queues for <code>reserve_put</code> and <code>reserve_get</code> operations
to ensures that only processes with valid reservations can store or retrieve items.</p>
<p>ReservablePriorityReqStore preserves item order by associating an unreserved item in the store with a reservation event
by index when a reserve_get() request is made. As a result, it maintains a list of reserved events to preserve item order.</p>
<p>It also allows users to cancel an already placed reserve_get or reserve_put request even if it is yielded.
It also handles the dissociation of the event and item done at the time of reservation when an already yielded
event is canceled.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reserved_events</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Maintains events corresponding to reserved items to preserve item order by index</p>
              </div>
            </li>
            <li>
              <b><code>reserve_put_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_put</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reserve_get_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_get reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_get</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful get reservations </p>
              </div>
            </li>
            <li>
              <b><code>trigger_delay</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>Delay time after which a trigger_reserve_get is called to allow waiting get calls to succeed.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <p>Initializes a reservable store with priority-based reservations.</p>
<p>Args:</p>
<div class="codehilite"><pre><span></span><code>capacity (int, optional): The maximum number of items the store can hold.
                          Defaults to infinity.
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_filter_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span><span class="n">trigger_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a reservable store with priority-based reservations.</span>

<span class="sd">    Args:</span>

<span class="sd">        capacity (int, optional): The maximum number of items the store can hold.</span>
<span class="sd">                                  Defaults to infinity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">trigger_delay</span> <span class="o">=</span> <span class="n">trigger_delay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># Maintains events corresponding to reserved items to preserve item order</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Retrieve an item from the store after a successful reservation.</p>
<p>This method attempts to retrieve an item associated with a <code>reserve_get</code>
event. If the reservation exists, it triggers <code>_trigger_get</code> to retrieve
the item. If successful, <code>_trigger_reserve_put</code> is called to process any
pending <code>reserve_put</code> requests. If the item retrieval fails, an error
message is raised.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event associated with the request.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>item</code></b>(                  <code><span title="Object">Object</span></code>
)              –
              <div class="doc-md-description">
                <p>The retrieved item if successful, otherwise raises an error</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_get</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If item returned is None</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_filter_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve an item from the store after a successful reservation.</span>

<span class="sd">    This method attempts to retrieve an item associated with a `reserve_get`</span>
<span class="sd">    event. If the reservation exists, it triggers `_trigger_get` to retrieve</span>
<span class="sd">    the item. If successful, `_trigger_reserve_put` is called to process any</span>
<span class="sd">    pending `reserve_put` requests. If the item retrieval fails, an error</span>
<span class="sd">    message is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event (simpy.Event): The reservation event associated with the request.</span>

<span class="sd">    Returns:</span>
<span class="sd">        item (Object): The retrieved item if successful, otherwise raises an error</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_get</span>
<span class="sd">        RuntimeError: If item returned is None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#if there are reservations, then call _trigger_get</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
      <span class="n">item</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span>
    <span class="c1">#else raise an error</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_get is empty&quot;</span><span class="p">)</span>
    <span class="c1">#if an item is returned then call _trigger_reserve_put to process pending requests</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No item found in the store for </span><span class="si">{</span><span class="n">get_event</span><span class="o">.</span><span class="n">requesting_process</span><span class="si">}</span><span class="s2"> and get request failed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform a <code>put</code> operation on the store and trigger any pending <code>reserve_get</code> requests.</p>
<p>Ensures that only processes with a valid reservation can put items into the store.
If the put operation succeeds, it triggers <code>_trigger_reserve_get</code> to process pending get requests.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The event corresponding to the reservation.</p>
              </div>
            </li>
            <li>
              <b><code>item</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>The item to be added to the store.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the put operation succeeded, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_put</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If proceed is False after put operation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_filter_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">,):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a `put` operation on the store and trigger any pending `reserve_get` requests.</span>

<span class="sd">    Ensures that only processes with a valid reservation can put items into the store.</span>
<span class="sd">    If the put operation succeeds, it triggers `_trigger_reserve_get` to process pending get requests.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event (simpy.Event): The event corresponding to the reservation.</span>
<span class="sd">        item (object): The item to be added to the store.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the put operation succeeded, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_put</span>
<span class="sd">        RuntimeError: If proceed is False after put operation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
      <span class="n">proceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_put is empty&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">proceed</span><span class="p">:</span>
      <span class="c1">#print(f&quot;{self.env.now} proceed&quot;)</span>
      <span class="c1">#self._trigger_get(None)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">proceed</span><span class="p">:</span>

      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching put_event found in the reservations and put failed for</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.reserve_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.reserve_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to retrieve an item from the store.</p>
<p>This method generates a SimPy event representing a request to reserve an item
for retrieval (<code>get</code>). The event is assigned attributes such as priority,
the resource it belongs to, and the process making the request.</p>
<p>The event is then added to <code>reserve_get_queue</code>, which is maintained in
priority order, and <code>_trigger_reserve_get()</code> is called to process pending
reservations if items are available.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>priority</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The priority level of the reservation request.
                      Lower values indicate higher priority. Defaults to 0.</p>
              </div>
            </li>
            <li>
              <b><code>filter</code></b>
                  (<code>filter=lambdaitem=True</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Filter to be used while using "reserve_get</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when an item becomes available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_filter_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">filter</span><span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to retrieve an item from the store.</span>

<span class="sd">    This method generates a SimPy event representing a request to reserve an item</span>
<span class="sd">    for retrieval (`get`). The event is assigned attributes such as priority,</span>
<span class="sd">    the resource it belongs to, and the process making the request.</span>

<span class="sd">    The event is then added to `reserve_get_queue`, which is maintained in</span>
<span class="sd">    priority order, and `_trigger_reserve_get()` is called to process pending</span>
<span class="sd">    reservations if items are available.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (int, optional): The priority level of the reservation request.</span>
<span class="sd">                                  Lower values indicate higher priority. Defaults to 0.</span>
<span class="sd">        filter (filter=lambdaitem=True, optional):  Filter to be used while using &quot;reserve_get</span>

<span class="sd">    Returns:</span>
<span class="sd">        event (simpy.Event): A reservation event that will succeed when an item becomes available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#adding attributes to the newly created event for reserve_get</span>

    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span><span class="o">=</span><span class="bp">self</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Associate event with the current process</span>
    <span class="c1">#event.priority_to_get = (priority, self._env.now)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">priority_to_get</span> <span class="o">=</span> <span class="n">priority</span>

    <span class="c1"># Check if &#39;filter&#39; is provided, if not, assign a default filter</span>
    <span class="k">if</span> <span class="nb">filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#print(f&quot;T={self.env.now} filter is None so making it true for all items&quot;)</span>
        <span class="c1">#filter = lambda item: True  # Default filter that accepts all items</span>
        <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="o">&gt;=</span> <span class="n">x</span><span class="o">.</span><span class="n">put_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_delay</span>
        <span class="n">event</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="nb">filter</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print(f&quot;T={self.env.now} filter is not None &quot;)</span>
        <span class="n">event</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="nb">filter</span>

    <span class="c1">#sorting the list based on priority after appending the new event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">priority_to_get</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_get</code> request.</p>
<p>This method allows a process to cancel its reservation for retrieving an item
from the store. If the reservation exists in the <code>reserve_get_queue</code>, it is removed,
and <code>_trigger_reserve_get()</code> is called to process any remaining reservations.</p>
<p>If the reservation is already in <code>reservations_get</code>, it is removed, and the corresponding
item is repositioned in the store to maintain order. <code>_trigger_reserve_get()</code> is then
triggered to handle pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_get_queue</code>
          or <code>reservations_get</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_filter_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_event_to_cancel</span><span class="p">):</span>

<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_get` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for retrieving an item</span>
<span class="sd">    from the store. If the reservation exists in the `reserve_get_queue`, it is removed,</span>
<span class="sd">    and `_trigger_reserve_get()` is called to process any remaining reservations.</span>

<span class="sd">    If the reservation is already in `reservations_get`, it is removed, and the corresponding</span>
<span class="sd">    item is repositioned in the store to maintain order. `_trigger_reserve_get()` is then</span>
<span class="sd">    triggered to handle pending reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_get_queue`</span>
<span class="sd">                      or `reservations_get`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_get_queue</span>
  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="k">return</span> <span class="kc">True</span>

  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_queue.</span>
  <span class="c1"># 1-to-1 association with items done to preserve item order should also be removed.</span>
  <span class="k">elif</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

    <span class="c1">#deleting the associated event in the reserved_events list to preserve the order of the items</span>
    <span class="c1">#finding index of the item</span>
    <span class="n">event_in_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
    <span class="n">delta_position</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="p">)</span>
    <span class="c1">#shifting the item</span>
    <span class="n">item_to_shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event_in_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">delta_position</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">item_to_shift</span><span class="p">)</span>
    <span class="c1">#deleting the event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event_in_index</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_get_queue or reservations_get for this process&quot;</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.reserve_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.reserve_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to put an item into the store.</p>
<p>This function generates a SimPy event representing a reservation request. The event is
assigned attributes such as priority, resource name, and the process making the request.
The event is then added to <code>reserve_put_queue</code>, which is maintained in priority order.</p>
<p>After adding the event to the queue, <code>_trigger_reserve_put</code> is called to process
any pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>priority</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The priority level of the reservation request.
                      Lower values indicate higher priority. Defaults to 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when space is available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_filter_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to put an item into the store.</span>

<span class="sd">    This function generates a SimPy event representing a reservation request. The event is</span>
<span class="sd">    assigned attributes such as priority, resource name, and the process making the request.</span>
<span class="sd">    The event is then added to `reserve_put_queue`, which is maintained in priority order.</span>

<span class="sd">    After adding the event to the queue, `_trigger_reserve_put` is called to process</span>
<span class="sd">    any pending reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (int, optional): The priority level of the reservation request.</span>
<span class="sd">                                  Lower values indicate higher priority. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        event (simpy.Event): A reservation event that will succeed when space is available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># Store reference</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Process making the reservation</span>
    <span class="n">event</span><span class="o">.</span><span class="n">priority_to_put</span> <span class="o">=</span> <span class="n">priority</span>  <span class="c1"># Priority for sorting reservations</span>

    <span class="c1"># Add the event to the reservation queue and sort by priority</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">priority_to_put</span><span class="p">)</span>

    <span class="c1"># Attempt to process reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_filter_store.ReservablePriorityReqFilterStore.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_put</code> request.</p>
<p>This method allows a process to cancel its reservation for putting an item
into the store. If the reservation exists in the <code>reserve_put_queue</code>, it is
removed before triggering <code>_trigger_reserve_put</code> to process any pending reservations.
If the reservation is already in <code>reservations_put</code>, it is also removed and
<code>_trigger_reserve_put</code> is triggered.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_put_queue</code>
          or <code>reservations_put</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_filter_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">put_event_to_cancel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_put` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for putting an item</span>
<span class="sd">    into the store. If the reservation exists in the `reserve_put_queue`, it is</span>
<span class="sd">    removed before triggering `_trigger_reserve_put` to process any pending reservations.</span>
<span class="sd">    If the reservation is already in `reservations_put`, it is also removed and</span>
<span class="sd">    `_trigger_reserve_put` is triggered.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_put_queue`</span>
<span class="sd">                      or `reservations_put`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_put_queue</span>
  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span>  <span class="kc">True</span>
  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_put</span>
  <span class="k">elif</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span>  <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_put_queue or reservations_put for this process&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.base.reservable_priority_req_store" class="doc doc-heading">
            <code>reservable_priority_req_store</code>


<a href="#factorysimpy.base.reservable_priority_req_store" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ReservablePriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span></code>

<a href="#factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.store.Store">Store</span></code></p>


        <p>This is a class that is derived from SimPy's Store class and has extra capabilities
that makes it a priority-based reservable store for processes to reserve space
for storing and retrieving items with priority-based access.</p>
<p>Processes can use reserve_put() and reserve_get() methods to get notified when a space becomes
available in the store or when an item gets available in the ReservablePriorityReqStore.
These methods returns a unique event (SimPy.Event) to the process for every reserve requests it makes.
Processes can also pass a priority as argument in the request. Lower values indicate higher priority.</p>
<p>get and put are two methods that can be used for item storing and retrieval from ReservablePriorityReqStore.
Process has to make a prior reservation and pass the associated reservation event as argument in the get and
put requests. ReservablePriorityReqStore maintains separate queues for <code>reserve_put</code> and <code>reserve_get</code> operations
to ensures that only processes with valid reservations can store or retrieve items.</p>
<p>ReservablePriorityReqStore preserves item order by associating an unreserved item in the store with a reservation event
by index when a reserve_get() request is made. As a result, it maintains a list of reserved events to preserve item order.</p>
<p>It also allows users to cancel an already placed reserve_get or reserve_put request even if it is yielded.
It also handles the dissociation of the event and item done at the time of reservation when an already yielded
event is canceled.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reserved_events</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Maintains events corresponding to reserved items to preserve item order by index</p>
              </div>
            </li>
            <li>
              <b><code>reserve_put_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_put</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reserve_get_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_get reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_get</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful get reservations</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <p>Initializes a reservable store with priority-based reservations.</p>
<p>Args:</p>
<div class="codehilite"><pre><span></span><code>capacity (int, optional): The maximum number of items the store can hold.
                          Defaults to infinity.
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a reservable store with priority-based reservations.</span>

<span class="sd">    Args:</span>

<span class="sd">        capacity (int, optional): The maximum number of items the store can hold.</span>
<span class="sd">                                  Defaults to infinity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># Maintains events corresponding to reserved items to preserve item order</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_level_change_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_num_items</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_weighted_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_averaged_num_of_items_in_store</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Time-averaged number of items in the store</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Retrieve an item from the store after a successful reservation.</p>
<p>This method attempts to retrieve an item associated with a <code>reserve_get</code>
event. If the reservation exists, it triggers <code>_trigger_get</code> to retrieve
the item. If successful, <code>_trigger_reserve_put</code> is called to process any
pending <code>reserve_put</code> requests. If the item retrieval fails, an error
message is raised.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event associated with the request.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>item</code></b>(                  <code><span title="Object">Object</span></code>
)              –
              <div class="doc-md-description">
                <p>The retrieved item if successful, otherwise raises an error</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_get</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If item returned is None</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve an item from the store after a successful reservation.</span>

<span class="sd">    This method attempts to retrieve an item associated with a `reserve_get`</span>
<span class="sd">    event. If the reservation exists, it triggers `_trigger_get` to retrieve</span>
<span class="sd">    the item. If successful, `_trigger_reserve_put` is called to process any</span>
<span class="sd">    pending `reserve_put` requests. If the item retrieval fails, an error</span>
<span class="sd">    message is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event (simpy.Event): The reservation event associated with the request.</span>

<span class="sd">    Returns:</span>
<span class="sd">        item (Object): The retrieved item if successful, otherwise raises an error</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_get</span>
<span class="sd">        RuntimeError: If item returned is None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#if there are reservations, then call _trigger_get</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
      <span class="n">item</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span>
    <span class="c1">#else raise an error</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_get is empty&quot;</span><span class="p">)</span>
    <span class="c1">#if an item is returned then call _trigger_reserve_put to process pending requests</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No item found in the store for </span><span class="si">{</span><span class="n">get_event</span><span class="o">.</span><span class="n">requesting_process</span><span class="si">}</span><span class="s2"> and get request failed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_update_time_averaged_level</span><span class="p">()</span>
      <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform a <code>put</code> operation on the store and trigger any pending <code>reserve_get</code> requests.</p>
<p>Ensures that only processes with a valid reservation can put items into the store.
If the put operation succeeds, it triggers <code>_trigger_reserve_get</code> to process pending get requests.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The event corresponding to the reservation.</p>
              </div>
            </li>
            <li>
              <b><code>item</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>The item to be added to the store.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the put operation succeeded, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_put</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If proceed is False after put operation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a `put` operation on the store and trigger any pending `reserve_get` requests.</span>

<span class="sd">    Ensures that only processes with a valid reservation can put items into the store.</span>
<span class="sd">    If the put operation succeeds, it triggers `_trigger_reserve_get` to process pending get requests.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event (simpy.Event): The event corresponding to the reservation.</span>
<span class="sd">        item (object): The item to be added to the store.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the put operation succeeded, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_put</span>
<span class="sd">        RuntimeError: If proceed is False after put operation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
      <span class="n">proceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_put is empty&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">proceed</span><span class="p">:</span>
      <span class="c1">#print(f&quot;{self.env.now} proceed&quot;)</span>
      <span class="c1">#self._trigger_get(None)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1">#if the put operation is not successful, then raise an erro</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">proceed</span><span class="p">:</span>

      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching put_event found in the reservations and put failed for</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_update_time_averaged_level</span><span class="p">()</span>
      <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.reserve_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.reserve_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to retrieve an item from the store.</p>
<p>This method generates a SimPy event representing a request to reserve an item
for retrieval (<code>get</code>). The event is assigned attributes such as priority,
the resource it belongs to, and the process making the request.</p>
<p>The event is then added to <code>reserve_get_queue</code>, which is maintained in
priority order, and <code>_trigger_reserve_get()</code> is called to process pending
reservations if items are available.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>priority</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The priority level of the reservation request.
                      Lower values indicate higher priority. Defaults to 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when an item becomes available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to retrieve an item from the store.</span>

<span class="sd">    This method generates a SimPy event representing a request to reserve an item</span>
<span class="sd">    for retrieval (`get`). The event is assigned attributes such as priority,</span>
<span class="sd">    the resource it belongs to, and the process making the request.</span>

<span class="sd">    The event is then added to `reserve_get_queue`, which is maintained in</span>
<span class="sd">    priority order, and `_trigger_reserve_get()` is called to process pending</span>
<span class="sd">    reservations if items are available.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (int, optional): The priority level of the reservation request.</span>
<span class="sd">                                  Lower values indicate higher priority. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">       event (simpy.Event): A reservation event that will succeed when an item becomes available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#adding attributes to the newly created event for reserve_get</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span><span class="o">=</span><span class="bp">self</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Associate event with the current process</span>

    <span class="c1">#event.priority_to_get = (priority, self._env.now)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">priority_to_get</span> <span class="o">=</span> <span class="n">priority</span>

    <span class="c1">#sorting the list based on priority after appending the new event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">priority_to_get</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_get</code> request.</p>
<p>This method allows a process to cancel its reservation for retrieving an item
from the store. If the reservation exists in the <code>reserve_get_queue</code>, it is removed,
and <code>_trigger_reserve_get()</code> is called to process any remaining reservations.</p>
<p>If the reservation is already in <code>reservations_get</code>, it is removed, and the corresponding
item is repositioned in the store to maintain order. <code>_trigger_reserve_get()</code> is then
triggered to handle pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_get_queue</code>
          or <code>reservations_get</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_event_to_cancel</span><span class="p">):</span>

<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_get` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for retrieving an item</span>
<span class="sd">    from the store. If the reservation exists in the `reserve_get_queue`, it is removed,</span>
<span class="sd">    and `_trigger_reserve_get()` is called to process any remaining reservations.</span>

<span class="sd">    If the reservation is already in `reservations_get`, it is removed, and the corresponding</span>
<span class="sd">    item is repositioned in the store to maintain order. `_trigger_reserve_get()` is then</span>
<span class="sd">    triggered to handle pending reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_get_queue`</span>
<span class="sd">                      or `reservations_get`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_get_queue</span>
  <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_queue.</span>
  <span class="c1"># 1-to-1 association with items done to preserve item order should also be removed.</span>
  <span class="k">elif</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

    <span class="c1">#deleting the associated event in the reserved_events list to preserve the order of the items</span>
    <span class="c1">#finding index of the item</span>
    <span class="n">event_in_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
    <span class="n">delta_position</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="p">)</span>
    <span class="c1">#shifting the item</span>
    <span class="n">item_to_shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event_in_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">delta_position</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">item_to_shift</span><span class="p">)</span>
    <span class="c1">#deleting the event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event_in_index</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_get_queue or reservations_get for this process&quot;</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.reserve_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.reserve_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to put an item into the store.</p>
<p>This function generates a SimPy event representing a reservation request. The event is
assigned attributes such as priority, resource name, and the process making the request.
The event is then added to <code>reserve_put_queue</code>, which is maintained in priority order.</p>
<p>After adding the event to the queue, <code>_trigger_reserve_put</code> is called to process
any pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>priority</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The priority level of the reservation request.
                      Lower values indicate higher priority. Defaults to 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when space is available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to put an item into the store.</span>

<span class="sd">    This function generates a SimPy event representing a reservation request. The event is</span>
<span class="sd">    assigned attributes such as priority, resource name, and the process making the request.</span>
<span class="sd">    The event is then added to `reserve_put_queue`, which is maintained in priority order.</span>

<span class="sd">    After adding the event to the queue, `_trigger_reserve_put` is called to process</span>
<span class="sd">    any pending reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (int, optional): The priority level of the reservation request.</span>
<span class="sd">                                  Lower values indicate higher priority. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        event (simpy.Event): A reservation event that will succeed when space is available.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># Store reference</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Process making the reservation</span>
    <span class="n">event</span><span class="o">.</span><span class="n">priority_to_put</span> <span class="o">=</span> <span class="n">priority</span>  <span class="c1"># Priority for sorting reservations</span>

    <span class="c1"># Add the event to the reservation queue and sort by priority</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">priority_to_put</span><span class="p">)</span>

    <span class="c1"># Attempt to process reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_priority_req_store.ReservablePriorityReqStore.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_put</code> request.</p>
<p>This method allows a process to cancel its reservation for putting an item
into the store. If the reservation exists in the <code>reserve_put_queue</code>, it is
removed before triggering <code>_trigger_reserve_put</code> to process any pending reservations.
If the reservation is already in <code>reservations_put</code>, it is also removed and
<code>_trigger_reserve_put</code> is triggered.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_put_queue</code>
          or <code>reservations_put</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_priority_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">put_event_to_cancel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_put` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for putting an item</span>
<span class="sd">    into the store. If the reservation exists in the `reserve_put_queue`, it is</span>
<span class="sd">    removed before triggering `_trigger_reserve_put` to process any pending reservations.</span>
<span class="sd">    If the reservation is already in `reservations_put`, it is also removed and</span>
<span class="sd">    `_trigger_reserve_put` is triggered.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">       proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_put_queue`</span>
<span class="sd">                      or `reservations_put`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_put_queue</span>
  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_put</span>
  <span class="k">elif</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_put_queue or reservations_put for this process&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.base.reservable_req_store" class="doc doc-heading">
            <code>reservable_req_store</code>


<a href="#factorysimpy.base.reservable_req_store" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.reservable_req_store.ReservableReqStore" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ReservableReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span></code>

<a href="#factorysimpy.base.reservable_req_store.ReservableReqStore" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.store.Store">Store</span></code></p>


        <p>This is a class that is derived from SimPy's Store class and has extra capabilities
that makes it a reservable store for processes to reserve space
for storing and retrieving items.</p>
<p>Processes can use reserve_put() and reserve_get() methods to get notified when a space becomes
available in the store or when an item gets available in the ReservableReqStore.
These methods returns a unique event (SimPy.Event) to the process for every reserve requests it makes.</p>
<p>get and put are two methods that can be used for item storing and retrieval from ReservableReqStore.
Process has to make a prior reservation and pass the associated reservation event as argument in the get and
put requests. ReservableReqStore maintains separate queues for <code>reserve_put</code> and <code>reserve_get</code> operations
to ensures that only processes with valid reservations can store or retrieve items.</p>
<p>ReservableReqStore preserves item order by associating an unreserved item in the store with a reservation event
by index when a reserve_get() request is made. As a result, it maintains a list of reserved events to preserve item order.</p>
<p>It also allows users to cancel an already placed reserve_get or reserve_put request even if it is yielded.
It also handles the dissociation of the event and item done at the time of reservation when an already yielded
event is canceled.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reserved_events</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Maintains events corresponding to reserved items to preserve item order by index</p>
              </div>
            </li>
            <li>
              <b><code>reserve_put_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_put</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reserve_get_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_get reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_get</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful get reservations</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <p>Initializes a reservable store with reservations.</p>
<p>Args:</p>
<div class="codehilite"><pre><span></span><code>capacity (int, optional): The maximum number of items the store can hold.
                          Defaults to infinity.
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/reservable_req_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a reservable store with reservations.</span>

<span class="sd">    Args:</span>

<span class="sd">        capacity (int, optional): The maximum number of items the store can hold.</span>
<span class="sd">                                  Defaults to infinity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># Maintains events corresponding to reserved items to preserve item order</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_level_change_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_num_items</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_weighted_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_averaged_num_of_items_in_store</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Time-averaged number of items in the store</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_req_store.ReservableReqStore.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_req_store.ReservableReqStore.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Retrieve an item from the store after a successful reservation.</p>
<p>This method attempts to retrieve an item associated with a <code>reserve_get</code>
event. If the reservation exists, it triggers <code>_trigger_get</code> to retrieve
the item. If successful, <code>_trigger_reserve_put</code> is called to process any
pending <code>reserve_put</code> requests. If the item retrieval fails, an error
message is raised.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event associated with the request.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>item</code></b>(                  <code><span title="Object">Object</span></code>
)              –
              <div class="doc-md-description">
                <p>The retrieved item if successful, otherwise raises an error</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_get</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If item returned is None</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve an item from the store after a successful reservation.</span>

<span class="sd">    This method attempts to retrieve an item associated with a `reserve_get`</span>
<span class="sd">    event. If the reservation exists, it triggers `_trigger_get` to retrieve</span>
<span class="sd">    the item. If successful, `_trigger_reserve_put` is called to process any</span>
<span class="sd">    pending `reserve_put` requests. If the item retrieval fails, an error</span>
<span class="sd">    message is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event (simpy.Event): The reservation event associated with the request.</span>

<span class="sd">    Returns:</span>
<span class="sd">        item (Object): The retrieved item if successful, otherwise raises an error</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_get</span>
<span class="sd">        RuntimeError: If item returned is None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#if there are reservations, then call _trigger_get</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
      <span class="n">item</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span>
    <span class="c1">#else raise an error</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_get is empty&quot;</span><span class="p">)</span>
    <span class="c1">#if an item is returned then call _trigger_reserve_put to process pending requests</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No item found in the store for </span><span class="si">{</span><span class="n">get_event</span><span class="o">.</span><span class="n">requesting_process</span><span class="si">}</span><span class="s2"> and get request failed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_update_time_averaged_level</span><span class="p">()</span>
      <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_req_store.ReservableReqStore.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_req_store.ReservableReqStore.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform a <code>put</code> operation on the store and trigger any pending <code>reserve_get</code> requests.</p>
<p>Ensures that only processes with a valid reservation can put items into the store.
If the put operation succeeds, it triggers <code>_trigger_reserve_get</code> to process pending get requests.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The event corresponding to the reservation.</p>
              </div>
            </li>
            <li>
              <b><code>item</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>The item to be added to the store.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the put operation succeeded, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_put</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If proceed is False after put operation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a `put` operation on the store and trigger any pending `reserve_get` requests.</span>

<span class="sd">    Ensures that only processes with a valid reservation can put items into the store.</span>
<span class="sd">    If the put operation succeeds, it triggers `_trigger_reserve_get` to process pending get requests.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event (simpy.Event): The event corresponding to the reservation.</span>
<span class="sd">        item (object): The item to be added to the store.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the put operation succeeded, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_put</span>
<span class="sd">        RuntimeError: If proceed is False after put operation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
      <span class="n">proceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_put is empty&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">proceed</span><span class="p">:</span>
      <span class="c1">#print(f&quot;{self.env.now} proceed&quot;)</span>
      <span class="c1">#self._trigger_get(None)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1">#if the put operation is not successful, then raise an erro</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">proceed</span><span class="p">:</span>

      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching put_event found in the reservations and put failed for</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_update_time_averaged_level</span><span class="p">()</span>
      <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_req_store.ReservableReqStore.reserve_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get</span><span class="p">()</span></code>

<a href="#factorysimpy.base.reservable_req_store.ReservableReqStore.reserve_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to retrieve an item from the store.</p>
<p>This method generates a SimPy event representing a request to reserve an item
for retrieval (<code>get</code>). The event is assigned attributes such as the resource it belongs to, and the process making the request.</p>
<p>The event is then added to <code>reserve_get_queue</code>, which is maintained in
the order in which it has added, and <code>_trigger_reserve_get()</code> is called to process pending
reservations if items are available.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when an item becomes available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to retrieve an item from the store.</span>

<span class="sd">    This method generates a SimPy event representing a request to reserve an item</span>
<span class="sd">    for retrieval (`get`). The event is assigned attributes such as the resource it belongs to, and the process making the request.</span>

<span class="sd">    The event is then added to `reserve_get_queue`, which is maintained in</span>
<span class="sd">    the order in which it has added, and `_trigger_reserve_get()` is called to process pending</span>
<span class="sd">    reservations if items are available.</span>



<span class="sd">    Returns:</span>
<span class="sd">       event (simpy.Event): A reservation event that will succeed when an item becomes available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#adding attributes to the newly created event for reserve_get</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span><span class="o">=</span><span class="bp">self</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Associate event with the current process</span>




    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_req_store.ReservableReqStore.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_req_store.ReservableReqStore.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_get</code> request.</p>
<p>This method allows a process to cancel its reservation for retrieving an item
from the store. If the reservation exists in the <code>reserve_get_queue</code>, it is removed,
and <code>_trigger_reserve_get()</code> is called to process any remaining reservations.</p>
<p>If the reservation is already in <code>reservations_get</code>, it is removed, and the corresponding
item is repositioned in the store to maintain order. <code>_trigger_reserve_get()</code> is then
triggered to handle pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_get_queue</code>
          or <code>reservations_get</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_event_to_cancel</span><span class="p">):</span>

<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_get` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for retrieving an item</span>
<span class="sd">    from the store. If the reservation exists in the `reserve_get_queue`, it is removed,</span>
<span class="sd">    and `_trigger_reserve_get()` is called to process any remaining reservations.</span>

<span class="sd">    If the reservation is already in `reservations_get`, it is removed, and the corresponding</span>
<span class="sd">    item is repositioned in the store to maintain order. `_trigger_reserve_get()` is then</span>
<span class="sd">    triggered to handle pending reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_get_queue`</span>
<span class="sd">                      or `reservations_get`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_get_queue</span>
  <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_queue.</span>
  <span class="c1"># 1-to-1 association with items done to preserve item order should also be removed.</span>
  <span class="k">elif</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

    <span class="c1">#deleting the associated event in the reserved_events list to preserve the order of the items</span>
    <span class="c1">#finding index of the item</span>
    <span class="n">event_in_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
    <span class="n">delta_position</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="p">)</span>
    <span class="c1">#shifting the item</span>
    <span class="n">item_to_shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event_in_index</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">delta_position</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">item_to_shift</span><span class="p">)</span>
    <span class="c1">#deleting the event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">event_in_index</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_get_queue or reservations_get for this process&quot;</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_req_store.ReservableReqStore.reserve_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put</span><span class="p">()</span></code>

<a href="#factorysimpy.base.reservable_req_store.ReservableReqStore.reserve_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to put an item into the store.</p>
<p>This function generates a SimPy event representing a reservation request. The event is
assigned attributes such as the resource name, and the process making the request.
The event is then added to <code>reserve_put_queue</code>, which is maintained in the order in which the request has come.</p>
<p>After adding the event to the queue, <code>_trigger_reserve_put</code> is called to process
any pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when space is available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to put an item into the store.</span>

<span class="sd">    This function generates a SimPy event representing a reservation request. The event is</span>
<span class="sd">    assigned attributes such as the resource name, and the process making the request.</span>
<span class="sd">    The event is then added to `reserve_put_queue`, which is maintained in the order in which the request has come.</span>

<span class="sd">    After adding the event to the queue, `_trigger_reserve_put` is called to process</span>
<span class="sd">    any pending reservations.</span>




<span class="sd">    Returns:</span>
<span class="sd">        event (simpy.Event): A reservation event that will succeed when space is available.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># Store reference</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Process making the reservation</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>


    <span class="c1"># Attempt to process reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.reservable_req_store.ReservableReqStore.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.reservable_req_store.ReservableReqStore.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_put</code> request.</p>
<p>This method allows a process to cancel its reservation for putting an item
into the store. If the reservation exists in the <code>reserve_put_queue</code>, it is
removed before triggering <code>_trigger_reserve_put</code> to process any pending reservations.
If the reservation is already in <code>reservations_put</code>, it is also removed and
<code>_trigger_reserve_put</code> is triggered.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_put_queue</code>
          or <code>reservations_put</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/reservable_req_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">put_event_to_cancel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_put` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for putting an item</span>
<span class="sd">    into the store. If the reservation exists in the `reserve_put_queue`, it is</span>
<span class="sd">    removed before triggering `_trigger_reserve_put` to process any pending reservations.</span>
<span class="sd">    If the reservation is already in `reservations_put`, it is also removed and</span>
<span class="sd">    `_trigger_reserve_put` is triggered.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">       proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_put_queue`</span>
<span class="sd">                      or `reservations_put`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_put_queue</span>
  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_put</span>
  <span class="k">elif</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_put_queue or reservations_put for this process&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.base.slotted_belt_store" class="doc doc-heading">
            <code>slotted_belt_store</code>


<a href="#factorysimpy.base.slotted_belt_store" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.base.slotted_belt_store.BeltStore" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">BeltStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;FIFO&#39;</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="simpy.resources.store.Store">Store</span></code></p>


        <p>This is a class that is derived from SimPy's Store class and has extra capabilities
that makes it a priority-based reservable store for processes to reserve space
for storing and retrieving items with priority-based access.</p>
<p>Processes can use reserve_put() and reserve_get() methods to get notified when a space becomes
available in the store or when an item gets available in the ReservablePriorityReqStore.
These methods returns a unique event (SimPy.Event) to the process for every reserve requests it makes.
Processes can also pass a priority as argument in the request. Lower values indicate higher priority.</p>
<p>get and put are two methods that can be used for item storing and retrieval from ReservablePriorityReqStore.
Process has to make a prior reservation and pass the associated reservation event as argument in the get and
put requests. ReservablePriorityReqStore maintains separate queues for <code>reserve_put</code> and <code>reserve_get</code> operations
to ensures that only processes with valid reservations can store or retrieve items.</p>
<p>ReservablePriorityReqStore preserves item order by associating an unreserved item in the store with a reservation event
by index when a reserve_get() request is made. As a result, it maintains a list of reserved events to preserve item order.</p>
<p>It also allows users to cancel an already placed reserve_get or reserve_put request even if it is yielded.
It also handles the dissociation of the event and item done at the time of reservation when an already yielded
event is canceled.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reserved_events</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Maintains events corresponding to reserved items to preserve item order by index</p>
              </div>
            </li>
            <li>
              <b><code>reserve_put_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_put</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful put reservations</p>
              </div>
            </li>
            <li>
              <b><code>reserve_get_queue</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>Queue for managing reserve_get reservations</p>
              </div>
            </li>
            <li>
              <b><code>reservations_get</code></b>
                  (<code><span title="list">list</span></code>)
              –
              <div class="doc-md-description">
                <p>List of successful get reservations</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <p>Initializes a reservable store with priority-based reservations.</p>
<p>Args:</p>
<div class="codehilite"><pre><span></span><code>capacity (int, optional): The maximum number of items the store can hold.
                          Defaults to infinity.
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;FIFO&#39;</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a reservable store with priority-based reservations.</span>

<span class="sd">    Args:</span>

<span class="sd">        capacity (int, optional): The maximum number of items the store can hold.</span>
<span class="sd">                                  Defaults to infinity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>  <span class="c1"># Speed of the conveyor belt (units per time)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful put reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Queue for managing reserve_get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># List of successful get reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span> <span class="o">=</span> <span class="p">[]</span>     <span class="c1"># Maintains events corresponding to reserved items to preserve item order</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">=</span><span class="p">[]</span>  <span class="c1">#Maintains the items ready to be taken out</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserved_items</span>   <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># parallel list of the exact items reserved</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_level_change_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_last_num_items</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_weighted_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_averaged_num_of_items_in_store</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Time-averaged number of items in the store</span>
    <span class="c1"># Process tracking for interrupt functionality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dictionary to track active move_to_ready_items processes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>  <span class="c1"># Event to signal when to resume processes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># to control if the belt is in noaccumulation mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">one_item_inserted</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># to control insertion of only one item in noaccumulation mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ready_item_event</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Retrieve an item from the store after a successful reservation.</p>
<p>This method attempts to retrieve an item associated with a <code>reserve_get</code>
event. If the reservation exists, it triggers <code>_trigger_get</code> to retrieve
the item. If successful, <code>_trigger_reserve_put</code> is called to process any
pending <code>reserve_put</code> requests. If the item retrieval fails, an error
message is raised.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>get_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event associated with the request.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>item</code></b>(                  <code><span title="Object">Object</span></code>
)              –
              <div class="doc-md-description">
                <p>The retrieved item if successful, otherwise raises an error</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_get</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If item returned is None</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">get_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve an item from the store after a successful reservation.</span>

<span class="sd">    This method attempts to retrieve an item associated with a `reserve_get`</span>
<span class="sd">    event. If the reservation exists, it triggers `_trigger_get` to retrieve</span>
<span class="sd">    the item. If successful, `_trigger_reserve_put` is called to process any</span>
<span class="sd">    pending `reserve_put` requests. If the item retrieval fails, an error</span>
<span class="sd">    message is raised.</span>

<span class="sd">    Args:</span>
<span class="sd">        get_event (simpy.Event): The reservation event associated with the request.</span>

<span class="sd">    Returns:</span>
<span class="sd">        item (Object): The retrieved item if successful, otherwise raises an error</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_get</span>
<span class="sd">        RuntimeError: If item returned is None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#if there are reservations, then call _trigger_get</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
      <span class="n">item</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_get</span><span class="p">(</span><span class="n">get_event</span><span class="p">)</span>
    <span class="c1">#else raise an error</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_get is empty&quot;</span><span class="p">)</span>
    <span class="c1">#if an item is returned then call _trigger_reserve_put to process pending requests</span>
    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No item found in the store for </span><span class="si">{</span><span class="n">get_event</span><span class="o">.</span><span class="n">requesting_process</span><span class="si">}</span><span class="s2"> and get request failed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1">#self._update_time_averaged_level()</span>
      <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.handle_new_item_during_interruption" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_new_item_during_interruption</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.handle_new_item_during_interruption" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Handle new items arriving during selective interruption.</p>
<p>For new items, the delay before interruption is: capacity - num_items</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>item</code></b>
              –
              <div class="doc-md-description">
                <p>The new item being added</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">handle_new_item_during_interruption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle new items arriving during selective interruption.</span>

<span class="sd">    For new items, the delay before interruption is: capacity - num_items</span>

<span class="sd">    Args:</span>
<span class="sd">        item: The new item being added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span><span class="p">:</span>
        <span class="n">num_items</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span>
        <span class="n">delay_before_interrupt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">-</span> <span class="n">num_items</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">item_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">delay_before_interrupt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> New item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> will be interrupted after </span><span class="si">{</span><span class="n">delay_before_interrupt</span><span class="si">}</span><span class="s2"> time units&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_delayed_interrupt</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="n">delay_before_interrupt</span><span class="p">,</span> <span class="s2">&quot;New item during interruption&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> New item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> interrupted immediately&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt_specific_item</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="s2">&quot;New item during interruption&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.interrupt_all_move_processes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interrupt_all_move_processes</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;External interrupt&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.interrupt_all_move_processes" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Interrupt all active move_to_ready_items processes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reason</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;External interrupt&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Reason for the interrupt</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">interrupt_all_move_processes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;External interrupt&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interrupt all active move_to_ready_items processes.</span>

<span class="sd">    Args:</span>
<span class="sd">        reason (str): Reason for the interrupt</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> BufferStore interrupting </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span><span class="p">)</span><span class="si">}</span><span class="s2"> move processes - </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">item_id</span><span class="p">,</span> <span class="n">process_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">process_info</span><span class="p">[</span><span class="s1">&#39;process&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">process</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">process</span><span class="o">.</span><span class="n">processed</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">process</span><span class="o">.</span><span class="n">interrupt</span><span class="p">(</span><span class="n">reason</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Interrupted move process for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="c1"># Process might already be finished</span>
                <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.move_to_ready_items" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_to_ready_items</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.move_to_ready_items" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Move items from the store to the ready_items list after a put operation.
This method is called as a process to ensure that items are moved asynchronously.
Handles interrupts when state changes to stalled and resumes when state changes back.
Movement is split into two phases:
1. First phase: item[0].length/self.speed time (time for item to fully enter belt)
2. Second phase: remaining time (time for item to reach exit)</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_to_ready_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Move items from the store to the ready_items list after a put operation.</span>
<span class="sd">    This method is called as a process to ensure that items are moved asynchronously.</span>
<span class="sd">    Handles interrupts when state changes to stalled and resumes when state changes back.</span>
<span class="sd">    Movement is split into two phases:</span>
<span class="sd">    1. First phase: item[0].length/self.speed time (time for item to fully enter belt)</span>
<span class="sd">    2. Second phase: remaining time (time for item to reach exit)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">item_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="n">event</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="c1">#self.delay=self.delay</span>
    <span class="c1">#print(f&quot;created Added event suceeded{self.delay}&quot;)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">)</span><span class="c1"># after putting an item, an event is created and will be triggered ater delay amount of time to allow waiting get calls to succeed in a stalled belt</span>
    <span class="c1">#event.callbacks.append(self._trigger_put)# this may not be needed</span>

    <span class="c1">#print(f&quot;{self.env.now}Added event suceed        ed&quot;)</span>

    <span class="c1"># Calculate the two phases of movement</span>
    <span class="n">phase1_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span>  <span class="c1"># Time for item to fully enter belt</span>
    <span class="n">phase2_time</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">phase1_time</span>        <span class="c1"># Remaining time to reach exit</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Move items to the ready_items list</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> beltstore received an item </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> . Item started moving in belt&quot;</span><span class="p">)</span>

            <span class="c1"># Phase 1: Item entering the belt (length/speed time)</span>
            <span class="n">remaining_phase1_time</span> <span class="o">=</span> <span class="n">phase1_time</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> starting Phase 1 (entering belt): </span><span class="si">{</span><span class="n">phase1_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time&quot;</span><span class="p">)</span>

            <span class="k">while</span> <span class="n">remaining_phase1_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">remaining_phase1_time</span><span class="p">)</span>
                    <span class="c1"># If we reach here, phase 1 completed without interruption</span>
                    <span class="n">event</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>
                    <span class="n">remaining_phase1_time</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Interrupt</span> <span class="k">as</span> <span class="n">interrupt</span><span class="p">:</span>
                    <span class="c1"># Calculate how much time has passed</span>
                    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">start_time</span>
                    <span class="n">remaining_phase1_time</span> <span class="o">-=</span> <span class="n">elapsed_time</span>

                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Move process Phase 1 for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> interrupted: </span><span class="si">{</span><span class="n">interrupt</span><span class="o">.</span><span class="n">cause</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Remaining Phase 1 time for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">remaining_phase1_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># Wait for resume signal</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> waiting for resume signal (Phase 1)...&quot;</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> resuming Phase 1 movement with </span><span class="si">{</span><span class="n">remaining_phase1_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time remaining&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> completed Phase 1 (fully entered belt)&quot;</span><span class="p">)</span>

            <span class="c1"># Phase 2: Item moving through the belt to exit</span>
            <span class="n">remaining_phase2_time</span> <span class="o">=</span> <span class="n">phase2_time</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> starting Phase 2 (moving to exit): </span><span class="si">{</span><span class="n">phase2_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time&quot;</span><span class="p">)</span>

            <span class="k">while</span> <span class="n">remaining_phase2_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">remaining_phase2_time</span><span class="p">)</span>
                    <span class="c1"># If we reach here, phase 2 completed without interruption</span>
                    <span class="n">remaining_phase2_time</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">break</span>
                <span class="k">except</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Interrupt</span> <span class="k">as</span> <span class="n">interrupt</span><span class="p">:</span>
                    <span class="c1"># Calculate how much time has passed</span>
                    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span> <span class="o">-</span> <span class="n">start_time</span>
                    <span class="n">remaining_phase2_time</span> <span class="o">-=</span> <span class="n">elapsed_time</span>

                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Move process Phase 2 for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> interrupted: </span><span class="si">{</span><span class="n">interrupt</span><span class="o">.</span><span class="n">cause</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Remaining Phase 2 time for item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">remaining_phase2_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># Wait for resume signal</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> waiting for resume signal (Phase 2)...&quot;</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> resuming Phase 2 movement with </span><span class="si">{</span><span class="n">remaining_phase2_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> time remaining&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2"> completed Phase 2 (reached exit)&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> bufferstore finished moving item </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> going to ready_items&quot;</span><span class="p">)</span>

            <span class="n">item_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">item_to_put</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">item_index</span><span class="p">)</span>  <span class="c1"># Remove the item</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item_to_put</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ready_item_event</span><span class="o">.</span><span class="n">triggered</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ready_item_event</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>  <span class="c1"># Notify that a new item is ready</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> bufferstore finished moving item </span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> moved to ready_items&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Total number of items in the store exceeds capacity. Cannot move item to ready_items.&quot;</span><span class="p">)</span>




    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Clean up the process tracking when done</span>
        <span class="k">if</span> <span class="n">item_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_move_processes</span><span class="p">[</span><span class="n">item_id</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Removed tracking for completed move process of item </span><span class="si">{</span><span class="n">item_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform a <code>put</code> operation on the store and trigger any pending <code>reserve_get</code> requests.</p>
<p>Ensures that only processes with a valid reservation can put items into the store.
If the put operation succeeds, it triggers <code>_trigger_reserve_get</code> to process pending get requests.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The event corresponding to the reservation.</p>
              </div>
            </li>
            <li>
              <b><code>item</code></b>
                  (<code><span title="object">object</span></code>)
              –
              <div class="doc-md-description">
                <p>The item to be added to the store.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the put operation succeeded, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If no reservations are available in the reservations_put</p>
              </div>
            </li>
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If proceed is False after put operation</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a `put` operation on the store and trigger any pending `reserve_get` requests.</span>

<span class="sd">    Ensures that only processes with a valid reservation can put items into the store.</span>
<span class="sd">    If the put operation succeeds, it triggers `_trigger_reserve_get` to process pending get requests.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event (simpy.Event): The event corresponding to the reservation.</span>
<span class="sd">        item (object): The item to be added to the store.</span>

<span class="sd">    Returns:</span>
<span class="sd">        proceed (bool): True if the put operation succeeded, False otherwise.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If no reservations are available in the reservations_put</span>
<span class="sd">        RuntimeError: If proceed is False after put operation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
      <span class="n">proceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_put</span><span class="p">(</span><span class="n">put_event</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching reservation found for process: reservations_put is empty&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">proceed</span><span class="p">:</span>
      <span class="c1">#print(f&quot;{self.env.now} proceed&quot;)</span>
      <span class="c1">#self._trigger_get(None)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>



    <span class="k">if</span> <span class="ow">not</span> <span class="n">proceed</span><span class="p">:</span>

      <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching put_event found in the reservations and put failed for</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1">#self._update_time_averaged_level()</span>
      <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.reserve_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.reserve_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to retrieve an item from the store.</p>
<p>This method generates a SimPy event representing a request to reserve an item
for retrieval (<code>get</code>). The event is assigned attributes such as priority,
the resource it belongs to, and the process making the request.</p>
<p>The event is then added to <code>reserve_get_queue</code>, which is maintained in
priority order, and <code>_trigger_reserve_get()</code> is called to process pending
reservations if items are available.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>priority</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The priority level of the reservation request.
                      Lower values indicate higher priority. Defaults to 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when an item becomes available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to retrieve an item from the store.</span>

<span class="sd">    This method generates a SimPy event representing a request to reserve an item</span>
<span class="sd">    for retrieval (`get`). The event is assigned attributes such as priority,</span>
<span class="sd">    the resource it belongs to, and the process making the request.</span>

<span class="sd">    The event is then added to `reserve_get_queue`, which is maintained in</span>
<span class="sd">    priority order, and `_trigger_reserve_get()` is called to process pending</span>
<span class="sd">    reservations if items are available.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (int, optional): The priority level of the reservation request.</span>
<span class="sd">                                  Lower values indicate higher priority. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">       event (simpy.Event): A reservation event that will succeed when an item becomes available.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#adding attributes to the newly created event for reserve_get</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span><span class="o">=</span><span class="bp">self</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Associate event with the current process</span>

    <span class="c1">#event.priority_to_get = (priority, self._env.now)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">priority_to_get</span> <span class="o">=</span> <span class="n">priority</span>

    <span class="c1">#sorting the list based on priority after appending the new event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">priority_to_get</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_get</code> request.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_event_to_cancel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_get` request.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Case 1: still waiting</span>
    <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserve_get_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Case 2: already yielded reservation</span>
    <span class="k">if</span> <span class="n">get_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">:</span>
        <span class="c1"># 1) Remove from active reservations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reservations_get</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

        <span class="c1"># 2) Find its index in the parallel lists</span>
        <span class="n">ev_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_event_to_cancel</span><span class="p">)</span>

        <span class="c1"># 3) Pop out the exact item reference</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ev_idx</span><span class="p">)</span>
        <span class="c1"># 4) Drop the event token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ev_idx</span><span class="p">)</span>

        <span class="c1"># 5) Remove it from ready_items wherever it currently is</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item </span><span class="si">{</span><span class="n">item</span><span class="si">!r}</span><span class="s2"> not found in ready_items during cancel.&quot;</span><span class="p">)</span>

        <span class="c1"># 6) Compute new insertion index</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;FIFO&quot;</span><span class="p">:</span>
            <span class="c1"># one slot before the remaining reserved block</span>
            <span class="n">insert_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reserved_events</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># LIFO</span>
            <span class="c1"># top of stack</span>
            <span class="n">insert_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span>

        <span class="c1"># 7) Re‑insert it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ready_items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_idx</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

        <span class="c1"># 8) Trigger any other pending reservations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_get</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># No such reservation</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
        <span class="s2">&quot;No matching event in reserve_get_queue or reservations_get&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.reserve_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.reserve_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Create a reservation request to put an item into the store.</p>
<p>This function generates a SimPy event representing a reservation request. The event is
assigned attributes such as priority, resource name, and the process making the request.
The event is then added to <code>reserve_put_queue</code>, which is maintained in priority order.</p>
<p>After adding the event to the queue, <code>_trigger_reserve_put</code> is called to process
any pending reservations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>priority</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The priority level of the reservation request.
                      Lower values indicate higher priority. Defaults to 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>event</code></b>(                  <code><span title="simpy.Event">Event</span></code>
)              –
              <div class="doc-md-description">
                <p>A reservation event that will succeed when space is available.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a reservation request to put an item into the store.</span>

<span class="sd">    This function generates a SimPy event representing a reservation request. The event is</span>
<span class="sd">    assigned attributes such as priority, resource name, and the process making the request.</span>
<span class="sd">    The event is then added to `reserve_put_queue`, which is maintained in priority order.</span>

<span class="sd">    After adding the event to the queue, `_trigger_reserve_put` is called to process</span>
<span class="sd">    any pending reservations.</span>

<span class="sd">    Args:</span>
<span class="sd">        priority (int, optional): The priority level of the reservation request.</span>
<span class="sd">                                  Lower values indicate higher priority. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        event (simpy.Event): A reservation event that will succeed when space is available.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">event</span><span class="o">.</span><span class="n">resourcename</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># Store reference</span>
    <span class="n">event</span><span class="o">.</span><span class="n">requesting_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">active_process</span>  <span class="c1"># Process making the reservation</span>
    <span class="n">event</span><span class="o">.</span><span class="n">priority_to_put</span> <span class="o">=</span> <span class="n">priority</span>  <span class="c1"># Priority for sorting reservations</span>

    <span class="c1"># Add the event to the reservation queue and sort by priority</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">priority_to_put</span><span class="p">)</span>

    <span class="c1"># Attempt to process reservations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">event</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a previously made <code>reserve_put</code> request.</p>
<p>This method allows a process to cancel its reservation for putting an item
into the store. If the reservation exists in the <code>reserve_put_queue</code>, it is
removed before triggering <code>_trigger_reserve_put</code> to process any pending reservations.
If the reservation is already in <code>reservations_put</code>, it is also removed and
<code>_trigger_reserve_put</code> is triggered.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>put_event_to_cancel</code></b>
                  (<code><span title="simpy.Event">Event</span></code>)
              –
              <div class="doc-md-description">
                <p>The reservation event that needs to be canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>proceed</code></b>(                  <code><span title="bool">bool</span></code>
)              –
              <div class="doc-md-description">
                <p>True if the reservation was successfully canceled.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="RuntimeError">RuntimeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the specified event does not exist in <code>reserve_put_queue</code>
          or <code>reservations_put</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">put_event_to_cancel</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a previously made `reserve_put` request.</span>

<span class="sd">    This method allows a process to cancel its reservation for putting an item</span>
<span class="sd">    into the store. If the reservation exists in the `reserve_put_queue`, it is</span>
<span class="sd">    removed before triggering `_trigger_reserve_put` to process any pending reservations.</span>
<span class="sd">    If the reservation is already in `reservations_put`, it is also removed and</span>
<span class="sd">    `_trigger_reserve_put` is triggered.</span>

<span class="sd">    Args:</span>
<span class="sd">        put_event_to_cancel (simpy.Event): The reservation event that needs to be canceled.</span>

<span class="sd">    Returns:</span>
<span class="sd">       proceed (bool): True if the reservation was successfully canceled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the specified event does not exist in `reserve_put_queue`</span>
<span class="sd">                      or `reservations_put`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

  <span class="c1">#checking and removing the event if it is not yielded and is present in the reserve_put_queue</span>
  <span class="n">proceed</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="k">if</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reserve_put_queue</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#checking and removing the event if it is already yielded and is present in the reservations_put</span>
  <span class="k">elif</span> <span class="n">put_event_to_cancel</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reservations_put</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">put_event_to_cancel</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_trigger_reserve_put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span><span class="c1">#if t is removed, then a waiting event can be succeeded, if any</span>
    <span class="n">proceed</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching event in reserve_put_queue or reservations_put for this process&quot;</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">proceed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.resume_all_move_processes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resume_all_move_processes</span><span class="p">()</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.resume_all_move_processes" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Resume all interrupted move_to_ready_items processes.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resume_all_move_processes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resume all interrupted move_to_ready_items processes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> BufferStore resuming move processes&quot;</span><span class="p">)</span>

    <span class="c1"># Create a new resume event and trigger it</span>
    <span class="n">old_resume_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resume_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">old_resume_event</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.base.slotted_belt_store.BeltStore.selective_interrupt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">selective_interrupt</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;Selective interrupt&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.base.slotted_belt_store.BeltStore.selective_interrupt" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Perform selective interruption based on belt occupancy patterns and mode.</p>
<p>When noaccumulation_mode_on=True (STALLED_NONACCUMULATING_STATE):
- Interrupt all items immediately</p>
<p>When noaccumulation_mode_on=False (STALLED_ACCUMULATING_STATE):
- Use pattern-based interruption with delays based on item positions</p>
<p>Pattern-based rules for accumulating mode:
- For patterns like '_<strong><em>*', interrupt all items.
- For patterns like '_</em>_<em>_', interrupt item in second last position after 1 delay,
  and second item after 2 delays.
- For patterns like '</em>___*', interrupt first item and second item after 3 delays.
- For patterns like '</strong>__*', interrupt first item, second after 2 delays,
  and third after 2 delays.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>reason</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;Selective interrupt&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Reason for the interrupt</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/base/slotted_belt_store.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">selective_interrupt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Selective interrupt&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform selective interruption based on belt occupancy patterns and mode.</span>

<span class="sd">    When noaccumulation_mode_on=True (STALLED_NONACCUMULATING_STATE):</span>
<span class="sd">    - Interrupt all items immediately</span>

<span class="sd">    When noaccumulation_mode_on=False (STALLED_ACCUMULATING_STATE):</span>
<span class="sd">    - Use pattern-based interruption with delays based on item positions</span>

<span class="sd">    Pattern-based rules for accumulating mode:</span>
<span class="sd">    - For patterns like &#39;_****&#39;, interrupt all items.</span>
<span class="sd">    - For patterns like &#39;_*_*_&#39;, interrupt item in second last position after 1 delay,</span>
<span class="sd">      and second item after 2 delays.</span>
<span class="sd">    - For patterns like &#39;*___*&#39;, interrupt first item and second item after 3 delays.</span>
<span class="sd">    - For patterns like &#39;**__*&#39;, interrupt first item, second after 2 delays,</span>
<span class="sd">      and third after 2 delays.</span>

<span class="sd">    Args:</span>
<span class="sd">        reason (str): Reason for the interrupt</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> No items on belt to interrupt&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># If noaccumulation_mode_on is True (STALLED_NONACCUMULATING_STATE), interrupt all items immediately</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> No accumulation mode: interrupting all items immediately&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">):</span>
            <span class="n">item_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_interrupt_specific_item</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2"> - immediate (no accumulation)&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># For accumulating mode (STALLED_ACCUMULATING_STATE), use pattern-based interruption</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Accumulating mode: using pattern-based interruption&quot;</span><span class="p">)</span>

    <span class="c1"># Get current belt pattern</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_belt_pattern</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Current belt pattern: </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Analyze pattern and determine interruption strategy</span>
    <span class="n">interruption_plan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_pattern_for_interruption</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">interruption_plan</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> No interruption needed for current pattern&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Executing selective interruption plan: </span><span class="si">{</span><span class="n">interruption_plan</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Execute the interruption plan</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_execute_interruption_plan</span><span class="p">(</span><span class="n">interruption_plan</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="factorysimpy.constructs" class="doc doc-heading">
            <code>constructs</code>


<a href="#factorysimpy.constructs" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h4 id="factorysimpy.constructs.chain" class="doc doc-heading">
            <code>chain</code>


<a href="#factorysimpy.constructs.chain" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="factorysimpy.constructs.chain.connect_nodes_with_buffers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect_nodes_with_buffers</span><span class="p">(</span><span class="n">machines</span><span class="p">,</span> <span class="n">buffers</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">sink</span><span class="p">)</span></code>

<a href="#factorysimpy.constructs.chain.connect_nodes_with_buffers" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Connects source, machines, buffers, and optionally a sink in the following order:
src -&gt; buffer1 -&gt; machine1 -&gt; buffer2 -&gt; machine2 -&gt; ... -&gt; bufferN -&gt; sink</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>src</code></b>
              –
              <div class="doc-md-description">
                <p>Source node</p>
              </div>
            </li>
            <li>
              <b><code>machines</code></b>
              –
              <div class="doc-md-description">
                <p>List of machine nodes</p>
              </div>
            </li>
            <li>
              <b><code>buffers</code></b>
              –
              <div class="doc-md-description">
                <p>List of buffer edges (should be len(machines) - 1) inlcuding source and sink</p>
              </div>
            </li>
            <li>
              <b><code>sink</code></b>
              –
              <div class="doc-md-description">
                <p>Optional sink node</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>List of all nodes and buffers in connection order</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/constructs/chain.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_nodes_with_buffers</span><span class="p">(</span><span class="n">machines</span><span class="p">,</span> <span class="n">buffers</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">sink</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Connects source, machines, buffers, and optionally a sink in the following order:</span>
<span class="sd">    src -&gt; buffer1 -&gt; machine1 -&gt; buffer2 -&gt; machine2 -&gt; ... -&gt; bufferN -&gt; sink</span>

<span class="sd">    Args:</span>
<span class="sd">        src: Source node</span>
<span class="sd">        machines: List of machine nodes</span>
<span class="sd">        buffers: List of buffer edges (should be len(machines) - 1) inlcuding source and sink</span>
<span class="sd">        sink: Optional sink node</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of all nodes and buffers in connection order</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffers</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">machines</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Number of buffers must be one more than number of machines&quot;</span>


    <span class="c1"># Connect intermediate machines and buffers</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">machines</span><span class="p">)):</span>
        <span class="n">buffers</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">machines</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">machines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>




    <span class="c1"># Return all nodes and buffers for reference</span>

    <span class="k">return</span> <span class="n">machines</span><span class="p">,</span> <span class="n">buffers</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.constructs.mesh" class="doc doc-heading">
            <code>mesh</code>


<a href="#factorysimpy.constructs.mesh" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="factorysimpy.constructs.mesh.connect_mesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect_mesh</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">node_cls</span><span class="p">,</span> <span class="n">edge_cls</span><span class="p">,</span> <span class="n">node_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edge_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_kwargs_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edge_kwargs_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">edge_prefix</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">source_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sink_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sink_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#factorysimpy.constructs.mesh.connect_mesh" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Builds a mesh/grid of nodes connected with buffers.
Each node is connected to its right and down neighbor.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>mesh_nodes</code></b>              –
              <div class="doc-md-description">
                <p>2D list of nodes (rows x cols)</p>
              </div>
            </li>
            <li>
<b><code>edge_dict</code></b>              –
              <div class="doc-md-description">
                <p>dict of buffers by (from_node.id, to_node.id)</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/constructs/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_mesh</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">node_cls</span><span class="p">,</span> <span class="n">edge_cls</span><span class="p">,</span>
                                  <span class="n">node_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edge_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">node_kwargs_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edge_kwargs_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">edge_prefix</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>
                                  <span class="n">source_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sink_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">source_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sink_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a mesh/grid of nodes connected with buffers.</span>
<span class="sd">    Each node is connected to its right and down neighbor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mesh_nodes: 2D list of nodes (rows x cols)</span>
<span class="sd">        edge_dict: dict of buffers by (from_node.id, to_node.id)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node_kwargs</span> <span class="o">=</span> <span class="n">node_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">edge_kwargs</span> <span class="o">=</span> <span class="n">edge_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>

    <span class="n">mesh_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">edge_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_kwargs</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grid</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">r</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">grid</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">default</span>

    <span class="c1"># Create nodes (machines)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="n">get_kwargs</span><span class="p">(</span><span class="n">node_kwargs_grid</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">node_kwargs</span><span class="p">)</span>
            <span class="n">node_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">node_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">node_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">mesh_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="c1"># Helper to create and connect edges</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_edge</span><span class="p">(</span><span class="n">from_node</span><span class="p">,</span> <span class="n">to_node</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">get_kwargs</span><span class="p">(</span><span class="n">edge_kwargs_grid</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">edge_kwargs</span><span class="p">)</span>
        <span class="n">edge_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">edge_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">from_node</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">to_node</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="n">edge_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">edge_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">edge</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">from_node</span><span class="p">,</span> <span class="n">to_node</span><span class="p">)</span>
        <span class="n">edge_dict</span><span class="p">[(</span><span class="n">from_node</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">to_node</span><span class="o">.</span><span class="n">id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">edge</span>

    <span class="c1"># Create buffers (edges) to right and down</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="n">from_node</span> <span class="o">=</span> <span class="n">mesh_nodes</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">cols</span><span class="p">:</span>
                <span class="n">create_edge</span><span class="p">(</span><span class="n">from_node</span><span class="p">,</span> <span class="n">mesh_nodes</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">rows</span><span class="p">:</span>
                <span class="n">create_edge</span><span class="p">(</span><span class="n">from_node</span><span class="p">,</span> <span class="n">mesh_nodes</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">c</span><span class="p">],</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mesh_nodes</span><span class="p">,</span><span class="n">edge_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="factorysimpy.constructs.mesh.connect_mesh_with_source_sink" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect_mesh_with_source_sink</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">node_cls</span><span class="p">,</span> <span class="n">edge_cls</span><span class="p">,</span> <span class="n">node_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edge_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_kwargs_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edge_kwargs_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">edge_prefix</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">source_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sink_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sink_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#factorysimpy.constructs.mesh.connect_mesh_with_source_sink" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Builds a mesh/grid of nodes connected with buffers.
Source sends to first row, Sink collects from last row.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>mesh_nodes</code></b>              –
              <div class="doc-md-description">
                <p>2D list of nodes (rows x cols)</p>
              </div>
            </li>
            <li>
<b><code>edge_dict</code></b>              –
              <div class="doc-md-description">
                <p>dict of buffers by (from_node.id, to_node.id)</p>
              </div>
            </li>
            <li>
              –
              <div class="doc-md-description">
                <p>source, sink: optional</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/constructs/mesh.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect_mesh_with_source_sink</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">node_cls</span><span class="p">,</span> <span class="n">edge_cls</span><span class="p">,</span>
                                  <span class="n">node_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edge_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">node_kwargs_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edge_kwargs_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">edge_prefix</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span>
                                  <span class="n">source_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sink_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">source_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sink_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a mesh/grid of nodes connected with buffers.</span>
<span class="sd">    Source sends to first row, Sink collects from last row.</span>

<span class="sd">    Returns:</span>
<span class="sd">        mesh_nodes: 2D list of nodes (rows x cols)</span>
<span class="sd">        edge_dict: dict of buffers by (from_node.id, to_node.id)</span>
<span class="sd">        source, sink: optional</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node_kwargs</span> <span class="o">=</span> <span class="n">node_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">edge_kwargs</span> <span class="o">=</span> <span class="n">edge_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">source_kwargs</span> <span class="o">=</span> <span class="n">source_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">sink_kwargs</span> <span class="o">=</span> <span class="n">sink_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>

    <span class="n">mesh_nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">edge_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Create nodes (machines)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="n">node_kwargs_grid</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="n">node_kwargs_grid</span> <span class="k">else</span> <span class="n">node_kwargs</span>
            <span class="n">node_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">node_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">node_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">mesh_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="c1"># Create buffers (edges) to right and down</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="n">from_node</span> <span class="o">=</span> <span class="n">mesh_nodes</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>

            <span class="c1"># Connect right</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">cols</span><span class="p">:</span>
                <span class="n">to_node</span> <span class="o">=</span> <span class="n">mesh_nodes</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">edge_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">edge_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">from_node</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">to_node</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">edge_kwargs_grid</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="n">edge_kwargs_grid</span> <span class="k">else</span> <span class="n">edge_kwargs</span>
                <span class="n">edge</span> <span class="o">=</span> <span class="n">edge_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">edge_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">edge</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">from_node</span><span class="p">,</span> <span class="n">to_node</span><span class="p">)</span>
                <span class="n">edge_dict</span><span class="p">[(</span><span class="n">from_node</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">to_node</span><span class="o">.</span><span class="n">id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">edge</span>

            <span class="c1"># Connect down</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">rows</span><span class="p">:</span>
                <span class="n">to_node</span> <span class="o">=</span> <span class="n">mesh_nodes</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
                <span class="n">edge_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">edge_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">from_node</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">to_node</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="n">edge_kwargs_grid</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="k">if</span> <span class="n">edge_kwargs_grid</span> <span class="k">else</span> <span class="n">edge_kwargs</span>
                <span class="n">edge</span> <span class="o">=</span> <span class="n">edge_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">edge_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">edge</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">from_node</span><span class="p">,</span> <span class="n">to_node</span><span class="p">)</span>
                <span class="n">edge_dict</span><span class="p">[(</span><span class="n">from_node</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">to_node</span><span class="o">.</span><span class="n">id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">edge</span>

    <span class="c1"># Optional source</span>
    <span class="n">source</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">source_cls</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">source_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">source_kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="n">to_node</span> <span class="o">=</span> <span class="n">mesh_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
            <span class="n">edge_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">edge_prefix</span><span class="si">}</span><span class="s2">_SRC_</span><span class="si">{</span><span class="n">to_node</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="n">edge_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">edge_id</span><span class="p">,</span> <span class="o">**</span><span class="n">edge_kwargs</span><span class="p">)</span>
            <span class="n">edge</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">to_node</span><span class="p">)</span>
            <span class="n">edge_dict</span><span class="p">[(</span><span class="n">source</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">to_node</span><span class="o">.</span><span class="n">id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">edge</span>

    <span class="c1"># Optional sink</span>
    <span class="n">sink</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">sink_cls</span><span class="p">:</span>
        <span class="n">sink</span> <span class="o">=</span> <span class="n">sink_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;Sink&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">sink_kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="n">from_node</span> <span class="o">=</span> <span class="n">mesh_nodes</span><span class="p">[</span><span class="n">rows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
            <span class="n">edge_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">edge_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">from_node</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">_SINK&quot;</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="n">edge_cls</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">edge_id</span><span class="p">,</span> <span class="o">**</span><span class="n">edge_kwargs</span><span class="p">)</span>
            <span class="n">edge</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">from_node</span><span class="p">,</span> <span class="n">sink</span><span class="p">)</span>
            <span class="n">edge_dict</span><span class="p">[(</span><span class="n">from_node</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">sink</span><span class="o">.</span><span class="n">id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">edge</span>

    <span class="k">return</span> <span class="n">mesh_nodes</span><span class="p">,</span> <span class="n">edge_dict</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">sink</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="factorysimpy.edges" class="doc doc-heading">
            <code>edges</code>


<a href="#factorysimpy.edges" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h4 id="factorysimpy.edges.buffer" class="doc doc-heading">
            <code>buffer</code>


<a href="#factorysimpy.edges.buffer" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.edges.buffer.Buffer" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Buffer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;FIFO&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.buffer.Buffer" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Edge(env, id, capacity) (factorysimpy.edges.edge.Edge)" href="#factorysimpy.edges.edge.Edge">Edge</a></code></p>


        <p>Buffer class representing a FIFO queue.
Inherits from the Edge class. This buffer can have a single input edge and a single output edge.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The current state of the buffer.</p>
              </div>
            </li>
            <li>
              <b><code>capacity</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The capacity of the buffer's internal storage.</p>
              </div>
            </li>
            <li>
              <b><code>mode</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Mode of operation for the buffer, It can be
- "FIFO" (First In First Out) 
- "LIFO" (Last In First Out).</p>
              </div>
            </li>
            <li>
              <b><code>delay</code></b>
                  (<code>(<span title="int">int</span>, <span title="float">float</span>)</code>)
              –
              <div class="doc-md-description">
                <p>Delay after which the item becomes available. It Can be</p>
<ul>
<li>int or float: Used as a constant delay.</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>Behavior:
        The Buffer is a type of edge represents components that holds the items that are waiting to be accepted by the destination node. Items that are added in buffer becomes available
        for use after <code>delay</code> amount of time. It operates in two modes- 
        1. <code>FIFO</code>: It prioritizes items in the order they were added, with the oldest items being available for the destination node first.
        2. <code>LIFO</code>: It prioritizes items in the reverse order of their arrival, items that newly added are available to use by the destination node first
        Incoming edges can use reserve_get and reserve_put calls on the store in the buffer to reserve an item or space and after yielding 
        the requests, an item can be put and obtained by using put and get methods.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="AssertionError">AssertionError</span></code>
              –
              <div class="doc-md-description">
                <p>If the buffer does not have at least one source node or one destination node.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="output-performance-metrics" open>
  <summary>Output performance metrics</summary>
  <p>The key performance metrics of the buffer edge are captured in the <code>stats</code> attribute (dict) during a simulation run. </p>
<div class="codehilite"><pre><span></span><code><span class="n">last_state_change_time</span><span class="w">                      </span><span class="o">:</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">changed</span><span class="o">.</span>
<span class="n">time_averaged_num_of_items_in_buffer</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Time</span><span class="o">-</span><span class="n">averaged</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">buffer</span><span class="o">.</span>
<span class="n">total_time_spent_in_states</span><span class="w">                  </span><span class="o">:</span><span class="w"> </span><span class="n">Dictionary</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">state</span><span class="o">.</span>
</code></pre></div>
</details>







                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/edges/buffer.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span>  <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;FIFO&quot;</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;IDLE_STATE&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span>  <span class="n">capacity</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;time_averaged_num_of_items_in_buffer&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:{</span><span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;RELEASING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;BLOCKED_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
    <span class="p">}</span>



      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;FIFO&quot;</span><span class="p">,</span> <span class="s2">&quot;LIFO&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid mode. Choose either &#39;FIFO&#39; or &#39;LIFO&#39;.&quot;</span><span class="p">)</span>


      <span class="c1"># Initialize the buffer store</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span> <span class="o">=</span> <span class="n">BufferStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">,</span>  <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>






      <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="s1">&#39;__next__&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="n">delay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;delay must be None, int, float, generator, or callable.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.buffer.Buffer.can_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_get</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.buffer.Buffer.can_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the buffer can accept an item.</p>
<h6 id="factorysimpy.edges.buffer.Buffer.can_get--returns">Returns<a class="headerlink" href="#factorysimpy.edges.buffer.Buffer.can_get--returns" title="Permanent link">&para;</a></h6>
<p>bool
    True if the buffer can give an item, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/buffer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the buffer can accept an item.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if the buffer can give an item, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">ready_items</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="c1">#only return items that are older than the delay. Count such items</span>
    <span class="c1">#count = sum(1 for item in self.inbuiltstore.items if item.time_stamp_creation + self.delay &lt;= self.env.now)</span>
    <span class="c1"># count should be greater than the number of reservations that are already there</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.buffer.Buffer.can_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_put</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.buffer.Buffer.can_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the buffer can accept an item.</p>
<h6 id="factorysimpy.edges.buffer.Buffer.can_put--returns">Returns<a class="headerlink" href="#factorysimpy.edges.buffer.Buffer.can_put--returns" title="Permanent link">&para;</a></h6>
<p>bool
    True if the buffer can accept an item, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/buffer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_put</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the buffer can accept an item.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if the buffer can accept an item, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the buffer has space for new items</span>
    <span class="k">if</span>  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span><span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="c1"># return True if the number of items in the buffer is less than the store capacity minus the number of reservations</span>
    <span class="c1"># reservations_put is the number of items that are already reserved to be put in the buffer</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">ready_items</span><span class="p">))</span> <span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.buffer.Buffer.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.buffer.Buffer.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Get an item from the buffer.</p>
<h6 id="factorysimpy.edges.buffer.Buffer.get--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.buffer.Buffer.get--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for getting an item.</p>
<h6 id="factorysimpy.edges.buffer.Buffer.get--returns">Returns<a class="headerlink" href="#factorysimpy.edges.buffer.Buffer.get--returns" title="Permanent link">&para;</a></h6>
<p>item : object
    The item retrieved from the buffer.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/buffer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get an item from the buffer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for getting an item.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    item : object</span>
<span class="sd">        The item retrieved from the buffer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_stats_collector</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.buffer.Buffer.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.buffer.Buffer.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a reserved get event.</p>
<h6 id="factorysimpy.edges.buffer.Buffer.reserve_get_cancel--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.buffer.Buffer.reserve_get_cancel--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for getting an item.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/buffer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a reserved get event.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for getting an item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.buffer.Buffer.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.buffer.Buffer.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a reserved put event.</p>
<h6 id="factorysimpy.edges.buffer.Buffer.reserve_put_cancel--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.buffer.Buffer.reserve_put_cancel--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for putting an item.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/buffer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a reserved put event.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for putting an item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.edges.continuous_conveyor" class="doc doc-heading">
            <code>continuous_conveyor</code>


<a href="#factorysimpy.edges.continuous_conveyor" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ConveyorBelt</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">conveyor_length</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">item_length</span><span class="p">,</span> <span class="n">accumulating</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Edge(env, id, capacity) (factorysimpy.edges.edge.Edge)" href="#factorysimpy.edges.edge.Edge">Edge</a></code></p>


        <p>A conveyor belt system with optional accumulation.</p>
<p>Attributes:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">capacity</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Maximum</span><span class="w"> </span><span class="nv">capacity</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">belt</span>.
<span class="nv">state</span><span class="w"> </span><span class="ss">(</span><span class="nv">str</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">conveyor</span><span class="w"> </span><span class="nv">belt</span>.
<span class="nv">length</span><span class="w"> </span><span class="ss">(</span><span class="nv">float</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Length</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">item</span>.
<span class="nv">speed</span><span class="w"> </span><span class="ss">(</span><span class="nv">float</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Speed</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">conveyor</span><span class="w"> </span><span class="nv">belt</span>.
<span class="nv">accumulating</span><span class="w"> </span><span class="ss">(</span><span class="nv">bool</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Whether</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">belt</span><span class="w"> </span><span class="nv">supports</span><span class="w"> </span><span class="nv">accumulation</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">yes</span>,<span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">no</span><span class="ss">)</span>.
<span class="nv">belt</span><span class="w"> </span><span class="ss">(</span><span class="nv">BeltStore</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">belt</span><span class="w"> </span><span class="nv">store</span><span class="w"> </span><span class="nv">object</span>.
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">conveyor_length</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span><span class="n">item_length</span><span class="p">,</span><span class="n">accumulating</span><span class="p">):</span>
    <span class="n">capacity</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">conveyor_length</span><span class="p">)</span><span class="o">/</span><span class="n">item_length</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;IDLE_STATE&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="o">=</span> <span class="n">item_length</span> <span class="c1">#length of the item</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conveyor_length</span> <span class="o">=</span> <span class="n">conveyor_length</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">accumulating</span> <span class="o">=</span> <span class="n">accumulating</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="o">=</span><span class="n">speed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conveyor_length</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span><span class="o">*</span><span class="n">capacity</span>
    <span class="c1">#self.delay = (self.length*self.speed)/capacity</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">belt</span> <span class="o">=</span> <span class="n">BeltStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulating</span><span class="p">)</span>



    <span class="c1">#self.time_per_item = self.length/self.speed</span>
    <span class="c1">#self.inp_buf=ReservablePriorityReqStore(env, capacity=1)</span>
    <span class="c1">#self.out_buf=ReservablePriorityReqStore(env, capacity=1)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;time_averaged_num_of_items_in_conveyor&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:{</span><span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;MOVING_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ACCUMULATING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;STALLED_NONACCUMULATING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">item_arrival_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="c1"># self.item_get_event=self.env.event()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_events_available</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">put_events_available</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span><span class="o">=</span><span class="kc">False</span>


    <span class="c1"># self.get_request_queue = []</span>
    <span class="c1"># self.put_request_queue = []</span>
    <span class="c1"># self.active_events = []</span>
    <span class="c1"># self.get_dict = {}</span>
    <span class="c1"># self.put_dict = {}</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behaviour</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.can_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_get</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.can_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if an item can be retrieved from the belt.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if an item can be retrieved from the belt.&quot;&quot;&quot;</span>
    <span class="c1">#first_item_to_go_out = self.items[0] if self.items else None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_buf</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.can_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_put</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.can_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if an item can be added to the belt.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_put</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if an item can be added to the belt.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_buf</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Get an item from the belt.</p>
<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.get--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.get--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for getting an item.</p>
<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.get--returns">Returns<a class="headerlink" href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.get--returns" title="Permanent link">&para;</a></h6>
<p>Item
    The item retrieved from the belt.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get an item from the belt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for getting an item.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Item</span>
<span class="sd">        The item retrieved from the belt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="si">}</span><span class="s2">:get: getting item from belt&quot;</span><span class="p">)</span>
    <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="n">item</span><span class="o">.</span><span class="n">conveyor_exit_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_conveyor_stats_collector</span><span class="p">()</span>
    <span class="n">event</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_events_available</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> time in conveyor </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">conveyor_entry_time</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">conveyor_exit_time</span><span class="si">}</span><span class="s2"> - time spend in conveyor </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">conveyor_exit_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">item</span><span class="o">.</span><span class="n">conveyor_entry_time</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">item</span><span class="o">.</span><span class="n">conveyor_exit_time</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">item</span><span class="o">.</span><span class="n">conveyor_entry_time</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.is_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_empty</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.is_empty" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the belt is completely empty.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Check if the belt is completely empty.&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="p">(</span>
      <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>  <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.is_full" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_full</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.is_full" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the belt is full.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_full</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;Check if the belt is full.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">capacity</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.is_stalled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_stalled</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.is_stalled" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the belt is stalled due to time constraints.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_stalled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;Check if the belt is stalled due to time constraints.&quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">ready_items</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Put an item into the belt.</p>
<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.put--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.put--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for putting an item.
item : Item
    The item to be put on the belt.</p>
<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.put--returns">Returns<a class="headerlink" href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.put--returns" title="Permanent link">&para;</a></h6>
<p>simpy.Event
    An event that will be triggered when the item is successfully put on the belt.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Put an item into the belt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for putting an item.</span>
<span class="sd">    item : Item</span>
<span class="sd">        The item to be put on the belt.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    simpy.Event</span>
<span class="sd">        An event that will be triggered when the item is successfully put on the belt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#delay=self.get_delay(self.delay)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Conveyor:put: putting item </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span>
    <span class="n">item</span><span class="o">.</span><span class="n">conveyor_entry_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="n">item_to_put</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="si">}</span><span class="s2">:put: putting item </span><span class="si">{</span><span class="n">item_to_put</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> on belt with delay </span><span class="si">{</span><span class="n">item_to_put</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">return_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">item_to_put</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_conveyor_stats_collector</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">==</span><span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_arrival_event</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="si">}</span><span class="s2">:put: item arrival event succeeded&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">event</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">put_events_available</span><span class="o">.</span><span class="n">succeed</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulating</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="si">}</span><span class="s2">: attempting to put an item while non accumulating mode on and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="si">}</span><span class="s2">:put: item arrival event else succeeded&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">==</span><span class="s2">&quot;STALLED_ACCUMULATING_STATE&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulating</span><span class="o">==</span><span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">==</span><span class="s2">&quot;STALLED_NONACCUMULATING_STATE&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulating</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="si">}</span><span class="s2">:put: handling new item during interruption </span><span class="si">{</span><span class="n">item_to_put</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> on belt&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">handle_new_item_during_interruption</span><span class="p">(</span><span class="n">item_to_put</span><span class="p">)</span>




    <span class="k">return</span> <span class="n">return_val</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.continuous_conveyor.ConveyorBelt.set_conveyor_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_conveyor_state</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.continuous_conveyor.ConveyorBelt.set_conveyor_state" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Set the conveyor state and manage belt store interrupts/resumes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>new_state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The new conveyor state</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/continuous_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_conveyor_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_state</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the conveyor state and manage belt store interrupts/resumes.</span>

<span class="sd">    Args:</span>
<span class="sd">        new_state (str): The new conveyor state</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">old_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> state changed from </span><span class="si">{</span><span class="n">old_state</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Control belt store based on conveyor state changes</span>
    <span class="k">if</span> <span class="n">old_state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MOVING_STATE&quot;</span><span class="p">,</span> <span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">new_state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;STALLED_ACCUMULATING_STATE&quot;</span><span class="p">,</span> <span class="s2">&quot;STALLED_NONACCUMULATING_STATE&quot;</span><span class="p">]:</span>
        <span class="c1"># When conveyor becomes stalled (either accumulating or non-accumulating), apply selective interruption</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulating</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">selective_interrupt</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conveyor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> selective interruption - </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">old_state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;STALLED_ACCUMULATING_STATE&quot;</span><span class="p">,</span> <span class="s2">&quot;STALLED_NONACCUMULATING_STATE&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">new_state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MOVING_STATE&quot;</span><span class="p">,</span> <span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">]:</span>
        <span class="c1"># When conveyor resumes to moving or becomes idle, resume all belt store processes</span>
        <span class="c1">#self.belt.interrupt_and_resume_all_delayed_interrupt_processes()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulating</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">resume_all_move_processes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">interrupt_and_resume_all_delayed_interrupt_processes</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;state changes from&quot;</span><span class="p">,</span><span class="n">old_state</span><span class="p">,</span><span class="s2">&quot;to&quot;</span><span class="p">,</span>  <span class="n">new_state</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.edges.edge" class="doc doc-heading">
            <code>edge</code>


<a href="#factorysimpy.edges.edge" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.edges.edge.Edge" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Edge</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.edge.Edge" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">


        <p>Edge represents the passive components. It used to connect two nodes and helps to move items between them.
It is the base class used to model buffers, conveyors, fleets, etc in manufacturing system.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>id</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>unique identifier for the edge</p>
              </div>
            </li>
            <li>
              <b><code>src_node</code></b>
                  (<code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code>)
              –
              <div class="doc-md-description">
                <p>reference to the source node connected to this edge.</p>
              </div>
            </li>
            <li>
              <b><code>dest_node</code></b>
                  (<code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code>)
              –
              <div class="doc-md-description">
                <p>reference to the destination node connected to this edge.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="TypeError">TypeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the type of <code>env</code> or <code>id</code> is incorrect.</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If the <code>delay</code> parameter is not a valid type (int, float, generator, or callable).</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If the edge is already connected to a source or destination node and reconnect is False.</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If the source or destination nodes are not valid Node instances.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/edges/edge.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">src_node</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dest_node</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>

     <span class="c1"># Type checks</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;env must be a simpy.Environment instance&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;id must be a string&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;capacity must be a positive integer&quot;</span><span class="p">)</span>

    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">src_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Edge &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; must have a source node.&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Edge &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; must have a destination node.&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Edge id cannot be None.&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Edge capacity cannot be None.&quot;</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.edge.Edge.connect" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">reconnect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.edge.Edge.connect" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Connects this edge to a source node and a destination node.</p>
<p>This method checks that both <code>src</code> and <code>dest</code> are valid Node objects and that the edge is not already connected,
unless <code>reconnect</code> is set to True. It also registers this edge in the <code>out_edges</code> of the source node and the
<code>in_edges</code> of the destination node.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>src</code></b>
                  (<code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code>)
              –
              <div class="doc-md-description">
                <p>The source node to connect.</p>
              </div>
            </li>
            <li>
              <b><code>dest</code></b>
                  (<code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code>)
              –
              <div class="doc-md-description">
                <p>The destination node to connect.</p>
              </div>
            </li>
            <li>
              <b><code>reconnect</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>If True, allows reconnection even if the edge is already connected. Defaults to False.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If the edge is already connected and <code>reconnect</code> is False.</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If <code>src</code> or <code>dest</code> is not a valid Node instance.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/edge.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">dest</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">reconnect</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Connects this edge to a source node and a destination node.</span>

<span class="sd">    This method checks that both `src` and `dest` are valid Node objects and that the edge is not already connected,</span>
<span class="sd">    unless `reconnect` is set to True. It also registers this edge in the `out_edges` of the source node and the</span>
<span class="sd">    `in_edges` of the destination node.</span>

<span class="sd">    Args:</span>
<span class="sd">        src (Node): The source node to connect.</span>
<span class="sd">        dest (Node): The destination node to connect.</span>
<span class="sd">        reconnect (bool, optional): If True, allows reconnection even if the edge is already connected. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the edge is already connected and `reconnect` is False.</span>
<span class="sd">        ValueError: If `src` or `dest` is not a valid Node instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">reconnect</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">src_node</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest_node</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; is already connected source or destination node.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source &#39;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s2">&#39; is not a valid Node.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Destination &#39;</span><span class="si">{</span><span class="n">dest</span><span class="si">}</span><span class="s2">&#39; is not a valid Node.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">src_node</span> <span class="o">=</span> <span class="n">src</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dest_node</span> <span class="o">=</span> <span class="n">dest</span>

    <span class="c1"># Register edge to nodes</span>
    <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">out_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">out_edges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">out_edges</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">out_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dest</span><span class="o">.</span><span class="n">in_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dest</span><span class="o">.</span><span class="n">in_edges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dest</span><span class="o">.</span><span class="n">in_edges</span><span class="p">:</span>
        <span class="n">dest</span><span class="o">.</span><span class="n">in_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Connected edge &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; from &#39;</span><span class="si">{</span><span class="n">src</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; to &#39;</span><span class="si">{</span><span class="n">dest</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39;  &quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.edge.Edge.get_delay" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_delay</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.edge.Edge.get_delay" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Returns value based on the type of parameter <code>delay</code> provided.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>delay</code></b>
                  (<code>int, float, generator, or callable</code>)
              –
              <div class="doc-md-description">
                <p>The delay time, which can be:</p>
<ul>
<li>int or float: Used as a constant delay.</li>
<li>generator: A generator instance yielding delay values.</li>
<li>callable: A function that returns a delay values.</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>Returns a constant delay if <code>delay</code> is an int or float, a value yielded  if <code>delay</code> is a generator, or the value returned from a Callable function if <code>delay</code> is callable.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/edge.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_delay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">delay</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns value based on the type of parameter `delay` provided.</span>

<span class="sd">    Args:</span>
<span class="sd">         delay (int, float, generator, or callable): The delay time, which can be:</span>

<span class="sd">            - int or float: Used as a constant delay.</span>
<span class="sd">            - generator: A generator instance yielding delay values.</span>
<span class="sd">            - callable: A function that returns a delay values.</span>

<span class="sd">    Returns:</span>
<span class="sd">           Returns a constant delay if `delay` is an int or float, a value yielded  if `delay` is a generator, or the value returned from a Callable function if `delay` is callable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="s1">&#39;__next__&#39;</span><span class="p">):</span>
        <span class="c1"># Generator instance</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">delay</span><span class="p">):</span>
        <span class="c1"># Function</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">delay</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># int or float</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">delay</span>

    <span class="k">assert</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Delay must be non-negative&quot;</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.edge.Edge.update_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_state</span><span class="p">(</span><span class="n">new_state</span><span class="p">,</span> <span class="n">current_time</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.edge.Edge.update_state" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Update node state and track the time spent in the previous state.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>new_state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The new state to transition to. Must be one of "SETUP_STATE", "GENERATING_STATE", "BLOCKED_STATE".</p>
              </div>
            </li>
            <li>
              <b><code>current_time</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The current simulation time.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/edge.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update node state and track the time spent in the previous state.</span>

<span class="sd">    Args:</span>
<span class="sd">        new_state (str): The new state to transition to. Must be one of &quot;SETUP_STATE&quot;, &quot;GENERATING_STATE&quot;, &quot;BLOCKED_STATE&quot;.</span>
<span class="sd">        current_time (float): The current simulation time.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">elapsed</span>
        <span class="p">)</span>    
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.edges.fleet" class="doc doc-heading">
            <code>fleet</code>


<a href="#factorysimpy.edges.fleet" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.edges.fleet.Fleet" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Fleet</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transit_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.fleet.Fleet" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Edge(env, id, capacity) (factorysimpy.edges.edge.Edge)" href="#factorysimpy.edges.edge.Edge">Edge</a></code></p>


        <p>Fleet class representing an AGV (Automated Guided Vehicle) or a group of transporters.
Inherits from the Edge class. This fleet can have a single input edge and a single output edge.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Attributes:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The current state of the fleet.</p>
              </div>
            </li>
            <li>
              <b><code>capacity</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The capacity of the fleet's internal storage.</p>
              </div>
            </li>
            <li>
              <b><code>delay</code></b>
                  (<code>(<span title="int">int</span>, <span title="float">float</span>)</code>)
              –
              <div class="doc-md-description">
                <p>Delay after which fleet activates to move items incase the target capacity is not reached. It Can be</p>
<ul>
<li>int or float: Used as a constant delay.</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>transit_delay</code></b>
                  (<code>(<span title="int">int</span>, <span title="float">float</span>)</code>)
              –
              <div class="doc-md-description">
                <p>It is the time taken by the fleet to transport the item from src node to destination node.  (can be a constant, generator, or callable).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>Behavior:
        The Fleet is a type of edge represents components that moves multiple items simulataneaously between nodes.
        User can specify a parameter <code>capacity</code> to specify how many items can be moved at once.
        Incoming edges can use reserve_get and reserve_put calls on the store in the fleet to reserve an item or space and after yielding
        the requests, an item can be put and obtained by using put and get methods.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="AssertionError">AssertionError</span></code>
              –
              <div class="doc-md-description">
                <p>If the fleet does not have at least one source node or one destination node.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="output-performance-metrics" open>
  <summary>Output performance metrics</summary>
  <p>The key performance metrics of the fleet edge are captured in the <code>stats</code> attribute (dict) during a simulation run. </p>
<div class="codehilite"><pre><span></span><code><span class="n">last_state_change_time</span><span class="w">                      </span><span class="o">:</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">changed</span><span class="o">.</span>
<span class="n">time_averaged_num_of_items_in_fleet</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Time</span><span class="o">-</span><span class="n">averaged</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fleet</span><span class="o">.</span>
<span class="n">total_time_spent_in_states</span><span class="w">                  </span><span class="o">:</span><span class="w"> </span><span class="n">Dictionary</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">state</span><span class="o">.</span>
</code></pre></div>
</details>







                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/edges/fleet.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span>  <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">transit_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;IDLE_STATE&quot;</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span>  <span class="n">capacity</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">transit_delay</span> <span class="o">=</span> <span class="n">transit_delay</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;time_averaged_num_of_items_in_fleet&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:{</span><span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;RELEASING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;BLOCKED_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
    <span class="p">}</span>






      <span class="c1"># Initialize the fleet store</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span> <span class="o">=</span> <span class="n">FleetStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">,</span>  <span class="n">delay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">,</span> <span class="n">transit_delay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_delay</span><span class="p">)</span>






      <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="s1">&#39;__next__&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="n">delay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;delay must be None, int, float, generator, or callable.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.fleet.Fleet.can_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_get</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.fleet.Fleet.can_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the fleet can accept an item.</p>
<h6 id="factorysimpy.edges.fleet.Fleet.can_get--returns">Returns<a class="headerlink" href="#factorysimpy.edges.fleet.Fleet.can_get--returns" title="Permanent link">&para;</a></h6>
<p>bool
    True if the fleet can give an item, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/fleet.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the fleet can accept an item.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if the fleet can give an item, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">ready_items</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="c1">#only return items that are older than the delay. Count such items</span>
    <span class="c1">#count = sum(1 for item in self.inbuiltstore.items if item.time_stamp_creation + self.delay &lt;= self.env.now)</span>
    <span class="c1"># count should be greater than the number of reservations that are already there</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.fleet.Fleet.can_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_put</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.fleet.Fleet.can_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the fleet can accept an item.</p>
<h6 id="factorysimpy.edges.fleet.Fleet.can_put--returns">Returns<a class="headerlink" href="#factorysimpy.edges.fleet.Fleet.can_put--returns" title="Permanent link">&para;</a></h6>
<p>bool
    True if the fleet can accept an item, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/fleet.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_put</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the fleet can accept an item.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if the fleet can accept an item, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the fleet has space for new items</span>
    <span class="k">if</span>  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span><span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="c1"># return True if the number of items in the fleet is less than the store capacity minus the number of reservations</span>
    <span class="c1"># reservations_put is the number of items that are already reserved to be put in the fleet</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">ready_items</span><span class="p">))</span> <span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">reservations_put</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.fleet.Fleet.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.fleet.Fleet.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Get an item from the fleet.</p>
<h6 id="factorysimpy.edges.fleet.Fleet.get--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.fleet.Fleet.get--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for getting an item.</p>
<h6 id="factorysimpy.edges.fleet.Fleet.get--returns">Returns<a class="headerlink" href="#factorysimpy.edges.fleet.Fleet.get--returns" title="Permanent link">&para;</a></h6>
<p>item : object
    The item retrieved from the fleet.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/fleet.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get an item from the fleet.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for getting an item.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    item : object</span>
<span class="sd">        The item retrieved from the fleet.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#print(f&quot;T={self.env.now:.2f}: {self.id} is getting an item at time {self.env.now}, total item in fleet is {len(self.inbuiltstore.items)+len(self.inbuiltstore.ready_items)}&quot;)</span>
    <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fleet_stats_collector</span><span class="p">()</span>
    <span class="c1">#print(f&quot;T={self.env.now:.2f}, got an item!!!!&quot;)</span>
    <span class="n">item</span><span class="o">.</span><span class="n">fleet_exit_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.fleet.Fleet.reserve_get_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.fleet.Fleet.reserve_get_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a reserved get event.</p>
<h6 id="factorysimpy.edges.fleet.Fleet.reserve_get_cancel--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.fleet.Fleet.reserve_get_cancel--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for getting an item.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/fleet.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a reserved get event.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for getting an item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.fleet.Fleet.reserve_put_cancel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.fleet.Fleet.reserve_put_cancel" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Cancel a reserved put event.</p>
<h6 id="factorysimpy.edges.fleet.Fleet.reserve_put_cancel--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.fleet.Fleet.reserve_put_cancel--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for putting an item.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/fleet.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reserve_put_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cancel a reserved put event.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for putting an item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inbuiltstore</span><span class="o">.</span><span class="n">reserve_put_cancel</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.edges.slotted_conveyor" class="doc doc-heading">
            <code>slotted_conveyor</code>


<a href="#factorysimpy.edges.slotted_conveyor" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ConveyorBelt</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">accumulating</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Edge(env, id, capacity) (factorysimpy.edges.edge.Edge)" href="#factorysimpy.edges.edge.Edge">Edge</a></code></p>


        <p>A conveyor belt system with optional accumulation.</p>
<p>Attributes:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">capacity</span><span class="w"> </span><span class="ss">(</span><span class="nv">int</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Maximum</span><span class="w"> </span><span class="nv">capacity</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">belt</span>.
<span class="nv">state</span><span class="w"> </span><span class="ss">(</span><span class="nv">str</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">conveyor</span><span class="w"> </span><span class="nv">belt</span>.
<span class="nv">delay</span><span class="w"> </span><span class="ss">(</span><span class="nv">float</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Time</span><span class="w"> </span><span class="nv">interval</span><span class="w"> </span><span class="nv">between</span><span class="w"> </span><span class="nv">two</span><span class="w"> </span><span class="nv">successive</span><span class="w"> </span><span class="nv">movements</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">belt</span>.
<span class="nv">accumulation</span><span class="w"> </span><span class="ss">(</span><span class="nv">bool</span><span class="ss">)</span>:<span class="w"> </span><span class="nv">Whether</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">belt</span><span class="w"> </span><span class="nv">supports</span><span class="w"> </span><span class="nv">accumulation</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">yes</span>,<span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">no</span><span class="ss">)</span>.
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span><span class="n">accumulating</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">capacity</span> <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;IDLE_STATE&quot;</span>
    <span class="c1">#self.length= length #length of the item</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">accumulating</span> <span class="o">=</span> <span class="n">accumulating</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="o">=</span><span class="n">delay</span>
    <span class="c1">#self.delay = int(self.length/self.speed)*capacity</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">belt</span> <span class="o">=</span> <span class="n">BeltStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">)</span>



    <span class="c1">#self.time_per_item = self.length/self.speed</span>
    <span class="c1">#self.inp_buf=ReservablePriorityReqStore(env, capacity=1)</span>
    <span class="c1">#self.out_buf=ReservablePriorityReqStore(env, capacity=1)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;time_averaged_num_of_items_in_conveyor&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:{</span><span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;MOVING_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ACCUMULATING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;STALLED_NONACCUMULATING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">item_arrival_event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="c1"># self.item_get_event=self.env.event()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_events_available</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">put_events_available</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">noaccumulation_mode_on</span><span class="o">=</span><span class="kc">False</span>


    <span class="c1"># self.get_request_queue = []</span>
    <span class="c1"># self.put_request_queue = []</span>
    <span class="c1"># self.active_events = []</span>
    <span class="c1"># self.get_dict = {}</span>
    <span class="c1"># self.put_dict = {}</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behaviour</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.can_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_get</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.can_get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if an item can be retrieved from the belt.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if an item can be retrieved from the belt.&quot;&quot;&quot;</span>
    <span class="c1">#first_item_to_go_out = self.items[0] if self.items else None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_buf</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.can_put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">can_put</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.can_put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if an item can be added to the belt.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">can_put</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if an item can be added to the belt.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_buf</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.get" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Get an item from the belt.</p>
<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.get--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.get--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for getting an item.</p>
<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.get--returns">Returns<a class="headerlink" href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.get--returns" title="Permanent link">&para;</a></h6>
<p>Item
    The item retrieved from the belt.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get an item from the belt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for getting an item.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Item</span>
<span class="sd">        The item retrieved from the belt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="si">}</span><span class="s2">:get: getting item from belt&quot;</span><span class="p">)</span>
    <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="n">item</span><span class="o">.</span><span class="n">conveyor_exit_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_conveyor_stats_collector</span><span class="p">()</span>
    <span class="c1"># event= self.env.event()</span>
    <span class="c1"># self.get_events_available.succeed()</span>

    <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.is_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_empty</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.is_empty" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the belt is completely empty.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Check if the belt is completely empty.&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>  <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.is_full" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_full</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.is_full" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the belt is full.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_full</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;Check if the belt is full.&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">ready_items</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">capacity</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.is_stalled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_stalled</span><span class="p">()</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.is_stalled" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the belt is stalled due to time constraints.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_stalled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">      </span><span class="sd">&quot;&quot;&quot;Check if the belt is stalled due to time constraints.&quot;&quot;&quot;</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">ready_items</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">reservations_get</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.put" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.put" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Put an item into the belt.</p>
<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.put--parameters">Parameters<a class="headerlink" href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.put--parameters" title="Permanent link">&para;</a></h6>
<p>event : simpy.Event
    The event that was reserved for putting an item.
item : Item
    The item to be put on the belt.</p>
<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.put--returns">Returns<a class="headerlink" href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.put--returns" title="Permanent link">&para;</a></h6>
<p>simpy.Event
    An event that will be triggered when the item is successfully put on the belt.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Put an item into the belt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    event : simpy.Event</span>
<span class="sd">        The event that was reserved for putting an item.</span>
<span class="sd">    item : Item</span>
<span class="sd">        The item to be put on the belt.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    simpy.Event</span>
<span class="sd">        An event that will be triggered when the item is successfully put on the belt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#delay=self.get_delay(self.delay)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Conveyor:put: putting item </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span>
    <span class="n">item</span><span class="o">.</span><span class="n">conveyor_entry_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="n">item_to_put</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="w"> </span><span class="si">}</span><span class="s2">:put: putting item </span><span class="si">{</span><span class="n">item_to_put</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> on belt with delay </span><span class="si">{</span><span class="n">item_to_put</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">return_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">item_to_put</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_conveyor_stats_collector</span><span class="p">()</span>
    <span class="c1"># if len(self.belt.items)==1:</span>
    <span class="c1">#     self.item_arrival_event.succeed()</span>
    <span class="c1">#     print(f&quot;T={self.env.now:.2f}: {self.id }:put: item arrival event succeeded&quot;)</span>
    <span class="c1"># else: </span>

    <span class="c1">#     self.put_events_available.succeed()</span>
    <span class="c1">#     print(f&quot;T={self.env.now:.2f}: {self.id }:put: item arrival event else succeeded&quot;)</span>

    <span class="k">return</span> <span class="n">return_val</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.edges.slotted_conveyor.ConveyorBelt.set_conveyor_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_conveyor_state</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span></code>

<a href="#factorysimpy.edges.slotted_conveyor.ConveyorBelt.set_conveyor_state" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Set the conveyor state and manage belt store interrupts/resumes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>new_state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The new conveyor state</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/edges/slotted_conveyor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_conveyor_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_state</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the conveyor state and manage belt store interrupts/resumes.</span>

<span class="sd">    Args:</span>
<span class="sd">        new_state (str): The new conveyor state</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">old_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> state changed from </span><span class="si">{</span><span class="n">old_state</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Control belt store based on conveyor state changes</span>
    <span class="k">if</span> <span class="n">old_state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MOVING_STATE&quot;</span><span class="p">,</span> <span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">new_state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;STALLED_ACCUMULATING_STATE&quot;</span><span class="p">,</span> <span class="s2">&quot;STALLED_NONACCUMULATING_STATE&quot;</span><span class="p">]:</span>
        <span class="c1"># When conveyor becomes stalled (either accumulating or non-accumulating), apply selective interruption</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">selective_interrupt</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conveyor </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> selective interruption - </span><span class="si">{</span><span class="n">new_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">old_state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;STALLED_ACCUMULATING_STATE&quot;</span><span class="p">,</span> <span class="s2">&quot;STALLED_NONACCUMULATING_STATE&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">new_state</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MOVING_STATE&quot;</span><span class="p">,</span> <span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">]:</span>
        <span class="c1"># When conveyor resumes to moving or becomes idle, resume all belt store processes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belt</span><span class="o">.</span><span class="n">resume_all_move_processes</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="factorysimpy.helper" class="doc doc-heading">
            <code>helper</code>


<a href="#factorysimpy.helper" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h4 id="factorysimpy.helper.baseflowitem" class="doc doc-heading">
            <code>baseflowitem</code>


<a href="#factorysimpy.helper.baseflowitem" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.helper.baseflowitem.BaseFlowItem" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">BaseFlowItem</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

<a href="#factorysimpy.helper.baseflowitem.BaseFlowItem" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">


        <p>A class representing an item .</p>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/helper/baseflowitem.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_creation</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_destruction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_node_entry</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_node_exit</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_node_id</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1"># Track the source node</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">payload</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">destructed_in_node</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Node where item was destructed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Dictionary to store time spent at each node</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.helper.baseflowitem.BaseFlowItem.set_creation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_creation</span><span class="p">(</span><span class="n">source_id</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span></code>

<a href="#factorysimpy.helper.baseflowitem.BaseFlowItem.set_creation" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Set creation time and source node ID.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/helper/baseflowitem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set creation time and source node ID.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_creation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_id</span> <span class="o">=</span> <span class="n">source_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.helper.baseflowitem.BaseFlowItem.set_destruction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_destruction</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span></code>

<a href="#factorysimpy.helper.baseflowitem.BaseFlowItem.set_destruction" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>set the destruction time and node of the item.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/helper/baseflowitem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_destruction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span>  <span class="n">env</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;set the destruction time and node of the item.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_destruction</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">destructed_in_node</span> <span class="o">=</span> <span class="n">node_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.helper.baseflowitem.BaseFlowItem.update_node_event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_node_event</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">event_type</span><span class="o">=</span><span class="s1">&#39;entry&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.helper.baseflowitem.BaseFlowItem.update_node_event" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Update item details and stats when entering or exiting a node.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>node_id</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The ID of the node.</p>
              </div>
            </li>
            <li>
              <b><code>env</code></b>
                  (<code><span title="simpy.Environment">Environment</span></code>)
              –
              <div class="doc-md-description">
                <p>The simulation environment (for current time).</p>
              </div>
            </li>
            <li>
              <b><code>event_type</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;entry&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>"entry" or "exit" to specify the event.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/helper/baseflowitem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_node_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;entry&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update item details and stats when entering or exiting a node.</span>

<span class="sd">    Args:</span>
<span class="sd">        node_id (str): The ID of the node.</span>
<span class="sd">        env (simpy.Environment): The simulation environment (for current time).</span>
<span class="sd">        event_type (str): &quot;entry&quot; or &quot;exit&quot; to specify the event.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;entry&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_node_entry</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">now</span>
        <span class="c1">#print(f&quot;T={self.timestamp_node_entry:.2f}: {self.id} entered node {node_id}&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_node_id</span> <span class="o">=</span> <span class="n">node_id</span>
    <span class="k">elif</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;exit&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_node_exit</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">now</span>
        <span class="c1"># Calculate time spent at the node and update stats</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_node_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_node_entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">time_spent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_node_exit</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_node_entry</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_node_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_node_id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">time_spent</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_node_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_spent</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.helper.item" class="doc doc-heading">
            <code>item</code>


<a href="#factorysimpy.helper.item" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.helper.item.Item" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Item</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

<a href="#factorysimpy.helper.item.Item" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseFlowItem(id) (factorysimpy.helper.baseflowitem.BaseFlowItem)" href="#factorysimpy.helper.baseflowitem.BaseFlowItem">BaseFlowItem</a></code></p>


        <p>A class representing a pallet, which can hold multiple items.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/helper/item.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flow_item_type</span> <span class="o">=</span> <span class="s2">&quot;item&quot;</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.helper.pallet" class="doc doc-heading">
            <code>pallet</code>


<a href="#factorysimpy.helper.pallet" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.helper.pallet.Pallet" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Pallet</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

<a href="#factorysimpy.helper.pallet.Pallet" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseFlowItem(id) (factorysimpy.helper.baseflowitem.BaseFlowItem)" href="#factorysimpy.helper.baseflowitem.BaseFlowItem">BaseFlowItem</a></code></p>


        <p>A class representing a pallet, which can hold multiple items.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/helper/pallet.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flow_item_type</span> <span class="o">=</span> <span class="s2">&quot;Pallet&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to hold contained items</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.helper.pallet.Pallet.add_item" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#factorysimpy.helper.pallet.Pallet.add_item" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Add an item to the pallet.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/helper/pallet.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an item to the pallet.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.helper.pallet.Pallet.remove_item" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_item</span><span class="p">()</span></code>

<a href="#factorysimpy.helper.pallet.Pallet.remove_item" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Remove an item from the pallet if present.</p>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/helper/pallet.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove an item from the pallet if present.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Remove the last item</span>
        <span class="k">return</span> <span class="n">item</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="factorysimpy.nodes" class="doc doc-heading">
            <code>nodes</code>


<a href="#factorysimpy.nodes" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h4 id="factorysimpy.nodes.combiner" class="doc doc-heading">
            <code>combiner</code>


<a href="#factorysimpy.nodes.combiner" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.nodes.combiner.Combiner" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Combiner</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">target_quantity_of_each_item</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">processing_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">out_edge_selection</span><span class="o">=</span><span class="s1">&#39;FIRST_AVAILABLE&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.combiner.Combiner" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code></p>


        <p>Combiner class representing a processing node in a factory simulation.
Inherits from the Node class.The combiner can have multiple input edges and a multiple output edges.
It gets items from the input edges and packs them into a pallet or box and pushes it to the output edge.  </p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Current state of the combiner node. One of :</p>
<ul>
<li>SETUP_STATE: Initial setup phase before combiner starts to operate.</li>
<li>IDLE_STATE: Worker threads waiting to receive items.</li>
<li>PROCESSING_STATE: Actively processing items.</li>
<li>BLOCKED_STATE: When all the worker threads are waiting to push the processed item but the out going edge is full.</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>blocking</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>If True, the source waits until it can put an item into the out edge. If False, it discards the item if the out edge is full and cannot accept the item that is being pushed by the combiner.</p>
              </div>
            </li>
            <li>
              <b><code>processing_delay</code></b>
                  (<code>(None, <span title="int">int</span>, <span title="float">float</span>, <span title="Generator">Generator</span>, <span title="Callable">Callable</span>)</code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>Delay for processing items. Can be:</p>
<ul>
<li>None: Used when the processing time depends on parameters of the node object (like current state of the object) or environment. </li>
<li>int or float: Used as a constant delay.</li>
<li>Generator: A generator function yielding delay values over time.</li>
<li>Callable: A function that returns a delay (int or float).</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>out_edge_selection</code></b>
                  (<code>None or <span title="str">str</span> or <span title="callable">callable</span></code>, default:
                      <code>&#39;FIRST_AVAILABLE&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Criterion or function for selecting the out edge.
                              Options include "RANDOM", "ROUND_ROBIN", "FIRST_AVAILABLE".</p>
<ul>
<li>None: None: Used when out edge selction depends on parameters of the node object (like current state of the object) or environment.   </li>
<li>str: A string that specifies the selection method.<ul>
<li>"RANDOM": Selects a random out edge in the out_edges list.</li>
<li>"ROUND_ROBIN": Selects out edges in a round-robin manner.</li>
<li>"FIRST_AVAILABLE": Selects the first out edge that can accept an item.</li>
</ul>
</li>
<li>callable: A function that returns an edge index.</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="behavior" open>
  <summary>Behavior</summary>
  <p>The combiner node represents components that process or modify the items that flow in the simulation model. It can have multiple incoming edges
and multiple outgoing edge. Edge to which processed item is pushed is decided using the method specified
in the parameter <code>out_edge_selection</code>. Combiner will transition through the states- <code>SETUP_STATE</code>, <code>PROCESSING_STATE</code>, <code>IDLE_STATE</code> and 
<code>BLOCKED_STATE</code>. The combiner has a blocking behavior if <code>blocking</code>=<code>True</code> and gets blocked when all its worker threads have processed items and the out edge is full and 
cannot accept the item that is being pushed by the combiner and waits until the out edge can accept the item. If <code>blocking</code>=<code>False</code>, the combiner will 
discard the item if the out edge is full and cannot accept the item that is being pushed by the combiner.</p>
</details>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="AssertionError">AssertionError</span></code>
              –
              <div class="doc-md-description">
                <p>If the combiner has no input or output edges.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>Output performance metrics:
The key performance metrics of the combiner node is captured in <code>stats</code> attribute (dict) during a simulation run. </p>
<div class="codehilite"><pre><span></span><code><span class="n">last_state_change_time</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">changed</span><span class="o">.</span>
<span class="n">num_item_processed</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">generated</span><span class="o">.</span>
<span class="n">num_item_discarded</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">discarded</span><span class="o">.</span>
<span class="n">total_time_spent_in_states</span><span class="o">:</span><span class="w"> </span><span class="n">Dictionary</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">state</span><span class="o">.</span>
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/nodes/combiner.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">target_quantity_of_each_item</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">processing_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">out_edge_selection</span><span class="o">=</span><span class="s2">&quot;FIRST_AVAILABLE&quot;</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span><span class="n">in_edges</span><span class="p">,</span> <span class="n">out_edges</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;SETUP_STATE&quot;</span>  <span class="c1"># Initial state of the combiner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">work_capacity</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">out_edge_selection</span> <span class="o">=</span> <span class="n">out_edge_selection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocking</span> <span class="o">=</span> <span class="n">blocking</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">per_thread_total_time_in_blocked_state</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">per_thread_total_time_in_processing_state</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">target_quantity_of_each_item</span><span class="o">=</span> <span class="n">target_quantity_of_each_item</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">worker_thread_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to keep track of worker threads</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">item_in_process</span><span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pallet_in_process</span><span class="o">=</span><span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Number of worker threads currently processing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_last_occupancy_change</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Time when the occupancy was last changed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">worker_thread</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">work_capacity</span><span class="p">)</span>  <span class="c1"># Resource for worker threads</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_per_work_occupancy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_capacity</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>  <span class="c1"># Time spent by each worker thread</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;SETUP_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;PROCESSING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;BLOCKED_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span> <span class="p">},</span>
                <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;num_item_processed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;num_item_discarded&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="s2">&quot;processing_delay&quot;</span><span class="p">:[],</span><span class="s2">&quot;out_edge_selection&quot;</span><span class="p">:[]}</span>






    <span class="c1"># Initialize processing delay </span>
    <span class="c1"># If processing_delay is a generator, callable, int, float or None, it is accepted.</span>

    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">,</span> <span class="s1">&#39;__next__&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="n">processing_delay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processing_delay</span> <span class="o">=</span> <span class="n">processing_delay</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;processing_delay must be None, int, float, generator, or callable.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behaviour</span><span class="p">())</span>  <span class="c1"># Start the combiner behavior process</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.combiner.Combiner.add_in_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_in_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.combiner.Combiner.add_in_edges" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Adds an in_edge to the node. Raises an error if the edge already exists in the in_edges list.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>edge (Edge Object) </code></b>
              –
              <div class="doc-md-description">
                <p>The edge to be added as an in_edge.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/combiner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_in_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an in_edge to the node. Raises an error if the edge already exists in the in_edges list.</span>

<span class="sd">    Args:</span>
<span class="sd">        edge (Edge Object) : The edge to be added as an in_edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if len(self.in_edges) &gt;= self.num_in_edges:</span>
    <span class="c1">#     raise ValueError(f&quot;Combiner&#39;{self.id}&#39; already has {self.num_in_edges} in_edges. Cannot add more.&quot;)</span>

    <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge already exists in Combiner &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; in_edges.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.combiner.Combiner.add_out_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_out_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.combiner.Combiner.add_out_edges" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Adds an out_edge to the node. Raises an error if the edge already exists in the out_edges list.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>edge (Edge Object) </code></b>
              –
              <div class="doc-md-description">
                <p>The edge to be added as an out_edge.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/combiner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_out_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an out_edge to the node. Raises an error if the edge already exists in the out_edges list.</span>

<span class="sd">    Args:</span>
<span class="sd">        edge (Edge Object) : The edge to be added as an out_edge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if len(self.out_edges) &gt;= 1:</span>
    <span class="c1">#     raise ValueError(f&quot;Combiner &#39;{self.id}&#39; already has 1 out_edge. Cannot add more.&quot;)</span>

    <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge already exists in Combiner &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; out_edges.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.combiner.Combiner.update_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_state</span><span class="p">(</span><span class="n">new_state</span><span class="p">,</span> <span class="n">current_time</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.combiner.Combiner.update_state" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Update node state and track the time spent in the previous state.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>i</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The index of the worker thread to update the state for.</p>
              </div>
            </li>
            <li>
              <b><code>new_state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The new state to transition to. Must be one of "SETUP_STATE", "GENERATING_STATE", "BLOCKED_STATE".</p>
              </div>
            </li>
            <li>
              <b><code>current_time</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The current simulation time.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/combiner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update node state and track the time spent in the previous state.</span>

<span class="sd">    Args:</span>
<span class="sd">        i (int): The index of the worker thread to update the state for.</span>
<span class="sd">        new_state (str): The new state to transition to. Must be one of &quot;SETUP_STATE&quot;, &quot;GENERATING_STATE&quot;, &quot;BLOCKED_STATE&quot;.</span>
<span class="sd">        current_time (float): The current simulation time.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">elapsed</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.nodes.machine" class="doc doc-heading">
            <code>machine</code>


<a href="#factorysimpy.nodes.machine" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.nodes.machine.Machine" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Machine</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">work_capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">processing_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">in_edge_selection</span><span class="o">=</span><span class="s1">&#39;FIRST_AVAILABLE&#39;</span><span class="p">,</span> <span class="n">out_edge_selection</span><span class="o">=</span><span class="s1">&#39;FIRST_AVAILABLE&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.machine.Machine" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code></p>


        <p>Machine represents a processing node in a factory simulation.
This Machine can have multiple input edges and  output edges.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>state_rep</code></b>
                  (<code><span title="tuple">tuple</span></code>)
              –
              <div class="doc-md-description">
                <p>Current state of the machine node representates as a tuple based on the state of the worker threads (num_worker_threads_processing, num_worker_threads_blocked). Worker threads can be either in the processing state or in the blocked state. Based on that machine can be in one or many of the following states:</p>
<ul>
<li>SETUP_STATE: Initial setup phase before machine starts to operate. Denoted as (-1,-1)</li>
<li>IDLE_STATE: Worker threads waiting to receive items. Denoted as (0,0)</li>
<li>ATLEAST_ONE_PROCESSING_STATE: Active state where items are being processed. State when atleast one thread is in processing state.</li>
<li>ALL_ACTIVE_BLOCKED_STATE: The state when all the worker_threads that are currently active are in "BLOCKED_STATE" as they are waiting for the out edge to be available to accept the processed item.  Number of active threads can be equal to greater than work_capacity.</li>
<li>ALL_ACTIVE_PROCESSING_STATE: The state when all the active threads are in processing state. Number of active threads can be equal to greater than work_capacity.</li>
<li>ATLEAST_ONE_BLOCKED_STATE: The state when atleast one of the worker_threads is in "BLOCKED_STATE" as it is waiting for the out edge to be available to accept the processed item.</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>blocking</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>If True, the source waits until it can put an item into the out edge. If False, it discards the item if the out edge is full and cannot accept the item that is being pushed by the machine.</p>
              </div>
            </li>
            <li>
              <b><code>work_capacity</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>Maximum no. of processing that can be performed simultaneously.1  worker thread can process one item.</p>
              </div>
            </li>
            <li>
              <b><code>processing_delay</code></b>
                  (<code>(None, <span title="int">int</span>, <span title="float">float</span>, <span title="Generator">Generator</span>, <span title="Callable">Callable</span>)</code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>Delay for processing items. Can be:</p>
<ul>
<li>None: Used when the processing time depends on parameters of the node object (like current state of the object) or environment. </li>
<li>int or float: Used as a constant delay.</li>
<li>Generator: A generator function yielding delay values over time.</li>
<li>Callable: A function that returns a delay (int or float).</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>in_edge_selection</code></b>
                  (<code>None or <span title="str">str</span> or <span title="callable">callable</span></code>, default:
                      <code>&#39;FIRST_AVAILABLE&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Criterion or function for selecting the edge.
                              Options include "RANDOM", "ROUND_ROBIN", "FIRST_AVAILABLE".</p>
<ul>
<li>None: None: Used when edge selction depends on parameters of the node object (like current state of the object) or environment. </li>
<li>str: A string that specifies the selection method.<ul>
<li>"RANDOM": Selects a random edge.</li>
<li>"ROUND_ROBIN": Selects edges in a round-robin manner.</li>
<li>"FIRST_AVAILABLE": Selects the first out edge that can give an item.</li>
</ul>
</li>
<li>callable: A function that returns an edge index.</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>out_edge_selection</code></b>
                  (<code>None or <span title="str">str</span> or <span title="callable">callable</span></code>, default:
                      <code>&#39;FIRST_AVAILABLE&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Criterion or function for selecting the out edge.
                              Options include "RANDOM", "ROUND_ROBIN", "FIRST_AVAILABLE".</p>
<ul>
<li>None: None: Used when out edge selction depends on parameters of the node object (like current state of the object) or environment.   </li>
<li>str: A string that specifies the selection method.<ul>
<li>"RANDOM": Selects a random out edge in the out_edges list.</li>
<li>"ROUND_ROBIN": Selects out edges in a round-robin manner.</li>
<li>"FIRST_AVAILABLE": Selects the first out edge that can accept an item.</li>
</ul>
</li>
<li>callable: A function that returns an edge index.</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="behavior" open>
  <summary>Behavior</summary>
  <p>The machine node represents components that process or modify the items that flow in the simulation model. It can have multiple incoming edges
and multiple outgoing edge. Edge from which the item comes in and the edge to which processed item is pushed is decided using the method specified
in the parameter <code>in_edge_selection</code> and <code>out_edge_selection</code>. Machine will transition through the states- <code>SETUP_STATE</code>, <code>PROCESSING_STATE</code>, <code>IDLE_STATE</code> and 
<code>BLOCKED_STATE</code>. The machine has a blocking behavior if <code>blocking</code>=<code>True</code> and gets blocked when all its worker threads have processed items and the out edge is full and 
cannot accept the item that is being pushed by the machine and waits until the out edge can accept the item. If <code>blocking</code>=<code>False</code>, the machine will 
discard the item if the out edge is full and cannot accept the item that is being pushed by the machine.</p>
</details>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="AssertionError">AssertionError</span></code>
              –
              <div class="doc-md-description">
                <p>If the Machine has no input or output edges.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>Output performance metrics:
The key performance metrics of the Machine node is captured in <code>stats</code> attribute (dict) during a simulation run. </p>
<div class="codehilite"><pre><span></span><code><span class="n">last_state_change_time</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">changed</span><span class="o">.</span>
<span class="n">num_item_processed</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">generated</span><span class="o">.</span>
<span class="n">num_item_discarded</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">discarded</span><span class="o">.</span>
<span class="n">total_time_spent_in_states</span><span class="o">:</span><span class="w"> </span><span class="n">Dictionary</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">state</span><span class="o">.</span>
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/nodes/machine.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">work_capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">processing_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">in_edge_selection</span><span class="o">=</span><span class="s2">&quot;FIRST_AVAILABLE&quot;</span><span class="p">,</span><span class="n">out_edge_selection</span><span class="o">=</span><span class="s2">&quot;FIRST_AVAILABLE&quot;</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span><span class="n">in_edges</span><span class="p">,</span> <span class="n">out_edges</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="p">)</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">work_capacity</span> <span class="o">=</span> <span class="n">work_capacity</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_edge_selection</span> <span class="o">=</span> <span class="n">in_edge_selection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_edge_selection</span> <span class="o">=</span> <span class="n">out_edge_selection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_rep</span><span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocking</span> <span class="o">=</span> <span class="n">blocking</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">per_thread_total_time_in_blocked_state</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">per_thread_total_time_in_processing_state</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">worker_thread_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to keep track of worker threads</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">item_in_process</span><span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Number of worker threads currently processing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_last_occupancy_change</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Time when the occupancy was last changed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">worker_thread</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">work_capacity</span><span class="p">)</span>  <span class="c1"># Resource for worker threads</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_per_work_occupancy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">work_capacity</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>  <span class="c1"># Time spent by each worker thread</span>
    <span class="c1">#self.stats={&quot;total_time_spent_in_states&quot;: {&quot;SETUP_STATE&quot;: 0.0, &quot;IDLE_STATE&quot;:0.0, &quot;PROCESSING_STATE&quot;: 0.0,&quot;BLOCKED_STATE&quot;:0.0 },</span>
     <span class="c1">#           &quot;last_state_change_time&quot;: None, &quot;num_item_processed&quot;: 0, &quot;num_item_discarded&quot;: 0,&quot;processing_delay&quot;:[], &quot;in_edge_selection&quot;:[],&quot;out_edge_selection&quot;:[]}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_time_all_blocked</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_time_all_processing</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_time_atleast_one_blocked</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_time_atleast_one_processing</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">total_time_idle</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_time_setup</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;SETUP_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ATLEAST_ONE_PROCESSING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="s2">&quot;ALL_ACTIVE_BLOCKED_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ALL_ACTIVE_PROCESSING_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span> <span class="p">,</span><span class="s2">&quot;ATLEAST_ONE_BLOCKED_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span> <span class="p">},</span>
                <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;num_item_processed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;num_item_discarded&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="s2">&quot;processing_delay&quot;</span><span class="p">:[],</span> <span class="s2">&quot;in_edge_selection&quot;</span><span class="p">:[],</span><span class="s2">&quot;out_edge_selection&quot;</span><span class="p">:[]}</span>






    <span class="c1"># Initialize processing delay </span>
    <span class="c1"># If processing_delay is a generator, callable, int, float or None, it is accepted.</span>

    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">,</span> <span class="s1">&#39;__next__&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="n">processing_delay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processing_delay</span> <span class="o">=</span> <span class="n">processing_delay</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;processing_delay must be None, int, float, generator, or callable.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behaviour</span><span class="p">())</span>  <span class="c1"># Start the machine behavior process</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.machine.Machine.add_in_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_in_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.machine.Machine.add_in_edges" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Adds an in_edge to the node. Raises an error if the edge already exists in the in_edges list.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>edge (Edge Object) </code></b>
              –
              <div class="doc-md-description">
                <p>The edge to be added as an in_edge.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_in_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an in_edge to the node. Raises an error if the edge already exists in the in_edges list.</span>

<span class="sd">    Args:</span>
<span class="sd">        edge (Edge Object) : The edge to be added as an in_edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if len(self.in_edges) &gt;= self.num_in_edges:</span>
    <span class="c1">#     raise ValueError(f&quot;Machine&#39;{self.id}&#39; already has {self.num_in_edges} in_edges. Cannot add more.&quot;)</span>

    <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge already exists in Machine &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; in_edges.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.machine.Machine.add_out_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_out_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.machine.Machine.add_out_edges" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Adds an out_edge to the node. Raises an error if the edge already exists in the out_edges list.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>edge (Edge Object) </code></b>
              –
              <div class="doc-md-description">
                <p>The edge to be added as an out_edge.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_out_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an out_edge to the node. Raises an error if the edge already exists in the out_edges list.</span>

<span class="sd">    Args:</span>
<span class="sd">        edge (Edge Object) : The edge to be added as an out_edge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if len(self.out_edges) &gt;= 1:</span>
    <span class="c1">#     raise ValueError(f&quot;Machine &#39;{self.id}&#39; already has 1 out_edge. Cannot add more.&quot;)</span>

    <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge already exists in Machine &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; out_edges.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.machine.Machine.update_state_rep" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_state_rep</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.machine.Machine.update_state_rep" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Update the state representation tuple based on the current state of worker threads.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The current state of the machine.</p>
              </div>
            </li>
            <li>
              <b><code>current_time</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The current simulation time.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/machine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_state_rep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_time</span><span class="p">):</span>  
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the state representation tuple based on the current state of worker threads.</span>

<span class="sd">    Args:</span>
<span class="sd">        state (str): The current state of the machine.</span>
<span class="sd">        current_time (float): The current simulation time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">previous_state_rep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_rep</span>


    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_rep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span>
        <span class="c1"># all idle</span>
        <span class="k">if</span> <span class="n">previous_state_rep</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">elapsed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_time_idle</span> <span class="o">+=</span> <span class="n">elapsed</span>

        <span class="c1"># all active are blocked and none processing</span>
        <span class="k">if</span> <span class="n">previous_state_rep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">previous_state_rep</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="s2">&quot;ALL_ACTIVE_BLOCKED_STATE&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">elapsed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_time_all_blocked</span> <span class="o">+=</span> <span class="n">elapsed</span>
        <span class="c1"># at least one processing </span>
        <span class="k">if</span> <span class="n">previous_state_rep</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span>  <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="s2">&quot;ATLEAST_ONE_PROCESSING_STATE&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">elapsed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_time_atleast_one_processing</span> <span class="o">+=</span> <span class="n">elapsed</span>
        <span class="c1"># all active are processing and none blocked</span>
        <span class="k">if</span> <span class="n">previous_state_rep</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span>  <span class="ow">and</span> <span class="n">previous_state_rep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="s2">&quot;ALL_ACTIVE_PROCESSING_STATE&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">elapsed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_time_all_processing</span> <span class="o">+=</span> <span class="n">elapsed</span>
        <span class="c1">#at least one blocked</span>
        <span class="k">if</span> <span class="n">previous_state_rep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="s2">&quot;ATLEAST_ONE_BLOCKED_STATE&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">elapsed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_time_atleast_one_blocked</span> <span class="o">+=</span> <span class="n">elapsed</span>

        <span class="n">num_processing</span><span class="p">,</span> <span class="n">num_blocked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_worker_state</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_rep</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_processing</span><span class="p">,</span> <span class="n">num_blocked</span><span class="p">)</span>




    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.nodes.node" class="doc doc-heading">
            <code>node</code>


<a href="#factorysimpy.nodes.node" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.nodes.node.Node" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Node</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.node.Node" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">


        <p>Base class to represent an active entity in a manufacturing system,
such as machines, splits, or joints.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>id</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Identifier for the node.</p>
              </div>
            </li>
            <li>
              <b><code>node_setup_time</code></b>
                  (<code>int, or float</code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>Initial setup time for the node. Can be:</p>
<ul>
<li>int or float: Used as a constant delay. </li>
</ul>
              </div>
            </li>
            <li>
              <b><code>in_edges</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>List of input edges connected to the node. </p>
              </div>
            </li>
            <li>
              <b><code>out_edges</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>List of output edges connected to the node. </p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="TypeError">TypeError</span></code>
              –
              <div class="doc-md-description">
                <p>If the type of <code>env</code> or <code>id</code> is incorrect.</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If <code>node_setup_time</code> input is invalid.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>







                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/nodes/node.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="o">=</span> <span class="mi">0</span><span class="p">):</span>

    <span class="c1"># Type checks</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;env must be a simpy.Environment instance&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;name must be a string&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span> <span class="c1"># Identifier for the node.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">node_setup_time</span> <span class="o">=</span> <span class="n">node_setup_time</span> <span class="c1"># Time taken to set up the node.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span> <span class="o">=</span> <span class="n">in_edges</span> <span class="c1"># List of input edges connected to the node.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="o">=</span> <span class="n">out_edges</span> <span class="c1">#List of output edges connected to the node.</span>


    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node_setup_time</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_setup_time</span> <span class="o">=</span> <span class="n">node_setup_time</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid node_setup_time value. Provide constant ( int or float).&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.node.Node.get_delay" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_delay</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.node.Node.get_delay" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Returns value based on the type of parameter <code>delay</code> provided.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>delay</code></b>
                  (<code>int, float, generator, or callable</code>)
              –
              <div class="doc-md-description">
                <p>The delay time, which can be:</p>
<ul>
<li>int or float: Used as a constant delay.</li>
<li>generator: A generator instance yielding delay values.</li>
<li>callable: A function that returns a delay values.</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              –
              <div class="doc-md-description">
                <p>Returns a constant delay if <code>delay</code> is an int or float, a value yielded  if <code>delay</code> is a generator, or the value returned from a Callable function if <code>delay</code> is callable.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/node.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_delay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">delay</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns value based on the type of parameter `delay` provided.</span>

<span class="sd">    Args:</span>
<span class="sd">         delay (int, float, generator, or callable): The delay time, which can be:</span>

<span class="sd">            - int or float: Used as a constant delay.</span>
<span class="sd">            - generator: A generator instance yielding delay values.</span>
<span class="sd">            - callable: A function that returns a delay values.</span>

<span class="sd">    Returns:</span>
<span class="sd">           Returns a constant delay if `delay` is an int or float, a value yielded  if `delay` is a generator, or the value returned from a Callable function if `delay` is callable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="s1">&#39;__next__&#39;</span><span class="p">):</span>
        <span class="c1"># Generator instance</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">delay</span><span class="p">):</span>
        <span class="c1"># Function</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">delay</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># int or float</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">delay</span>
    <span class="c1">#print(self.id)</span>
    <span class="k">assert</span> <span class="n">val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">- Delay must be non-negative&quot;</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.node.Node.update_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_state</span><span class="p">(</span><span class="n">new_state</span><span class="p">,</span> <span class="n">current_time</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.node.Node.update_state" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Update node state and track the time spent in the previous state.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>new_state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The new state to transition to. Must be one of "SETUP_STATE", "GENERATING_STATE", "BLOCKED_STATE".</p>
              </div>
            </li>
            <li>
              <b><code>current_time</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The current simulation time.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/node.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update node state and track the time spent in the previous state.</span>

<span class="sd">    Args:</span>
<span class="sd">        new_state (str): The new state to transition to. Must be one of &quot;SETUP_STATE&quot;, &quot;GENERATING_STATE&quot;, &quot;BLOCKED_STATE&quot;.</span>
<span class="sd">        current_time (float): The current simulation time.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">elapsed</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.nodes.sink" class="doc doc-heading">
            <code>sink</code>


<a href="#factorysimpy.nodes.sink" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.nodes.sink.Sink" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Sink</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.sink.Sink" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code></p>


        <p>A Sink is a terminal node that collects flow items at the end. Once an item enters the
Sink, it is considered to have exited the system and cannot be
retrieved or processed further
This sink can have multiple input edges and no output edges.</p>


<details class="raises-" open>
  <summary>Raises</summary>
  <p>AssertionError: If the sink does not have at least 1 input edge or has an output edge.</p>
</details>







                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/nodes/sink.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span><span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>   <span class="n">node_setup_time</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;COLLECTING_STATE&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">in_edge_events</span><span class="o">=</span><span class="p">[]</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;num_item_received&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:{</span><span class="s2">&quot;COLLECTING_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">},</span> <span class="s2">&quot;total_cycle_time&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">}</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">item_in_process</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">buffertime</span><span class="o">=</span><span class="mi">0</span>
      <span class="c1"># Start behavior process</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behaviour</span><span class="p">())</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">item_list</span><span class="o">=</span><span class="p">{}</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.nodes.source" class="doc doc-heading">
            <code>source</code>


<a href="#factorysimpy.nodes.source" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.nodes.source.Source" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Source</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">item_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">flow_item_type</span><span class="o">=</span><span class="s1">&#39;item&#39;</span><span class="p">,</span> <span class="n">inter_arrival_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_edge_selection</span><span class="o">=</span><span class="s1">&#39;FIRST_AVAILABLE&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.source.Source" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code></p>




<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Current state of the source node. One of :</p>
<ul>
<li>SETUP_STATE: Initial setup phase before item generation starts.</li>
<li>GENERATING_STATE: Actively generating and dispatching items.</li>
<li>BLOCKED_STATE: Waiting to transfer item when edge is full (in blocking mode).</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>inter_arrival_time</code></b>
                  (<code>None, int, float, generator, or callable</code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>Time between item generations. Can be:</p>
<ul>
<li>None: Used when the setup time depends on parameters of the node object (like current state of the object) or environment. </li>
<li>int or float: Used as a constant delay.</li>
<li>Callable: A function that returns a delay (int or float).</li>
<li>Generator: A generator function yielding delay values over time.  </li>
</ul>
              </div>
            </li>
            <li>
              <b><code>flow_item_type</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;item&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Type of item to be generated. Default is "item". Can be </p>
<ul>
<li>"item" : Smallest unit of discrete item and it cannot hold other items inside. </li>
<li>"pallet" : Entities that can store multiple smaller units of items </li>
</ul>
              </div>
            </li>
            <li>
              <b><code>blocking</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>If True, the source waits until it can put an item into the out edge.</p>
              </div>
            </li>
            <li>
              <b><code>out_edge_selection</code></b>
                  (<code>None or <span title="str">str</span> or <span title="callable">callable</span></code>, default:
                      <code>&#39;FIRST_AVAILABLE&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Criterion or function for selecting the out edge.
                                  Options include "RANDOM", "FIRST", "LAST", "ROUND_ROBIN", "FIRST_AVAILABLE".</p>
<ul>
<li>None: Used when out edge selection depends on parameters of the node object (like current state of the object) or environment.    </li>
<li>str: A string that specifies the selection method.<ul>
<li>"RANDOM": Selects a random out edge.</li>
<li>"ROUND_ROBIN": Selects out edges in a round-robin manner.</li>
<li>"FIRST_AVAILABLE": Selects the first out edge that can accept an item.</li>
</ul>
</li>
<li>callable: A function that returns an edge index.</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>Behavior:</p>
<p>The Source node is responsible for generating items that flow in the simulation model. It operates in two modes: 
blocking and non-blocking.</p>
<p>when <code>blocking=True</code>:
    - After each <code>inter_arrival_time</code>, the source generates an item.
    - If the selected out edge is full, the source waits until space is available.
    - Once space is available, the item is transferred to the selected edge.
    - <code>inter_arrival_time</code> must not be <code>None</code>.</p>
<p>when <code>blocking=False</code>:
    - After each <code>inter_arrival_time</code>, the source generates an item.
    - If the selected out edge is full, the item is discarded immediately.
    - If space is available, the item is transferred without waiting.
    - <code>inter_arrival_time</code> must not be 0.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If <code>inter_arrival_time</code> is 0 in non-blocking mode or if <code>out_edge_selection</code> is not a valid type.</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If <code>out_edge_selection</code> is not a string or callable.</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If <code>out_edges</code> is not provided or has less than one edge.</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If <code>in_edges</code> is provided, as Source nodes should not have input edges.</p>
              </div>
            </li>
            <li>
                  <code><span title="ValueError">ValueError</span></code>
              –
              <div class="doc-md-description">
                <p>If <code>out_edges</code> already has an edge when trying to add a new one.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>Output performance metrics:
The key performance metrics of the Source node is captured in <code>stats</code> attribute (dict) during a simulation run. </p>
<div class="codehilite"><pre><span></span><code><span class="n">last_state_change_time</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">changed</span><span class="o">.</span>
<span class="n">num_item_generated</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">generated</span><span class="o">.</span>
<span class="n">num_item_discarded</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">discarded</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">lack</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="n">edge</span><span class="o">.</span>
<span class="n">total_time_spent_in_states</span><span class="o">:</span><span class="w"> </span><span class="n">Dictionary</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">state</span><span class="o">.</span>
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/nodes/source.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">item_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">flow_item_type</span> <span class="o">=</span> <span class="s2">&quot;item&quot;</span><span class="p">,</span> <span class="n">inter_arrival_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">out_edge_selection</span><span class="o">=</span><span class="s2">&quot;FIRST_AVAILABLE&quot;</span> <span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span><span class="n">in_edges</span> <span class="p">,</span> <span class="n">out_edges</span> <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;SETUP_STATE&quot;</span> <span class="c1"># Initial state of the source node</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocking</span> <span class="o">=</span> <span class="n">blocking</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">item_length</span> <span class="o">=</span> <span class="n">item_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_edge_selection</span> <span class="o">=</span> <span class="n">out_edge_selection</span>  <span class="c1"># Selection strategy for out edges</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flow_item_type</span> <span class="o">=</span> <span class="n">flow_item_type</span> <span class="c1"># Type of item to be generated, default is &quot;item&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;num_item_generated&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;num_item_discarded&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:{</span><span class="s2">&quot;SETUP_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;GENERATING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;BLOCKED_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
    <span class="p">}</span>





    <span class="k">if</span> <span class="n">inter_arrival_time</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocking</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Non-blocking source must have a non-zero inter_arrival_time.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">inter_arrival_time</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_arrival_time</span> <span class="o">=</span> <span class="n">inter_arrival_time</span>  
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">inter_arrival_time</span><span class="p">,</span> <span class="s1">&#39;__next__&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_arrival_time</span> <span class="o">=</span> <span class="n">inter_arrival_time</span>    
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inter_arrival_time</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_arrival_time</span> <span class="o">=</span> <span class="n">inter_arrival_time</span>
    <span class="c1"># interarrival_time is None and will be initialized later by the user</span>
    <span class="k">elif</span> <span class="n">inter_arrival_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_arrival_time</span> <span class="o">=</span> <span class="n">inter_arrival_time</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print(&quot;GGG&quot;,inter_arrival_time)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;inter_arrival_time must be a None, int, float, generator, or callable.&quot;</span><span class="p">)</span>
     <span class="c1"># Start behavior process</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behaviour</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.source.Source.add_out_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_out_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.source.Source.add_out_edges" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Adds an out_edge to the source node. Raises an error if the source already has an 
out_edge or if the edge already exists in the out_edges list.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>edge</code></b>
                  (<code>Edge Object</code>)
              –
              <div class="doc-md-description">
                <p>The edge to be added as an out_edge.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_out_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an out_edge to the source node. Raises an error if the source already has an </span>
<span class="sd">    out_edge or if the edge already exists in the out_edges list.</span>

<span class="sd">    Args:</span>
<span class="sd">        edge (Edge Object): The edge to be added as an out_edge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; already has 1 out_edge. Cannot add more.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge already exists in Source &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; out_edges.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.source.Source.update_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_state</span><span class="p">(</span><span class="n">new_state</span><span class="p">,</span> <span class="n">current_time</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.source.Source.update_state" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Update node state and track the time spent in the previous state.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>i</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The index of the worker thread to update the state for.</p>
              </div>
            </li>
            <li>
              <b><code>new_state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The new state to transition to. Must be one of "SETUP_STATE", "GENERATING_STATE", "BLOCKED_STATE".</p>
              </div>
            </li>
            <li>
              <b><code>current_time</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The current simulation time.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update node state and track the time spent in the previous state.</span>

<span class="sd">    Args:</span>
<span class="sd">        i (int): The index of the worker thread to update the state for.</span>
<span class="sd">        new_state (str): The new state to transition to. Must be one of &quot;SETUP_STATE&quot;, &quot;GENERATING_STATE&quot;, &quot;BLOCKED_STATE&quot;.</span>
<span class="sd">        current_time (float): The current simulation time.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">elapsed</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.nodes.splitter" class="doc doc-heading">
            <code>splitter</code>


<a href="#factorysimpy.nodes.splitter" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="factorysimpy.nodes.splitter.Splitter" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Splitter</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">processing_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;UNPACK&#39;</span><span class="p">,</span> <span class="n">split_quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_edge_selection</span><span class="o">=</span><span class="s1">&#39;FIRST_AVAILABLE&#39;</span><span class="p">,</span> <span class="n">out_edge_selection</span><span class="o">=</span><span class="s1">&#39;FIRST_AVAILABLE&#39;</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.splitter.Splitter" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Node(env, id, in_edges=None, out_edges=None, node_setup_time=0) (factorysimpy.nodes.node.Node)" href="#factorysimpy.nodes.node.Node">Node</a></code></p>


        <p>Splitter class representing a processing node that can unpack an incoming item and send it to multiple outgoing edges in a factory simulation.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Current state of the splitter node. One of :</p>
<ul>
<li>SETUP_STATE: Initial setup phase before splitter starts to operate.</li>
<li>IDLE_STATE: Worker threads waiting to receive items.</li>
<li>PROCESSING_STATE: Actively processing items.</li>
<li>BLOCKED_STATE: When all the worker threads are waiting to push the processed item but the out going edge is full.</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>blocking</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>If True, the node waits until it can put an item into the out edge. If False, it discards the item if the out edge is full and cannot accept the item that is being pushed by the splitter.</p>
              </div>
            </li>
            <li>
              <b><code>mode</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;UNPACK&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Mode of operation of the splitter. Either "UNPACK" or "SPLIT".
- "UNPACK": The splitter unpacks all items from a packed item (like a pallet) and pushes each item to an output edge, one by one. After all items are pushed, the empty container itself is pushed to an output edge.
- "SPLIT": The splitter splits the incoming item into a target quantity of items, specified by <code>split_quantity</code> and pushes each item to an output edge, one by one.</p>
              </div>
            </li>
            <li>
              <b><code>split_quantity</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Target quantity of items to split the input flow item into. This parameter is required if <code>mode</code> is "SPLIT". If <code>mode</code> is "UNPACK", this parameter is ignored.</p>
              </div>
            </li>
            <li>
              <b><code>processing_delay</code></b>
                  (<code>(None, <span title="int">int</span>, <span title="float">float</span>, <span title="Generator">Generator</span>, <span title="Callable">Callable</span>)</code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>Delay for processing items. Can be:</p>
<ul>
<li>None: Used when the processing time depends on parameters of the node object (like current state of the object) or environment. </li>
<li>int or float: Used as a constant delay.</li>
<li>Generator: A generator function yielding delay values over time.</li>
<li>Callable: A function that returns a delay (int or float).</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>in_edge_selection</code></b>
                  (<code>None or <span title="str">str</span> or <span title="callable">callable</span></code>, default:
                      <code>&#39;FIRST_AVAILABLE&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Criterion or function for selecting the edge.
                              Options include "RANDOM", "ROUND_ROBIN", "FIRST_AVAILABLE".</p>
<ul>
<li>None: Used when edge selction depends on parameters of the node object (like current state of the object) or environment. </li>
<li>str: A string that specifies the selection method.<ul>
<li>"RANDOM": Selects a random edge.</li>
<li>"ROUND_ROBIN": Selects edges in a round-robin manner.</li>
<li>"FIRST_AVAILABLE": Selects the first out edge that can give an item.</li>
</ul>
</li>
<li>callable: A function that returns an edge index.</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>out_edge_selection</code></b>
                  (<code>None or <span title="str">str</span> or <span title="callable">callable</span></code>, default:
                      <code>&#39;FIRST_AVAILABLE&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Criterion or function for selecting the out edge.
                              Options include "RANDOM", "ROUND_ROBIN", "FIRST_AVAILABLE".</p>
<ul>
<li>None: None: Used when out edge selction depends on parameters of the node object (like current state of the object) or environment.   </li>
<li>str: A string that specifies the selection method.<ul>
<li>"RANDOM": Selects a random out edge in the out_edges list.</li>
<li>"ROUND_ROBIN": Selects out edges in a round-robin manner.</li>
<li>"FIRST_AVAILABLE": Selects the first out edge that can accept an item.</li>
</ul>
</li>
<li>callable: A function that returns an edge index.</li>
</ul>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="behavior" open>
  <summary>Behavior</summary>
  <p>The Splitter node represents components that process or modify the items that flow in the simulation model. It can have multiple incoming edges
and multiple outgoing edge. Edge from which the item comes in and the edge to which processed item is pushed is decided using the method specified
in the parameter <code>in_edge_selection</code> and <code>out_edge_selection</code>. Splitter will transition through the states- <code>SETUP_STATE</code>, <code>PROCESSING_STATE</code>, <code>IDLE_STATE</code> and
<code>BLOCKED_STATE</code>. The Splitter has a blocking behavior if <code>blocking</code>=<code>True</code> and gets blocked when all its worker threads have processed items and the out edge is full and
cannot accept the item that is being pushed by the Splitter and waits until the out edge can accept the item. If <code>blocking</code>=<code>False</code>, the Splitter will
discard the item if the out edge is full and cannot accept the item that is being pushed by the Splitter.</p>
</details>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="AssertionError">AssertionError</span></code>
              –
              <div class="doc-md-description">
                <p>If the Splitter has no input or output edges.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>        <p>Output performance metrics:
The key performance metrics of the Splitter node is captured in <code>stats</code> attribute (dict) during a simulation run. </p>
<div class="codehilite"><pre><span></span><code><span class="n">last_state_change_time</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">changed</span><span class="o">.</span>
<span class="n">num_item_processed</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">generated</span><span class="o">.</span>
<span class="n">num_item_discarded</span><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Total</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">discarded</span><span class="o">.</span>
<span class="n">total_time_spent_in_states</span><span class="o">:</span><span class="w"> </span><span class="n">Dictionary</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">spent</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">each</span><span class="w"> </span><span class="n">state</span><span class="o">.</span>
</code></pre></div>








                  <details class="quote">
                    <summary>Source code in <code>src/factorysimpy/nodes/splitter.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">node_setup_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">processing_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span> <span class="s2">&quot;UNPACK&quot;</span><span class="p">,</span> <span class="n">split_quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_edge_selection</span><span class="o">=</span><span class="s2">&quot;FIRST_AVAILABLE&quot;</span><span class="p">,</span><span class="n">out_edge_selection</span><span class="o">=</span><span class="s2">&quot;FIRST_AVAILABLE&quot;</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span><span class="n">in_edges</span><span class="p">,</span> <span class="n">out_edges</span><span class="p">,</span> <span class="n">node_setup_time</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;SETUP_STATE&quot;</span>  <span class="c1"># Initial state of the Splitter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">work_capacity</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_edge_selection</span> <span class="o">=</span> <span class="n">in_edge_selection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_edge_selection</span> <span class="o">=</span> <span class="n">out_edge_selection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocking</span> <span class="o">=</span> <span class="n">blocking</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_quantity</span> <span class="o">=</span> <span class="n">split_quantity</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">per_thread_total_time_in_blocked_state</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">per_thread_total_time_in_processing_state</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">worker_thread_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to keep track of worker threads</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">item_in_process</span><span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pallet_in_process</span><span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Number of worker threads currently processing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_last_occupancy_change</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Time when the occupancy was last changed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">worker_thread</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">work_capacity</span><span class="p">)</span>  <span class="c1"># Resource for worker threads</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_per_work_occupancy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_capacity</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>  <span class="c1"># Time spent by each worker thread</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;SETUP_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;IDLE_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;PROCESSING_STATE&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span><span class="s2">&quot;BLOCKED_STATE&quot;</span><span class="p">:</span><span class="mf">0.0</span> <span class="p">},</span>
                <span class="s2">&quot;last_state_change_time&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;num_item_processed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;num_item_discarded&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="s2">&quot;processing_delay&quot;</span><span class="p">:[],</span> <span class="s2">&quot;in_edge_selection&quot;</span><span class="p">:[],</span><span class="s2">&quot;out_edge_selection&quot;</span><span class="p">:[]}</span>






    <span class="c1"># Initialize processing delay </span>
    <span class="c1"># If processing_delay is a generator, callable, int, float or None, it is accepted.</span>

    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">,</span> <span class="s1">&#39;__next__&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">processing_delay</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="n">processing_delay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processing_delay</span> <span class="o">=</span> <span class="n">processing_delay</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;processing_delay must be None, int, float, generator, or callable.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">behaviour</span><span class="p">())</span>  <span class="c1"># Start the Splitter behavior process</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.splitter.Splitter.add_in_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_in_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.splitter.Splitter.add_in_edges" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Adds an in_edge to the node. Raises an error if the edge already exists in the in_edges list.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>edge (Edge Object) </code></b>
              –
              <div class="doc-md-description">
                <p>The edge to be added as an in_edge.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/splitter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_in_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an in_edge to the node. Raises an error if the edge already exists in the in_edges list.</span>

<span class="sd">    Args:</span>
<span class="sd">        edge (Edge Object) : The edge to be added as an in_edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if len(self.in_edges) &gt;= self.num_in_edges:</span>
    <span class="c1">#     raise ValueError(f&quot;Splitter&#39;{self.id}&#39; already has {self.num_in_edges} in_edges. Cannot add more.&quot;)</span>

    <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge already exists in Splitter &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; in_edges.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.splitter.Splitter.add_out_edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_out_edges</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.splitter.Splitter.add_out_edges" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Adds an out_edge to the node. Raises an error if the edge already exists in the out_edges list.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>edge (Edge Object) </code></b>
              –
              <div class="doc-md-description">
                <p>The edge to be added as an out_edge.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/splitter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_out_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds an out_edge to the node. Raises an error if the edge already exists in the out_edges list.</span>

<span class="sd">    Args:</span>
<span class="sd">        edge (Edge Object) : The edge to be added as an out_edge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># if len(self.out_edges) &gt;= 1:</span>
    <span class="c1">#     raise ValueError(f&quot;Splitter &#39;{self.id}&#39; already has 1 out_edge. Cannot add more.&quot;)</span>

    <span class="k">if</span> <span class="n">edge</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Edge already exists in Splitter &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39; out_edges.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="factorysimpy.nodes.splitter.Splitter.update_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_state</span><span class="p">(</span><span class="n">new_state</span><span class="p">,</span> <span class="n">current_time</span><span class="p">)</span></code>

<a href="#factorysimpy.nodes.splitter.Splitter.update_state" class="headerlink" title="Permanent link">&para;</a></h6>


    <div class="doc doc-contents ">

        <p>Update node state and track the time spent in the previous state.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>i</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The index of the worker thread to update the state for.</p>
              </div>
            </li>
            <li>
              <b><code>new_state</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>The new state to transition to. Must be one of "SETUP_STATE", "GENERATING_STATE", "BLOCKED_STATE".</p>
              </div>
            </li>
            <li>
              <b><code>current_time</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The current simulation time.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/nodes/splitter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update node state and track the time spent in the previous state.</span>

<span class="sd">    Args:</span>
<span class="sd">        i (int): The index of the worker thread to update the state for.</span>
<span class="sd">        new_state (str): The new state to transition to. Must be one of &quot;SETUP_STATE&quot;, &quot;GENERATING_STATE&quot;, &quot;BLOCKED_STATE&quot;.</span>
<span class="sd">        current_time (float): The current simulation time.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">elapsed</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;last_state_change_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="factorysimpy.utils" class="doc doc-heading">
            <code>utils</code>


<a href="#factorysimpy.utils" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h4 id="factorysimpy.utils.stats_summary" class="doc doc-heading">
            <code>stats_summary</code>


<a href="#factorysimpy.utils.stats_summary" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="factorysimpy.utils.stats_summary.compute_performance_metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_performance_metrics</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">sim_time</span><span class="p">)</span></code>

<a href="#factorysimpy.utils.stats_summary.compute_performance_metrics" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Compute cycle time, resource utilization, throughput, and % time spent in each state for each worker.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>stats</code></b>
                  (<code><span title="dict">dict</span></code>)
              –
              <div class="doc-md-description">
                <p>The stats dictionary from the component (key: worker id, value: stats dict).</p>
              </div>
            </li>
            <li>
              <b><code>sim_time</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The total simulation time.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>dict</code></b>              –
              <div class="doc-md-description">
                <p>A dictionary with metrics for each worker.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/utils/stats_summary.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_performance_metrics</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">sim_time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute cycle time, resource utilization, throughput, and % time spent in each state for each worker.</span>

<span class="sd">    Args:</span>
<span class="sd">        stats (dict): The stats dictionary from the component (key: worker id, value: stats dict).</span>
<span class="sd">        sim_time (float): The total simulation time.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary with metrics for each worker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">worker_id</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">total_time</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="c1"># Defensive: If sim_time is 0, avoid division by zero</span>
        <span class="n">sim_time</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">sim_time</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">)</span>
        <span class="c1"># Utilization: % time in PROCESSING_STATE</span>
        <span class="n">util</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PROCESSING_STATE&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">sim_time</span>
        <span class="c1"># Throughput: items processed per unit time</span>
        <span class="n">num_processed</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num_item_processed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num_pallet_processed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">throughput</span> <span class="o">=</span> <span class="n">num_processed</span> <span class="o">/</span> <span class="n">sim_time</span>
        <span class="c1"># Cycle time: average time per processed item</span>
        <span class="n">cycle_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PROCESSING_STATE&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_processed</span><span class="p">)</span> <span class="k">if</span> <span class="n">num_processed</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="c1"># % time in each state</span>
        <span class="n">pct_time_states</span> <span class="o">=</span> <span class="p">{</span><span class="n">state</span><span class="p">:</span> <span class="p">(</span><span class="n">t</span> <span class="o">/</span> <span class="n">sim_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">state</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;total_time_spent_in_states&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="c1"># Discarded</span>
        <span class="n">num_discarded</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num_item_discarded&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num_pallet_discarded&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">results</span><span class="p">[</span><span class="n">worker_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;utilization&quot;</span><span class="p">:</span> <span class="n">util</span><span class="p">,</span>
            <span class="s2">&quot;throughput&quot;</span><span class="p">:</span> <span class="n">throughput</span><span class="p">,</span>
            <span class="s2">&quot;cycle_time&quot;</span><span class="p">:</span> <span class="n">cycle_time</span><span class="p">,</span>
            <span class="s2">&quot;percent_time_in_states&quot;</span><span class="p">:</span> <span class="n">pct_time_states</span><span class="p">,</span>
            <span class="s2">&quot;num_processed&quot;</span><span class="p">:</span> <span class="n">num_processed</span><span class="p">,</span>
            <span class="s2">&quot;num_discarded&quot;</span><span class="p">:</span> <span class="n">num_discarded</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="factorysimpy.utils.utils" class="doc doc-heading">
            <code>utils</code>


<a href="#factorysimpy.utils.utils" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="factorysimpy.utils.utils.get_edge_selector" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_edge_selector</span><span class="p">(</span><span class="n">sel_type</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">edge_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#factorysimpy.utils.utils.get_edge_selector" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Returns a generator that yields selected indices from the node's edge list.</p>
<p>Args:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">sel_type</span><span class="w"> </span><span class="p">(</span><span class="nx">str</span><span class="p">):</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">selection</span><span class="w"> </span><span class="nx">strategy</span><span class="p">.</span><span class="w"> </span><span class="nx">One</span><span class="w"> </span><span class="nx">of</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">RANDOM</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">ROUND_ROBIN</span><span class="err">&#39;</span><span class="p">.</span>
<span class="nx">node</span><span class="w"> </span><span class="p">(</span><span class="nx">object</span><span class="p">):</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">node</span><span class="w"> </span><span class="nx">object</span><span class="w"> </span><span class="nx">containing</span><span class="w"> </span><span class="nx">in_edges</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">out_edges</span><span class="p">.</span>
<span class="nx">env</span><span class="w"> </span><span class="p">(</span><span class="nx">simpy</span><span class="p">.</span><span class="nx">Environment</span><span class="p">):</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">simulation</span><span class="w"> </span><span class="nx">environment</span><span class="p">.</span>
<span class="nx">edge_type</span><span class="w"> </span><span class="p">(</span><span class="nx">str</span><span class="p">,</span><span class="w"> </span><span class="nx">optional</span><span class="p">):</span><span class="w"> </span><span class="nx">Whether</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">select</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">out_edges</span><span class="err">&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">in_edges</span><span class="err">&#39;</span><span class="p">.</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">OUT</span><span class="err">&#39;</span><span class="p">.</span>
</code></pre></div>

<p>Returns:</p>
<div class="codehilite"><pre><span></span><code><span class="n">generator</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">generator</span><span class="w"> </span><span class="n">yielding</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="n">indices</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="n">list</span><span class="o">.</span>
</code></pre></div>

<p>Raises:</p>
<div class="codehilite"><pre><span></span><code><span class="n">ValueError</span><span class="o">:</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">sel_type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">selection</span><span class="w"> </span><span class="n">strategy</span><span class="o">.</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/factorysimpy/utils/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_edge_selector</span><span class="p">(</span><span class="n">sel_type</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">edge_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a generator that yields selected indices from the node&#39;s edge list.</span>

<span class="sd">    Args:</span>

<span class="sd">        sel_type (str): The selection strategy. One of: &#39;RANDOM&#39;, &#39;ROUND_ROBIN&#39;.</span>
<span class="sd">        node (object): The node object containing in_edges or out_edges.</span>
<span class="sd">        env (simpy.Environment): The simulation environment.</span>
<span class="sd">        edge_type (str, optional): Whether to select from &#39;out_edges&#39; or &#39;in_edges&#39;. Default is &#39;OUT&#39;.</span>

<span class="sd">    Returns:</span>

<span class="sd">        generator: A generator yielding selected indices from the specified edge list.</span>

<span class="sd">    Raises:</span>

<span class="sd">        ValueError: If sel_type is not a valid selection strategy.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">edge_type</span> <span class="o">=</span> <span class="n">edge_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">edge_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="s2">&quot;out&quot;</span><span class="p">],</span> <span class="s2">&quot;edge_type must be either &#39;in&#39; or &#39;out&#39;.&quot;</span>
    <span class="n">strategies</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;RANDOM&quot;</span><span class="p">:</span> <span class="n">Random_edge_selector</span><span class="p">,</span>

        <span class="s2">&quot;ROUND_ROBIN&quot;</span><span class="p">:</span> <span class="n">RoundRobin_edge_selector</span><span class="p">,</span>

    <span class="p">}</span>

    <span class="k">if</span> <span class="n">sel_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid selection type: </span><span class="si">{</span><span class="n">sel_type</span><span class="si">}</span><span class="s2">. Must be one of: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strategies</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
    <span class="c1">#print(edge_type)</span>

    <span class="k">return</span> <span class="n">strategies</span><span class="p">[</span><span class="n">sel_type</span><span class="p">](</span><span class="n">node</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">edge_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../extendedresources/" class="btn btn-neutral float-left" title="Supporting classes"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../authors/" class="btn btn-neutral float-right" title="Authors">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/FactorySimPy/FactorySimPy" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../extendedresources/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../authors/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
